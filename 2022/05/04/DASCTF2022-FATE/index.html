<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>DASCTF2022-FATE | Gruge's Blog</title><meta name="keywords" content="md5,SHA1,Wincrptè§£å¯†AES,APKåŠ å›º,APKè„±å£³(blackdex),pycæ–‡ä»¶è§£åŒ…(pyinstxtractor),pyzæ–‡ä»¶è§£å¯†,pycæ–‡ä»¶åç¼–è¯‘(pycdcå·¥å…·),RSAä½è§£å¯†æŒ‡æ•°æ”»å‡»"><meta name="author" content="Gruge"><meta name="copyright" content="Gruge"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="CrackMeMFCçš„é€†å‘åˆ†æCracckMe,å†™é¢˜çš„æ—¶å€™åœ¨ç½‘ä¸Šæœåˆ°äº†é€†å‘åˆ†æCrackMe è¿™ç¯‡æ–‡ç« ï¼Œé€šè¿‡OD+IDAçš„æ–¹å¼å®šä½åˆ°å…³é”®ä»£ç å¤„ï¼Œç„¶åè¿›è¡Œè§£å¯†çš„æ“ä½œã€‚ çŸ¥è¯†ç‚¹ï¼š MD5 Sha1 Hashcat Wincrpt å®šä½å…³é”®å‡½æ•°ODæ¥å®šä½å…³é”®ä»£ç å’Œæå–æ•°æ®ï¼Œå› ä¸ºè¿™ä¸ªç¨‹åºæœ‰åè°ƒè¯•ï¼Œè€ŒODä¹‹ä¸­æœ‰æ’ä»¶ï¼Œèƒ½å¤Ÿå¾ˆå¥½çš„ååè°ƒè¯•è€Œæå–ç›¸å…³çš„æ•°æ®ã€‚ IDAèƒ½å¤Ÿå¾ˆå¥½çš„åç¼–è¯‘ç›¸åº”çš„ä»£ç ï¼Œææ¸…æ¥šå‡½æ•°çš„é€»è¾‘ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="DASCTF2022-FATE">
<meta property="og:url" content="http://example.com/2022/05/04/DASCTF2022-FATE/index.html">
<meta property="og:site_name" content="Gruge's Blog">
<meta property="og:description" content="CrackMeMFCçš„é€†å‘åˆ†æCracckMe,å†™é¢˜çš„æ—¶å€™åœ¨ç½‘ä¸Šæœåˆ°äº†é€†å‘åˆ†æCrackMe è¿™ç¯‡æ–‡ç« ï¼Œé€šè¿‡OD+IDAçš„æ–¹å¼å®šä½åˆ°å…³é”®ä»£ç å¤„ï¼Œç„¶åè¿›è¡Œè§£å¯†çš„æ“ä½œã€‚ çŸ¥è¯†ç‚¹ï¼š MD5 Sha1 Hashcat Wincrpt å®šä½å…³é”®å‡½æ•°ODæ¥å®šä½å…³é”®ä»£ç å’Œæå–æ•°æ®ï¼Œå› ä¸ºè¿™ä¸ªç¨‹åºæœ‰åè°ƒè¯•ï¼Œè€ŒODä¹‹ä¸­æœ‰æ’ä»¶ï¼Œèƒ½å¤Ÿå¾ˆå¥½çš„ååè°ƒè¯•è€Œæå–ç›¸å…³çš„æ•°æ®ã€‚ IDAèƒ½å¤Ÿå¾ˆå¥½çš„åç¼–è¯‘ç›¸åº”çš„ä»£ç ï¼Œææ¸…æ¥šå‡½æ•°çš„é€»è¾‘ã€‚">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s3.bmp.ovh/imgs/2022/02/ca6f47126f533a59.jpg">
<meta property="article:published_time" content="2022-05-04T09:44:12.000Z">
<meta property="article:modified_time" content="2022-05-04T09:54:38.729Z">
<meta property="article:author" content="Gruge">
<meta property="article:tag" content="md5">
<meta property="article:tag" content="SHA1">
<meta property="article:tag" content="Wincrptè§£å¯†AES">
<meta property="article:tag" content="APKåŠ å›º">
<meta property="article:tag" content="APKè„±å£³(blackdex)">
<meta property="article:tag" content="pycæ–‡ä»¶è§£åŒ…(pyinstxtractor)">
<meta property="article:tag" content="pyzæ–‡ä»¶è§£å¯†">
<meta property="article:tag" content="pycæ–‡ä»¶åç¼–è¯‘(pycdcå·¥å…·)">
<meta property="article:tag" content="RSAä½è§£å¯†æŒ‡æ•°æ”»å‡»">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s3.bmp.ovh/imgs/2022/02/ca6f47126f533a59.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2022/05/04/DASCTF2022-FATE/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"ä½ å·²åˆ‡æ¢ä¸ºç¹ä½“","cht_to_chs":"ä½ å·²åˆ‡æ¢ä¸ºç®€ä½“","day_to_night":"ä½ å·²åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼","night_to_day":"ä½ å·²åˆ‡æ¢ä¸ºæµ…è‰²æ¨¡å¼","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"top-right"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'DASCTF2022-FATE',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-05-04 17:54:38'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/modify.css"><meta name="generator" content="Hexo 5.4.1"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">åŠ è½½ä¸­...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s3.bmp.ovh/imgs/2022/02/463b631c6a0f63ec.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">17</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">41</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">6</div></a></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-coffee"></i><span> ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> å‹é“¾</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://s3.bmp.ovh/imgs/2022/02/ca6f47126f533a59.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Gruge's Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-coffee"></i><span> ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> å‹é“¾</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">DASCTF2022-FATE</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2022-05-04T09:44:12.000Z" title="å‘è¡¨äº 2022-05-04 17:44:12">2022-05-04</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2022-05-04T09:54:38.729Z" title="æ›´æ–°äº 2022-05-04 17:54:38">2022-05-04</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%A4%8D%E7%8E%B0/">å¤ç°</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="DASCTF2022-FATE"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><div class="top-img" style="background-image: url('https://s3.bmp.ovh/imgs/2022/02/ca6f47126f533a59.jpg');"></div><article class="post-content" id="article-container"><h2 id="CrackMe"><a href="#CrackMe" class="headerlink" title="CrackMe"></a>CrackMe</h2><p>MFCçš„é€†å‘åˆ†æCracckMe,å†™é¢˜çš„æ—¶å€™åœ¨ç½‘ä¸Šæœåˆ°äº†<a target="_blank" rel="noopener" href="https://bbs.pediy.com/thread-221038.htm">é€†å‘åˆ†æCrackMe</a> è¿™ç¯‡æ–‡ç« ï¼Œé€šè¿‡OD+IDAçš„æ–¹å¼å®šä½åˆ°å…³é”®ä»£ç å¤„ï¼Œç„¶åè¿›è¡Œè§£å¯†çš„æ“ä½œã€‚</p>
<p>çŸ¥è¯†ç‚¹ï¼š MD5 Sha1 Hashcat Wincrpt</p>
<h3 id="å®šä½å…³é”®å‡½æ•°"><a href="#å®šä½å…³é”®å‡½æ•°" class="headerlink" title="å®šä½å…³é”®å‡½æ•°"></a>å®šä½å…³é”®å‡½æ•°</h3><p>ODæ¥å®šä½å…³é”®ä»£ç å’Œæå–æ•°æ®ï¼Œå› ä¸ºè¿™ä¸ªç¨‹åºæœ‰åè°ƒè¯•ï¼Œè€ŒODä¹‹ä¸­æœ‰æ’ä»¶ï¼Œèƒ½å¤Ÿå¾ˆå¥½çš„ååè°ƒè¯•è€Œæå–ç›¸å…³çš„æ•°æ®ã€‚</p>
<p>IDAèƒ½å¤Ÿå¾ˆå¥½çš„åç¼–è¯‘ç›¸åº”çš„ä»£ç ï¼Œææ¸…æ¥šå‡½æ•°çš„é€»è¾‘ã€‚</p>
<p>æœç´¢MessageBoxAï¼Œå› ä¸ºå½“è¾“å…¥flagå’Œkeyä¹‹åï¼Œè¾“å…¥é”™è¯¯ä¼šå¼¹å‡ºå¼¹çª—ï¼Œè€ŒMessageBoxA æœ‰å¯èƒ½æ˜¯è¡¨ç¤ºå¼¹çª—çš„å‡½æ•°ä½ç½®</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220426200327902.png" alt="image-20220426200327902"></p>
<p><strong>ï¼ˆCtrl+Gï¼‰è·Ÿè¸ªè¡¨è¾¾å¼ã€TextA/Wã€‘</strong> å°±æ‰¾åˆ°å¼•ç”¨è¿™ä¸ªå‡½æ•°çš„åœ°å€ï¼Œçœ‹åˆ°è¿™ä¸ªåœ°å€ä¹‹åï¼Œå‘ç°å®ƒçš„ä¸‹æ–¹å°±æ˜¯â€œWrong!!!â€œå­—ç¬¦ä¸²ï¼Œå°±æ‰¾åˆ°å¯¹åº”è¾“å‡ºWrongçš„è¿™ä¸ªå‡½æ•°çš„ä½ç½®ï¼Œ</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220423131904713.png" alt="image-20220423131904713"></p>
<p>å®šä½åˆ°è¾“å‡ºwrong!!!çš„ä»£ç å¤„</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220423132053957.png" alt="image-20220423132053957"></p>
<p>å¹¶ä¸”åœ¨å®ƒçš„ä¸‹é¢å°±æ˜¯è¾“å‡ºsuccessfulçš„ä»£ç å¤„</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220423132133014.png" alt="image-20220423132133014"></p>
<p>åœ¨idaä¹‹ä¸­èƒ½æ›´åŠ å®¹æ˜“çš„åˆ†æä»£ç ï¼Œæ‰€ä»¥é€šè¿‡è¿™ä¸¤ä¸ªè¾“å‡ºwrongå’ŒSuccessçš„åœ°å€ï¼Œåœ¨idaä¹‹ä¸­å®šä½åˆ°è¿™ä¸¤ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”é€šè¿‡ä»–ä»¬å‘ä¸Šå°±æ‰¾ï¼ˆäº¤å‰å¼•ç”¨çš„æ–¹æ³•ï¼‰åˆ°å¯¹è¾“å…¥çš„keyå’Œflagè¿›è¡ŒéªŒè¯çš„å‡½æ•°ã€‚</p>
<p>å…³é”®å‡½æ•°çš„ä½ç½®:0x4C31E0</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220423140534625.png" alt="image-20220423140534625"></p>
<h3 id="åˆ†æå…³é”®å‡½æ•°é€»è¾‘"><a href="#åˆ†æå…³é”®å‡½æ•°é€»è¾‘" class="headerlink" title="åˆ†æå…³é”®å‡½æ•°é€»è¾‘"></a>åˆ†æå…³é”®å‡½æ•°é€»è¾‘</h3><p>è¿™é‡Œå°†keyåˆ†æˆäº†ä¸¤éƒ¨åˆ†è¿›è¡ŒåŠ å¯†ï¼Œå‰4ä¸ªå­—èŠ‚ä½¿ç”¨MD5åŠ å¯†ï¼Œå4ä¸ªå­—èŠ‚ä½¿ç”¨Sha1åŠ å¯†ï¼Œkeyçš„md5åŠ å¯†çš„ç»“æœä¼šä½œä¸ºAESåŠ å¯†çš„å¯†é’¥ï¼Œflagçš„åŠ å¯†æ˜¯AESåŠ å¯†</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220426201914088.png" alt="image-20220426201914088"></p>
<h4 id="4ä¸ªåŠ å¯†å‡½æ•°"><a href="#4ä¸ªåŠ å¯†å‡½æ•°" class="headerlink" title="4ä¸ªåŠ å¯†å‡½æ•°"></a>4ä¸ªåŠ å¯†å‡½æ•°</h4><p>è¿™é‡Œæœ‰4ä¸ªåŠ å¯†çš„å‡½æ•°ï¼Œåœ¨æ¯ä¸ªå‡½æ•°çš„é‡Œé¢éƒ½æ˜¯è°ƒç”¨<strong>Wincrypt</strong>çš„å‡½æ•°æ¥è¿›è¡ŒåŠ å¯†çš„æ“ä½œï¼Œä½†å½“æ—¶æˆ‘åšçš„æ—¶å€™å®Œå…¨æ²¡æœ‰æ³¨æ„åˆ°è¿™ä¸ªç‚¹ï¼Œéƒ½æ˜¯é€šè¿‡åŠ å¯†ä¹‹åçš„é•¿åº¦æ¥åˆ¤æ–­ç”¨çš„æ˜¯ä»€ä¹ˆåŠ å¯†ï¼ˆæ‰€ä»¥æŠŠkeyè§£å¯†å‡ºæ¥äº†ï¼‰ï¼Œä¸ç„¶ä¹Ÿä¸è‡³äºæœ€åä¸€æ­¥æ²¡æœ‰è§£å‡ºæ¥ã€‚</p>
<p>æ‰€ä»¥è‡ªå·±ä»¥åå¯¹äºè¿™ç§æƒ…å†µï¼Œè¦æŸ¥æ˜è¿™é‡Œé¢è°ƒç”¨çš„å‡½æ•°ä¸­å¼•ç”¨çš„å‚æ•°è¡¨ç¤ºä»€ä¹ˆæ„æ€ï¼Œæœ‰ä»€ä¹ˆä½œç”¨ï¼ï¼ï¼ï¼ï¼</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220425204459582.png" alt="image-20220425204459582"></p>
<p>Algid çš„æ•°å€¼ï¼šå°†è¾“å…¥çš„8ä¸ªå­—èŠ‚çš„keyåˆ†æˆä¸¤ä¸ªéƒ¨åˆ†ï¼Œå‰4ä¸ªå­—èŠ‚ç”¨md5åŠ å¯†ï¼Œå4ä¸ªå­—èŠ‚ç”¨Sha1åŠ å¯†</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220425205856887.png" alt="image-20220425205856887"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220425205920813.png" alt="image-20220425205920813"></p>
<p>æ‰€ä»¥ç¬¬ä¸€ä¸ªæ˜¯å¯¹è¾“å…¥çš„flagè¿›è¡Œmd5çš„hashåŠ å¯†</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220423135349916.png" alt="image-20220423135349916"></p>
<h4 id="æå–åŠ å¯†ç»“æœçš„æ•°æ®ï¼ˆODï¼‰"><a href="#æå–åŠ å¯†ç»“æœçš„æ•°æ®ï¼ˆODï¼‰" class="headerlink" title="æå–åŠ å¯†ç»“æœçš„æ•°æ®ï¼ˆODï¼‰"></a>æå–åŠ å¯†ç»“æœçš„æ•°æ®ï¼ˆODï¼‰</h4><p>åŠ å¯†ç»“æœçš„å¯¹æ¯”çš„å‡½æ•°</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220423175915409.png" alt="image-20220423175915409"></p>
<p>ä¸‰ä¸ªå¯¹æ¯”åŠ å¯†æ•°æ®çš„æ±‡ç¼–ä»£ç å¤„</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220423142415880.png" alt="image-20220423142415880"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220423142438993.png" alt="image-20220423142438993"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220423142505141.png" alt="image-20220423142505141"></p>
<p>é€šè¿‡idaä¹‹ä¸­ä¸‰ä¸ªå¯¹è¾“å…¥çš„åŠ å¯†ç»“æœåˆ¤æ–­çš„å‡½æ•°çš„åœ°å€ï¼Œåœ¨odä¹‹ä¸­å¯¹åº”çš„åœ°å€ä¸‹æ–­ç‚¹ï¼ŒåŠ¨è°ƒè°ƒè¯•æ‰¾åˆ°å¯¹æ¯”çš„æ•°æ®ï¼ˆå¯†æ–‡ï¼‰</p>
<h3 id="md5è§£å¯†"><a href="#md5è§£å¯†" class="headerlink" title="md5è§£å¯†"></a>md5è§£å¯†</h3><p>ç¬¬ä¸€ç»„ï¼ˆmd5ï¼‰ =ã€‹ æ‰¾ä¸ª<a target="_blank" rel="noopener" href="https://www.cmd5.com/">åœ¨çº¿ç½‘å€</a>è§£å¯†</p>
<p>æ•°æ®åœ°å€009AF460</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220423143845071.png" alt="image-20220423143845071"></p>
<p>å¯†æ–‡ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">009AF460  9F 77 C2 A4 AC 5C 0A 67  ç„ªé™‡ç.g</span><br><span class="line">009AF468  13 21 BB E1 E9 97 2A F6  !ä¼šé—‚*?</span><br></pre></td></tr></tbody></table></figure>

<p>   å¯†æ–‡ï¼š9F77C2A4AC5C0A671321BBE1E9972AF6   æ˜æ–‡ï¼šNocT</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220426202804265.png" alt="image-20220426202804265"></p>
<h3 id="SHA1è§£å¯†"><a href="#SHA1è§£å¯†" class="headerlink" title="SHA1è§£å¯†"></a>SHA1è§£å¯†</h3><p>ç¬¬äºŒç»„ï¼ˆSHA1ï¼‰=ã€‹(ä½¿ç”¨<a target="_blank" rel="noopener" href="https://github.com/hashcat/hashcat">HashCat</a>è§£å¯†) <a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/4008">Hashcatä½¿ç”¨æ‰‹å†Œ</a></p>
<p>é•¿åº¦æ˜¯ï¼š20</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220423155222571.png" alt="image-20220423155222571"></p>
<p>å¯†æ–‡ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">010FF59C  D5 9F 8E 94 B0 E1 DE 6E  è«¢å¸æ¬è¾¬</span><br><span class="line">010FF5A4  32 95 18 A0 C4 44 AA 94  2?çŠ‡Dç¢</span><br><span class="line">010FF5AC  DE 7C 8D 44              è¿€å²²..</span><br></pre></td></tr></tbody></table></figure>

<p>å¯†æ–‡ï¼šd59f8e94b0e1de6e329518a0c444aa94de7c8d44 æ˜æ–‡ï¼šuRne</p>
<p>æ‰€ä»¥keyçš„å€¼å°±æ˜¯ï¼š NocTuRne </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220423165125938.png" alt="image-20220423165125938"></p>
<p>æœ€åå¾—åˆ°çš„keyï¼š NocTuRne</p>
<h3 id="Wincrptè§£å¯†AES"><a href="#Wincrptè§£å¯†AES" class="headerlink" title="Wincrptè§£å¯†AES"></a>Wincrptè§£å¯†AES</h3><p>ç¬¬ä¸‰ç»„ï¼ˆAESï¼‰</p>
<p>é•¿åº¦æ˜¯ 0x30</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220423165627288.png" alt="image-20220423165627288"></p>
<p>å¯†æ–‡ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">003AFC20  5B 9C EE B2 3B B7 D7 34  [æ»?çº·4</span><br><span class="line">003AFC28  F3 1B 75 14 C6 B2 1F E8  ?uæ’‡?</span><br><span class="line">003AFC30  DE 33 44 74 75 1B 47 6A  ?DtuGj</span><br><span class="line">003AFC38  D4 37 51 88 FC 67 E6 60  ?Qå »géŒ</span><br><span class="line">003AFC40  DA 0D 58 07 81 43 53 EA  ?Xä¸†S?</span><br><span class="line">003AFC48  7B 52 85 6C 86 65 AF B4  {Rå¨å”€î‡©</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x5B,0x9C,0xEE,0xB2,0x3B,0xB7,0xD7,0x34,0xF3,0x1B,0x75,0x14,0xC6,0xB2,0x1F,0xE8,0xDE,0x33,0x44,0x74,0x75,0x1B,0x47,0x6A,0xD4,0x37,0x51,0x88,0xFC,0x67,0xE6,0x60,0xDA,0x0D,0x58,0x07,0x81,0x43,0x53,0xEA,0x7B,0x52,0x85,0x6C,0x86,0x65,0xAF,0xB4</span><br></pre></td></tr></tbody></table></figure>

<p>AESçš„å¯†é’¥ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x5c,0x53,0xa4,0xa4,0x1d,0x52,0x43,0x7a,0x9f,0xa1,0xe9,0xc2,0x6c,0xa5,0x90,0x90</span><br></pre></td></tr></tbody></table></figure>

<p>æˆ‘å®åœ¨æ˜¯æ²¡æœ‰æƒ³åˆ°å•Šï¼Œæœ€åè¿™ä¸€æ­¥å±…ç„¶æ˜¯AESè§£å¯†</p>
<h4 id="Wincrpt"><a href="#Wincrpt" class="headerlink" title="Wincrpt"></a>Wincrpt</h4><p>æœ€åä¸€æ­¥ç›´æ¥ä½¿ç”¨Wincrptä¸­çš„CryptEncryptå¯¹åº”çš„CryptDecryptè¿™ä¸ªå‡½æ•°æ¥è¿›è¡Œè§£å¯†</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220426133237250.png" alt="image-20220426133237250"></p>
<h4 id="CryptDecryptçš„è®²è§£"><a href="#CryptDecryptçš„è®²è§£" class="headerlink" title="CryptDecryptçš„è®²è§£"></a>CryptDecryptçš„è®²è§£</h4><p>åœ¨è°ƒç”¨<strong>CryptEncryptä¹‹å‰ï¼Œåº”ç”¨ç¨‹åºå¿…é¡»é€šè¿‡è°ƒç”¨</strong><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/windows/desktop/api/wincrypt/nf-wincrypt-cryptcreatehash">CryptCreateHash</a>å‡½æ•°è·å–æ•£åˆ—å¯¹è±¡çš„ å¥æŸ„ã€‚<a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/windows/desktop/api/wincrypt/nf-wincrypt-cryptsignhasha">åŠ å¯†å®Œæˆåï¼Œå¯ä»¥ä½¿ç”¨CryptGetHashParam</a>å‡½æ•°è·å–å“ˆå¸Œå€¼ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/windows/desktop/api/wincrypt/nf-wincrypt-cryptgethashparam">CryptSignHash</a>å‡½æ•°å¯¹å“ˆå¸Œè¿›è¡Œç­¾å ã€‚</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">BOOL CryptEncrypt(</span><br><span class="line">  [in]      HCRYPTKEY  hKey,</span><br><span class="line">  [in]      HCRYPTHASH hHash,</span><br><span class="line">  [in]      BOOL       Final,</span><br><span class="line">  [in]      DWORD      dwFlags,</span><br><span class="line">  [in, out] BYTE       *pbData,</span><br><span class="line">  [in, out] DWORD      *pdwDataLen,</span><br><span class="line">  [in]      DWORD      dwBufLen</span><br><span class="line">);</span><br><span class="line">[in] hKey: ç”¨äºè§£å¯†çš„å¯†é’¥å¥æŸ„ã€‚</span><br><span class="line">[in] hHash: å“ˆå¸Œå¯¹è±¡çš„å¥æŸ„ã€‚å¦‚æœè¦åŒæ—¶è§£å¯†å’Œæ•£åˆ—æ•°æ®ï¼Œåˆ™åœ¨æ­¤å‚æ•°ä¸­ä¼ é€’æ•£åˆ—å¯¹è±¡çš„å¥æŸ„ã€‚æ•£åˆ—å€¼ç”¨è§£å¯†åçš„æ˜æ–‡æ›´æ–°ã€‚æ­¤é€‰é¡¹åœ¨åŒæ—¶è§£å¯†             å’ŒéªŒè¯ç­¾åæ—¶å¾ˆæœ‰ç”¨ã€‚å¦‚æœä¸è¿›è¡Œæ•£åˆ—ï¼Œåˆ™æ­¤å‚æ•°å¿…é¡»ä¸ºé›¶ã€‚</span><br><span class="line">[in] Final: ä¸€ä¸ªå¸ƒå°”å€¼ï¼ŒæŒ‡å®šè¿™æ˜¯å¦æ˜¯æ­£åœ¨è§£å¯†çš„ç³»åˆ—ä¸­çš„æœ€åä¸€éƒ¨åˆ†ã€‚å¦‚æœè¿™æ˜¯æœ€åä¸€ä¸ªæˆ–å”¯ä¸€ä¸€ä¸ªå—ï¼Œåˆ™æ­¤å€¼ä¸ºTRUE ã€‚å¦‚æœè¿™ä¸æ˜¯æœ€åä¸€             ä¸ªå—ï¼Œåˆ™æ­¤å€¼ä¸ºFALSEã€‚        </span><br><span class="line">[in] dwFlags: æ ‡å¿—å€¼</span><br><span class="line">[in, out] pbDataï¼š æŒ‡å‘åŒ…å«è¦åŠ å¯†çš„æ˜æ–‡çš„ç¼“å†²åŒºçš„æŒ‡é’ˆã€‚æ­¤ç¼“å†²åŒºä¸­çš„æ˜æ–‡è¢«æ­¤å‡½æ•°åˆ›å»ºçš„å¯†æ–‡è¦†ç›–ã€‚</span><br><span class="line">[in, out] pdwDataLenï¼š ä¸€ä¸ªæŒ‡å‘DWORDå€¼çš„æŒ‡é’ˆï¼Œè¯¥å€¼åœ¨è¾“å…¥æ—¶åŒ…å«pbDataç¼“å†²åŒºä¸­æ˜æ–‡çš„é•¿åº¦ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚é€€å‡ºæ—¶ï¼Œæ­¤DWORDåŒ…å«                        å†™å…¥pbDataç¼“å†²åŒºçš„å¯†æ–‡çš„é•¿åº¦ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚</span><br><span class="line">[in] dwBufLenï¼š æŒ‡å®šè¾“å…¥pbDataç¼“å†²åŒºçš„æ€»å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ ã€‚</span><br></pre></td></tr></tbody></table></figure>

<h4 id="CryptDecryptçš„è®²è§£-1"><a href="#CryptDecryptçš„è®²è§£-1" class="headerlink" title="CryptDecryptçš„è®²è§£"></a>CryptDecryptçš„è®²è§£</h4><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">BOOL CryptDecrypt(</span><br><span class="line">  [in]      HCRYPTKEY  hKey,</span><br><span class="line">  [in]      HCRYPTHASH hHash,</span><br><span class="line">  [in]      BOOL       Final,</span><br><span class="line">  [in]      DWORD      dwFlags,</span><br><span class="line">  [in, out] BYTE       *pbData,</span><br><span class="line">  [in, out] DWORD      *pdwDataLen</span><br><span class="line">);</span><br><span class="line">hkey: ç”¨äºè§£å¯†çš„å¯†é’¥å¥æŸ„,æ­¤å¯†é’¥æŒ‡å®šè¦ä½¿ç”¨çš„è§£å¯†ç®—æ³•</span><br><span class="line">[in] hHash: å“ˆå¸Œå¯¹è±¡çš„å¥æŸ„ã€‚å¦‚æœè¦åŒæ—¶è§£å¯†å’Œæ•£åˆ—æ•°æ®ï¼Œåˆ™åœ¨æ­¤å‚æ•°ä¸­ä¼ é€’æ•£åˆ—å¯¹è±¡çš„å¥æŸ„ã€‚æ•£åˆ—å€¼ç”¨è§£å¯†åçš„æ˜æ–‡æ›´æ–°ã€‚æ­¤é€‰é¡¹åœ¨åŒæ—¶è§£å¯†             å’ŒéªŒè¯ç­¾åæ—¶å¾ˆæœ‰ç”¨ã€‚å¦‚æœä¸è¿›è¡Œæ•£åˆ—ï¼Œåˆ™æ­¤å‚æ•°å¿…é¡»ä¸ºé›¶ã€‚</span><br><span class="line">[in] Final: ä¸€ä¸ªå¸ƒå°”å€¼ï¼ŒæŒ‡å®šè¿™æ˜¯å¦æ˜¯æ­£åœ¨è§£å¯†çš„ç³»åˆ—ä¸­çš„æœ€åä¸€éƒ¨åˆ†ã€‚å¦‚æœè¿™æ˜¯æœ€åä¸€ä¸ªæˆ–å”¯ä¸€ä¸€ä¸ªå—ï¼Œåˆ™æ­¤å€¼ä¸ºTRUE ã€‚å¦‚æœè¿™ä¸æ˜¯æœ€åä¸€             ä¸ªå—ï¼Œåˆ™æ­¤å€¼ä¸ºFALSEã€‚</span><br><span class="line">[in] dwFlags: æ ‡å¿—å€¼(è§ä¸‹å›¾)</span><br><span class="line">[in, out] pbDataï¼š æŒ‡å‘åŒ…å«è¦è§£å¯†çš„æ•°æ®çš„ç¼“å†²åŒºçš„æŒ‡é’ˆã€‚è§£å¯†å®Œæˆåï¼Œæ˜æ–‡è¢«æ”¾å›åŒä¸€ä¸ªç¼“å†²åŒºã€‚</span><br><span class="line">[in, out] pdwDataLenï¼š æŒ‡å‘æŒ‡ç¤ºpbDataç¼“å†²åŒºé•¿åº¦çš„DWORDå€¼çš„æŒ‡é’ˆã€‚åœ¨è°ƒç”¨æ­¤å‡½æ•°ä¹‹å‰ï¼Œè°ƒç”¨åº”ç”¨ç¨‹åºå°†DWORDå€¼è®¾ç½®ä¸ºè¦è§£å¯†çš„å­—èŠ‚                        æ•°ã€‚è¿”å›æ—¶ï¼ŒDWORDå€¼åŒ…å«è§£å¯†åçš„æ˜æ–‡çš„å­—èŠ‚æ•°ã€‚</span><br></pre></td></tr></tbody></table></figure>

<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220426132654399.png" alt="image-20220426132654399" style="zoom: 67%;">

<h4 id="è§£å¯†è„šæœ¬"><a href="#è§£å¯†è„šæœ¬" class="headerlink" title="è§£å¯†è„šæœ¬"></a>è§£å¯†è„šæœ¬</h4><p>è¿™é‡Œè°ƒç”¨äº†CryptEncryptè¿›è¡ŒAESçš„åŠ å¯†çš„æ“ä½œï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬ç›´æ¥ä½¿ç”¨CryptDecryptæ¥è§£å¯†å°±å¯ä»¥äº†ï¼Œå¯ä»¥ç›´æ¥ä»ç½‘ä¸Šå»æ‰¾ç”¨å®ƒæ¥<a target="_blank" rel="noopener" href="https://www.writebug.com/git/DemonGan/CryptoApi">è§£å¯†çš„è„šæœ¬</a>ï¼Œä¹Ÿå¯ä»¥ç›´æ¥æŠŠåŠ å¯†çš„å‡½æ•°è„±å‡ºæ¥ï¼Œå°†é‡Œé¢CryptEncryptå‡½æ•°ä¿®æ”¹æˆCryptDecryptå‡½æ•°å°±å¯ä»¥äº†ï¼ˆä¸¤ä¸ªè„šæœ¬çš„é€»è¾‘éƒ½æ˜¯ä¸€æ ·çš„ï¼‰</p>
<p>ç¬¬ä¸€ç§è„šæœ¬ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;tchar.h&gt;</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;windows.h&gt;</span><br><span class="line">#include &lt;wincrypt.h&gt;</span><br><span class="line">#include &lt;conio.h&gt;</span><br><span class="line">#include &lt;iostream&gt;</span><br><span class="line"></span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">      BOOL v6; // [esp+4h] [ebp-18h]</span><br><span class="line">  HCRYPTKEY phKey; // [esp+Ch] [ebp-10h] BYREF</span><br><span class="line">  HCRYPTPROV phProv; // [esp+10h] [ebp-Ch] BYREF</span><br><span class="line">  HCRYPTHASH phHash; // [esp+14h] [ebp-8h] BYREF</span><br><span class="line"></span><br><span class="line">  phProv = 0;</span><br><span class="line">  phHash = 0;</span><br><span class="line">  phKey = 0;</span><br><span class="line">  BYTE a3[] = {0x5B,0x9C,0xEE,0xB2,0x3B,0xB7,0xD7,0x34,0xF3,0x1B,0x75,0x14,0xC6,0xB2,0x1F,0xE8,0xDE,0x33,0x44,0x74,0x75,0x1B,0x47,0x6A,0xD4,0x37,0x51,0x88,0xFC,0x67,0xE6,0x60,0xDA,0x0D,0x58,0x07,0x81,0x43,0x53,0xEA,0x7B,0x52,0x85,0x6C,0x86,0x65,0xAF,0xB4};</span><br><span class="line">  BYTE pbData[] ={0x5c,0x53,0xa4,0xa4,0x1d,0x52,0x43,0x7a,0x9f,0xa1,0xe9,0xc2,0x6c,0xa5,0x90,0x90};</span><br><span class="line">  DWORD dwDataLen = 0x10;</span><br><span class="line">  DWORD *pdwDataLen ;</span><br><span class="line">  *pdwDataLen = 0x20;</span><br><span class="line">  v6 = CryptAcquireContextA(&amp;phProv, 0, 0, 0x18u, 0xF0000000);</span><br><span class="line">  if ( v6 )</span><br><span class="line">  {</span><br><span class="line">    v6 = CryptCreateHash(phProv, 0x8003u, 0, 0, &amp;phHash);</span><br><span class="line">    if ( v6 )</span><br><span class="line">    {</span><br><span class="line">      v6 = CryptHashData(phHash, pbData, dwDataLen, 0);</span><br><span class="line">      if ( v6 )</span><br><span class="line">      {</span><br><span class="line">        v6 = CryptDeriveKey(phProv, 0x660Eu, phHash, 1u, &amp;phKey);</span><br><span class="line">        if ( v6 )</span><br><span class="line">          v6 = CryptDecrypt(phKey, 0, 1, 0, a3, pdwDataLen);</span><br><span class="line">      }</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">cout&lt;&lt;a3&lt;&lt;endl;</span><br><span class="line">  if ( phKey )</span><br><span class="line">    CryptDestroyKey(phKey);</span><br><span class="line">  if ( phHash )</span><br><span class="line">    CryptDestroyHash(phHash);</span><br><span class="line">  if ( phProv )</span><br><span class="line">    CryptReleaseContext(phProv, 0);</span><br><span class="line">    return 0;</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p>ç¬¬äºŒç§è„šæœ¬ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;windows.h&gt;</span><br><span class="line">#include &lt;windef.h&gt;</span><br><span class="line">#include &lt;wincrypt.h&gt;</span><br><span class="line">#include&lt;stdio.h&gt;</span><br><span class="line">#include &lt;iostream&gt;</span><br><span class="line"></span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">BOOL AesDecrypt()</span><br><span class="line">{</span><br><span class="line">	BOOL bRet = TRUE;</span><br><span class="line">	HCRYPTPROV hCryptProv = NULL;</span><br><span class="line">	HCRYPTHASH hCryptHash = NULL;</span><br><span class="line">	HCRYPTKEY hCryptKey = NULL;</span><br><span class="line"></span><br><span class="line">	BYTE pPassword[] = { 0x5c,0x53,0xa4,0xa4,0x1d,0x52,0x43,0x7a,0x9f,0xa1,0xe9,0xc2,0x6c,0xa5,0x90,0x90 };</span><br><span class="line">    DWORD dwPasswordLength = 0x10;</span><br><span class="line">    BYTE pData[] = { 0x5B, 0x9C, 0xEE, 0xB2, 0x3B, 0xB7, 0xD7, 0x34, 0xF3, 0x1B, 0x75, 0x14, 0xC6, 0xB2, 0x1F, 0xE8, 0xDE, 0x33, 0x44, 0x74, 0x75, 0x1B, 0x47, 0x6A, 0xD4, 0x37, 0x51, 0x88, 0xFC, 0x67, 0xE6, 0x60, 0xDA, 0x0D, 0x58, 0x07, 0x81, 0x43, 0x53, 0xEA, 0x7B, 0x52, 0x85, 0x6C, 0x86, 0x65, 0xAF, 0xB4 };</span><br><span class="line">	DWORD dwDataLength = 0x20;</span><br><span class="line">	DWORD dwBufferLength = 0x108;</span><br><span class="line">	do</span><br><span class="line">	{</span><br><span class="line">		// è·å–CSPå¥æŸ„</span><br><span class="line">		bRet = ::CryptAcquireContext(&amp;hCryptProv, NULL, NULL, PROV_RSA_AES, CRYPT_VERIFYCONTEXT);</span><br><span class="line">		if (FALSE == bRet)</span><br><span class="line">		{</span><br><span class="line"></span><br><span class="line">			break;</span><br><span class="line">		}</span><br><span class="line"></span><br><span class="line">		// åˆ›å»ºHASHå¯¹è±¡</span><br><span class="line">		bRet = ::CryptCreateHash(hCryptProv, CALG_MD5, NULL, 0, &amp;hCryptHash);</span><br><span class="line">		if (FALSE == bRet)</span><br><span class="line">		{</span><br><span class="line"></span><br><span class="line">			break;</span><br><span class="line">		}</span><br><span class="line"></span><br><span class="line">		// å¯¹å¯†é’¥è¿›è¡ŒHASHè®¡ç®—</span><br><span class="line">		bRet = ::CryptHashData(hCryptHash, pPassword, dwPasswordLength, 0);</span><br><span class="line">		if (FALSE == bRet)</span><br><span class="line">		{</span><br><span class="line"></span><br><span class="line">			break;</span><br><span class="line">		}</span><br><span class="line"></span><br><span class="line">		// ä½¿ç”¨HASHæ¥ç”Ÿæˆå¯†é’¥</span><br><span class="line">		bRet = ::CryptDeriveKey(hCryptProv, CALG_AES_128, hCryptHash, CRYPT_EXPORTABLE, &amp;hCryptKey);</span><br><span class="line">		if (FALSE == bRet)</span><br><span class="line">		{</span><br><span class="line"></span><br><span class="line">			break;</span><br><span class="line">		}</span><br><span class="line"></span><br><span class="line">		// è§£å¯†æ•°æ®</span><br><span class="line">		bRet = ::CryptDecrypt(hCryptKey, NULL, TRUE, 0, pData, &amp;dwDataLength);</span><br><span class="line">		if (FALSE == bRet)</span><br><span class="line">		{</span><br><span class="line"></span><br><span class="line">			break;</span><br><span class="line">		}</span><br><span class="line"></span><br><span class="line">	} while (FALSE);</span><br><span class="line">cout&lt;&lt;pData&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">	// å…³é—­é‡Šæ”¾</span><br><span class="line">	if (hCryptKey)</span><br><span class="line">	{</span><br><span class="line">		::CryptDestroyKey(hCryptKey);</span><br><span class="line">	}</span><br><span class="line">	if (hCryptHash)</span><br><span class="line">	{</span><br><span class="line">		::CryptDestroyHash(hCryptHash);</span><br><span class="line">	}</span><br><span class="line">	if (hCryptProv)</span><br><span class="line">	{</span><br><span class="line">		::CryptReleaseContext(hCryptProv, 0);</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	return bRet;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">int main()</span><br><span class="line">{</span><br><span class="line">    AesDecrypt();</span><br><span class="line">    return 0;</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>æœ€åè§£å¾—çš„ç»“æœæ˜¯ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220426195628830.png" alt="image-20220426195628830"></p>
<p>æœ€åçš„flag ï¼šDASCTF{H@sh_a^d_Aes_6y_W1nCrypt}</p>
<h2 id="fakePica"><a href="#fakePica" class="headerlink" title="fakePica"></a>fakePica</h2><p>å…ˆç”¨PKIDæŸ¥å£³ï¼Œå¤ªä¹…æ²¡åšAPKçš„é¢˜ç›®ï¼Œå½“æ—¶åšçš„æ—¶å€™éƒ½å¿˜äº†è¿›è¡ŒæŸ¥å£³äº†ï¼Œä»¥åä¸€å®šè¦æ³¨æ„ï¼Œä¸è¦ç›´æ¥å°±jebé‡Œé¢æ‹–</p>
<p>å¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªæ¢†æ¢†åŠ å›º</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220426205532076.png" alt="image-20220426205532076"></p>
<h3 id="åˆ†æAPKåŠ å›ºçš„æ–¹æ³•"><a href="#åˆ†æAPKåŠ å›ºçš„æ–¹æ³•" class="headerlink" title="åˆ†æAPKåŠ å›ºçš„æ–¹æ³•"></a>åˆ†æAPKåŠ å›ºçš„æ–¹æ³•</h3><p>è¿™é‡Œè®²è¿°çš„æ˜¯é€šè¿‡åç¼–è¯‘ä»£ç åˆ†ææ˜¯æ¢†æ¢†åŠ å›ºçš„è¿‡ç¨‹</p>
<p>å…ˆç”¨jebæ‰“å¼€æ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶çš„ä¸»å‡½æ•°ä¹‹ä¸­å¹¶æ²¡æœ‰æ‰¾åˆ°MainActivityï¼Œä½†æ˜¯å‘ç°å¼•å…¥äº†æœ‰å…³AppAplicationçš„åŒ…ï¼Œå°±å¯ä»¥çŒœæµ‹åŠ äº†å£³</p>
<p>å†ç”¨APKToolå¾—åˆ°ç¨‹åºçš„ç›¸å…³çš„æ–‡ä»¶ï¼ŒæŸ¥çœ‹libæ–‡ä»¶</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220426210811471.png" alt="image-20220426210811471"></p>
<p>è¿™ä¸¤ä¸ªsoæ–‡ä»¶å°±æ˜¯æ¢†æ¢†åŠ å›ºçš„soæ–‡ä»¶ï¼ˆé€šè¿‡ä¸‹é¢libæ–‡ä»¶å’Œå¯¹åº”çš„åŠ å›ºæ–¹æ³•çš„å­—å…¸å°±èƒ½çŸ¥é“ï¼‰ï¼Œå¯ä»¥ç”¨pythonå†™ä¸€ä¸ªè„šæœ¬æ¥è¾¨è®¤</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">markNameMap.put("libchaosvmp.so", "å¨œè¿¦");</span><br><span class="line">markNameMap.put("libddog.so", "å¨œè¿¦");</span><br><span class="line">markNameMap.put("libfdog.so", "å¨œè¿¦");</span><br><span class="line">markNameMap.put("libedog.so", "å¨œè¿¦ä¼ä¸šç‰ˆ");</span><br><span class="line">markNameMap.put("libexec.so", "çˆ±åŠ å¯†");</span><br><span class="line">markNameMap.put("libexecmain.so", "çˆ±åŠ å¯†");</span><br><span class="line">markNameMap.put("ijiami.dat", "çˆ±åŠ å¯†");</span><br><span class="line">markNameMap.put("ijiami.ajm", "çˆ±åŠ å¯†ä¼ä¸šç‰ˆ");</span><br><span class="line">markNameMap.put("libsecexe.so", "æ¢†æ¢†å…è´¹ç‰ˆ");</span><br><span class="line">markNameMap.put("libsecmain.so", "æ¢†æ¢†å…è´¹ç‰ˆ");</span><br><span class="line">markNameMap.put("libSecShell.so", "æ¢†æ¢†å…è´¹ç‰ˆ");</span><br><span class="line">markNameMap.put("libDexHelper.so", "æ¢†æ¢†ä¼ä¸šç‰ˆ");</span><br><span class="line">markNameMap.put("libDexHelper-x86.so", "æ¢†æ¢†ä¼ä¸šç‰ˆ");</span><br><span class="line">markNameMap.put("libprotectClass.so", "360");</span><br><span class="line">markNameMap.put("libjiagu.so", "360");</span><br><span class="line">markNameMap.put("libjiagu_art.so", "360");</span><br><span class="line">markNameMap.put("libjiagu_x86.so", "360");</span><br><span class="line">markNameMap.put("libegis.so", "é€šä»˜ç›¾");</span><br><span class="line">markNameMap.put("libNSaferOnly.so", "é€šä»˜ç›¾");</span><br><span class="line">markNameMap.put("libnqshield.so", "ç½‘ç§¦");</span><br><span class="line">markNameMap.put("libbaiduprotect.so", "ç™¾åº¦");</span><br><span class="line">markNameMap.put("aliprotect.dat", "é˜¿é‡Œèšå®‰å…¨");</span><br><span class="line">markNameMap.put("libsgmain.so", "é˜¿é‡Œèšå®‰å…¨");</span><br><span class="line">markNameMap.put("libsgsecuritybody.so", "é˜¿é‡Œèšå®‰å…¨");</span><br><span class="line">markNameMap.put("libmobisec.so", "é˜¿é‡Œèšå®‰å…¨");</span><br><span class="line">markNameMap.put("libtup.so", "è…¾è®¯");</span><br><span class="line">markNameMap.put("libexec.so", "è…¾è®¯");</span><br><span class="line">markNameMap.put("libshell.so", "è…¾è®¯");</span><br><span class="line">markNameMap.put("mix.dex", "è…¾è®¯");</span><br><span class="line">markNameMap.put("lib/armeabi/mix.dex", "è…¾è®¯");</span><br><span class="line">markNameMap.put("lib/armeabi/mixz.dex", "è…¾è®¯");</span><br><span class="line">markNameMap.put("libtosprotection.armeabi.so", "è…¾è®¯å¾¡å®‰å…¨");</span><br><span class="line">markNameMap.put("libtosprotection.armeabi-v7a.so", "è…¾è®¯å¾¡å®‰å…¨");</span><br><span class="line">markNameMap.put("libtosprotection.x86.so", "è…¾è®¯å¾¡å®‰å…¨");</span><br><span class="line">markNameMap.put("libnesec.so", "ç½‘æ˜“æ˜“ç›¾");</span><br><span class="line">markNameMap.put("libAPKProtect.so", "APKProtect");</span><br><span class="line">markNameMap.put("libkwscmm.so", "å‡ ç»´å®‰å…¨");</span><br><span class="line">markNameMap.put("libkwscr.so", "å‡ ç»´å®‰å…¨");</span><br><span class="line">markNameMap.put("libkwslinker.so", "å‡ ç»´å®‰å…¨");</span><br><span class="line">markNameMap.put("libx3g.so", "é¡¶åƒç§‘æŠ€");</span><br><span class="line">markNameMap.put("libapssec.so", "ç››å¤§");</span><br><span class="line">markNameMap.put("librsprotect.so", "ç‘æ˜Ÿ");</span><br></pre></td></tr></tbody></table></figure>

<h3 id="blackdex-APKè„±å£³"><a href="#blackdex-APKè„±å£³" class="headerlink" title="blackdex-APKè„±å£³"></a>blackdex-APKè„±å£³</h3><p>ä½¿ç”¨<a target="_blank" rel="noopener" href="https://github.com/CodingGay/BlackDex">blackdex</a>è½¯ä»¶è¿›è¡Œè„±å£³</p>
<h4 id="åˆ¤æ–­32ä½è¿˜æ˜¯64ä½çš„APKæ–‡ä»¶"><a href="#åˆ¤æ–­32ä½è¿˜æ˜¯64ä½çš„APKæ–‡ä»¶" class="headerlink" title="åˆ¤æ–­32ä½è¿˜æ˜¯64ä½çš„APKæ–‡ä»¶"></a>åˆ¤æ–­32ä½è¿˜æ˜¯64ä½çš„APKæ–‡ä»¶</h4><p>é¦–å…ˆåˆ¤æ–­ä¸€ä¸ªAPKæ˜¯32ä½è¿˜æ˜¯64ä½çš„</p>
<p>32ä½å’Œ64çš„æ¶æ„</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220426213154347.png" alt="image-20220426213154347"></p>
<p>æŸ¥çœ‹libæ–‡ä»¶å¤¹</p>
<p>è¿™é‡Œæ˜¯armeabi-v7a å°±è¯´æ˜æ˜¯32ä½çš„</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220426213235800.png" alt="image-20220426213235800"></p>
<p>æ‰€ä»¥è¿è¡Œ32ä½çš„blackdexï¼ˆå°†å¯¹åº”ä½æ•°çš„blackdexçš„apkæ–‡ä»¶æ”¾å…¥æ¨¡æ‹Ÿå™¨ä¹‹ä¸­ï¼‰,å°†éœ€è¦è„±å£³çš„apkæ–‡ä»¶ä¹Ÿæ‹–å…¥æ¨¡æ‹Ÿå™¨ä¹‹ä¸­ï¼Œè¿è¡Œè„±å£³çš„Apkæ–‡ä»¶ï¼Œåœ¨è¿™ä¸ªç¨‹åºä¹‹ä¸­é€‰ä¸­éœ€è¦è„±å£³çš„è¿™ä¸ªè½¯ä»¶ï¼Œå°±å¯ä»¥ç›´æ¥è„±å£³äº†ï¼Œå®ƒè„±å£³å®Œæˆä¹‹åå°†è„±å£³å¾—åˆ°çš„dexæ–‡ä»¶å­˜å…¥ä¸‹é¢è¿™ä¸ªæ–‡ä»¶ç›®å½•ä¹‹ä¸­</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220426213832469.png" alt="image-20220426213832469"></p>
<p>åœ¨è™šæ‹Ÿå™¨çš„æ–‡ä»¶ç®¡ç†ä¹‹ä¸­æ‰“å¼€è¯¥æ–‡ä»¶å¤¹ï¼Œå¹¶ä¸”é€‰ä¸­è¯¥æ–‡ä»¶å¤¹ï¼ˆè¿™ä¸ªæ–‡ä»¶å¤¹ä¹‹ä¸­æœ‰4ä¸ªdexæ–‡ä»¶ï¼‰ï¼Œå†æ‰“å¼€å…±äº«æ–‡ä»¶å¤¹ï¼Œåœ¨å…±äº«æ–‡ä»¶å¤¹çš„åœ°æ–¹é€‰ä¸­å›¾ä¸­é€‰é¡¹</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220426215804244.png" alt="image-20220426215804244"></p>
<p>å…±äº«æ–‡ä»¶æ‰“å¼€çš„åœ°æ–¹ï¼šï¼ˆé«˜çº§åŠŸèƒ½ä¹‹ä¸­èƒ½å¤Ÿå¯¹ç”µè„‘ç«¯çš„å…±äº«æ–‡ä»¶å¤¹è¿›è¡Œé‡æ–°çš„è®¾ç½®ï¼‰</p>
<p>è¿™æ ·è¾¾åˆ°çš„æ•ˆæœå°±æ˜¯ç”µè„‘ç«¯çš„è¯¥æ–‡ä»¶å¤¹å’Œæ¨¡æ‹Ÿå™¨ç«¯çš„è¯¥æ–‡ä»¶å¤¹æ˜¯åŒæ­¥çš„ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220426215837100.png" alt="image-20220426215837100"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220426215849767.png" alt="image-20220426215849767"></p>
<h3 id="åˆ†æè„±å£³å¾—åˆ°çš„dexæ–‡ä»¶"><a href="#åˆ†æè„±å£³å¾—åˆ°çš„dexæ–‡ä»¶" class="headerlink" title="åˆ†æè„±å£³å¾—åˆ°çš„dexæ–‡ä»¶"></a>åˆ†æè„±å£³å¾—åˆ°çš„dexæ–‡ä»¶</h3><p>å°†è¿™äº›dexæ–‡ä»¶æ‹–è¿›jebä¹‹ä¸­åˆ†æï¼š</p>
<blockquote>
<p>dexæ–‡ä»¶ï¼š</p>
<ul>
<li><p>dexæ–‡ä»¶æ˜¯Androidç³»ç»Ÿçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼ŒåŒ…å«åº”ç”¨ç¨‹åºçš„å…¨éƒ¨æ“ä½œæŒ‡ä»¤ä»¥åŠè¿è¡Œæ—¶æ•°æ®ã€‚</p>
</li>
<li><p>å½“javaç¨‹åºç¼–è¯‘æˆclassåï¼Œè¿˜éœ€è¦ä½¿ç”¨dexå·¥å…·å°†æ‰€æœ‰çš„classæ–‡ä»¶æ•´åˆåˆ°ä¸€ä¸ªdexæ–‡ä»¶ï¼Œç›®çš„æ˜¯å…¶ä¸­å„ä¸ªç±»èƒ½å¤Ÿå…±äº«æ•°æ®ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šé™ä½äº†å†—ä½™ï¼ŒåŒæ—¶ä¹Ÿæ˜¯æ–‡ä»¶ç»“æ„æ›´åŠ ç»å‡‘ï¼Œdexæ–‡ä»¶æ˜¯ä¼ ç»Ÿjaræ–‡ä»¶å¤§å°çš„50ï¼…å·¦å³ã€‚</p>
</li>
<li><p>dexæ–‡ä»¶çš„ä½œç”¨æ˜¯è®°å½•æ•´ä¸ªå·¥ç¨‹ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªAndroidå·¥ç¨‹ï¼‰çš„æ‰€æœ‰ç±»æ–‡ä»¶çš„ä¿¡æ¯ã€‚</p>
</li>
</ul>
</blockquote>
<p>é€ä¸ªæ‰“å¼€æ¯ä¸ªdexæ–‡ä»¶ï¼Œåœ¨cookie_8836564.dexæ–‡ä»¶ä¹‹ä¸­æ‰¾åˆ°MainActivityå‡½æ•°</p>
<h4 id="AESè§£å¯†"><a href="#AESè§£å¯†" class="headerlink" title="AESè§£å¯†"></a>AESè§£å¯†</h4><p>æ‰“å¼€è¿™ä¸ªmainActivityè¿™ä¸ªç±»å°±èƒ½å¾ˆç›´è§‚çš„çœ‹åˆ°ç”¨çš„æ˜¯AESåŠ å¯†ï¼Œå¹¶ä¸”æ˜¯ç›´æ¥è°ƒç”¨çš„Javaçš„æ¥å£ï¼Œæ‰€ä»¥å°±æ˜¯æ ‡å‡†çš„AESè§£å¯†</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220427092404661.png" alt="image-20220427092404661"></p>
<p>AESçš„ key = â€œpicapicapicapicaâ€ </p>
<p>AESçš„ IVå‘é‡ IV = â€œ0102030405060708â€</p>
<p>ç¬¬ä¸€ç»„çš„å¯†æ–‡</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-114, 0x5F, -37, 0x7F, -110, 0x71, 41, 74, 40, 73, 19, 0x7C, -57, -88, 39, -116, -16, -75, -3, -45, -73, -6, -104, -6, -78, 0x79, 110, 74, -90, -47, -28, -28</span><br><span class="line"></span><br><span class="line">0x8e,0x5f,0xdb,0x7f,0x92,0x71,0x29,0x4a,0x28,0x49,0x13,0x7c,0xc7,0xa8,0x27,0x8c,0xf0,0xb5,0xfd,0xd3,0xb7,0xfa,0x98,0xfa,0xb2,0x79,0x6e,0x4a,0xa6,0xd1,0xe4,0xe4</span><br><span class="line"></span><br><span class="line">8e5fdb7f9271294a2849137cc7a8278cf0b5fdd3b7fa98fab2796e4aa6d1e4e4</span><br><span class="line"></span><br><span class="line">æ˜æ–‡ï¼š picacomic@gmail.com</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220427003406872.png" alt="image-20220427003406872"></p>
<p>ç¬¬äºŒç»„çš„å¯†æ–‡ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-40, 26, 0x5F, -49, -40, -123, 72, -90, -100, -41, 0x7A, -4, 25, -101, -58, 0x74</span><br><span class="line"></span><br><span class="line">0xd8,0x1a,0x5f,0xcf,0xd8,0x85,0x48,0xa6,0x9c,0xd7,0x7a,0xfc,0x19,0x9b,0xc6,0x74</span><br><span class="line"></span><br><span class="line">æ˜æ–‡ï¼š picacomic</span><br></pre></td></tr></tbody></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220427003510166.png" alt="image-20220427003510166"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220427003744579.png" alt="image-20220427003744579"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220427003747472.png" alt="image-20220427003747472"></p>
<p>flag{<a href="mailto:picacomic@gmail.compicacomic">picacomic@gmail.compicacomic</a>}</p>
<h2 id="å¥‡æ€ªçš„äº¤æ˜“"><a href="#å¥‡æ€ªçš„äº¤æ˜“" class="headerlink" title="å¥‡æ€ªçš„äº¤æ˜“"></a>å¥‡æ€ªçš„äº¤æ˜“</h2><p>å½“æ—¶ç”¨idaæ‰“å¼€è¿™ä¸ªæ–‡ä»¶çš„æ—¶å€™å°±å‘ç°è¿™ä¸ªæ–‡ä»¶é‡Œé¢æ€ä¹ˆæåˆ°äº†pythonçš„ä¸œè¥¿ï¼Œå½“æ—¶è¿˜ä»¥ä¸ºæ˜¯åœ¨cè¯­è¨€ä¹‹ä¸­è¿è¡Œpythonæ–‡ä»¶ï¼Œç»“æœå‘ç°æ˜¯ç”¨pythonæ¥æ‰“åŒ…elfæ–‡ä»¶ï¼Œè‡ªå·±å¹³æ—¶çŸ¥è¯†ç‚¹çš„ç§¯ç´¯è¿˜æ˜¯å¤ªå°‘äº†</p>
<p><a target="_blank" rel="noopener" href="https://lu1u.xyz/">Lu1uå¸ˆå‚…</a> </p>
<p>ä½¿ç”¨pyinstxtractorè§£åŒ…å°±å¾—åˆ°äº†å¯¹åº”çš„pycæ–‡ä»¶</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220427135100720.png" alt="image-20220427135100720"></p>
<h3 id="pycæ–‡ä»¶ä»¥åŠå…¶ä¸­çš„pyzæ–‡ä»¶è§£åŒ…"><a href="#pycæ–‡ä»¶ä»¥åŠå…¶ä¸­çš„pyzæ–‡ä»¶è§£åŒ…" class="headerlink" title="pycæ–‡ä»¶ä»¥åŠå…¶ä¸­çš„pyzæ–‡ä»¶è§£åŒ…"></a>pycæ–‡ä»¶ä»¥åŠå…¶ä¸­çš„pyzæ–‡ä»¶è§£åŒ…</h3><p>è¿™ä¸ªåœ°æ–¹ç”¨<a target="_blank" rel="noopener" href="https://github.com/extremecoders-re/pyinstxtractor/wiki/Frequently-Asked-Questions">pyinstxtractorè§£åŒ…</a>æºæ–‡ä»¶çš„æ—¶å€™è¦ä½¿ç”¨python3.10çš„ç¯å¢ƒè¿è¡Œè¿™ä¸ªpyinstxtractor.pyæ–‡ä»¶ã€‚è¿™æ ·pyzæ–‡ä»¶è§£åŒ…çš„æ–‡ä»¶æ‰èƒ½å¤Ÿåœ¨PYZ-00.pyz_extractedæ–‡ä»¶å¤¹ä¹‹ä¸­è·å¾—</p>
<p>å®‰è£…å’Œä½¿ç”¨Miniconda3 è¿™ä¸ªè½¯ä»¶çš„ä½œç”¨æ˜¯ç”¨æ¥ç®¡ç†ç¯å¢ƒçš„ï¼ˆè¿™é‡Œç”¨æ¥åœ¨æœ¬æœºä¸Šé…ç½®python3.10ç¯å¢ƒï¼‰</p>
<p><a target="_blank" rel="noopener" href="https://docs.conda.io/en/latest/miniconda.html">ä¸‹è½½çš„åœ°å€</a></p>
<p><a target="_blank" rel="noopener" href="https://ywnz.com/linuxjc/3834.html">å®‰è£…å’Œå¸è½½çš„åœ°å€</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/133494097">ä½¿ç”¨è½¯ä»¶</a></p>
<p>å¦‚ä½•åˆ¤æ–­è¿™ä¸ªæ–‡ä»¶æ‰“åŒ…çš„æ—¶å€™ä½¿ç”¨çš„æ˜¯pythonç‰ˆæœ¬çš„æ˜¯3.10çš„å‘¢ï¼Ÿ</p>
<p>ç­”ï¼šéšä¾¿ä½¿ç”¨ä¸€ä¸ªç‰ˆæœ¬çš„pyinstxtractoræ¥è§£åŒ…æ–‡ä»¶ï¼Œé€šè¿‡å®ƒçš„ä¾èµ–æ–‡ä»¶å°±å¯ä»¥è¿›è¡Œåˆ¤æ–­</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220502181556493.png" alt="image-20220502181556493"></p>
<p>è¿™é“é¢˜ç›®çš„pythonç‰ˆæœ¬æ˜¯3.10ï¼Œå®ƒçš„magicçš„numå¯ä»¥é€šè¿‡struct.pycæ–‡ä»¶çš„å‰4ä¸ªå­—èŠ‚è·å¾—ï¼Œæˆ–è€…é€šè¿‡PYZ-00.pyzæ–‡ä»¶çš„5åˆ°8å­—èŠ‚æ•°æ®èƒ½å¤Ÿå¾—åˆ°</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220502181645404.png" alt="image-20220502181645404"></p>
<p>ç”¨è¿™ä¸ªmagic numberå°†pycæ–‡ä»¶è¡¥å…¨ï¼ˆå› ä¸ºåœ¨æ‰“åŒ…æ–‡ä»¶çš„æ—¶å€™å¸¸å¸¸ä¼šå°†pycæ–‡ä»¶çš„magic numberå»æ‰ï¼Œæˆ‘ä»¬åœ¨æ¢å¤çš„æ—¶å€™éœ€è¦è‡ªå·±å»è¡¥å…¨ï¼Œè¡¥å…¨ä¹‹åå°±èƒ½å¤Ÿè¿›è¡Œåç¼–è¯‘äº†ï¼Œä½†æ˜¯è¿™é‡Œåç¼–è¯‘å› ä¸ºæ˜¯python3.10ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨python-uncompyle6å¾—åˆ°ï¼Œè¦ä½¿ç”¨pycdcæ¥è¿›è¡Œåç¼–è¯‘</p>
<p>å¯¹å¥‡æ€ªçš„äº¤æ˜“.pyc æ–‡ä»¶å¤´4ä¸ªå­—èŠ‚è¿›è¡Œé‡æ–°è®¾ç½®</p>
<p>python3.10ç‰ˆæœ¬çš„pycæ–‡ä»¶çš„æ–‡ä»¶å¤´æ˜¯ </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220427173936449.png" alt="image-20220427173936449"></p>
<p>è®¾ç½®å®Œä¹‹åï¼Œç”¨åœ¨çº¿pycåç¼–è¯‘è½¯ä»¶å¯ä»¥åç¼–è¯‘ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨pycdcè¿›è¡Œåç¼–è¯‘ ï¼Œå†ç”¨pycdaså¾—åˆ°å­—èŠ‚ç </p>
<p>å¯¹ç…§ç€å­—èŠ‚ç å¯¹ä¸‹é¢åç¼–è¯‘çš„ç»“æœè¿›è¡Œä¿®å¤</p>
<ul>
<li><p>RSAä½æŒ‡æ•°åŠ å¯†</p>
</li>
<li><p>ä»cpuåŒ…ä¸­å¼•å…¥å‡½æ•°encrypt()åŠ å¯†</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"># Source Generated with Decompyle++</span><br><span class="line"># File: å¥‡æ€ªçš„äº¤æ˜“.pyc (Python 3.10)</span><br><span class="line"></span><br><span class="line">from cup import *</span><br><span class="line">if __name__ == '__main__':</span><br><span class="line">    flag = input('\xe8\xaf\xb7\xe8\xbe\x93\xe5\x85\xa5flag')</span><br><span class="line">    pub_key = [   0x649EE967E7916A825CC9FD3320BEABF263BEAC68C080F52824A0F521EDB6B78577EC52BF1C9E78F4BB71192F9A23F1A17AA76E5979E4D953329D3CA65FB4A71DA57412B59DFD6AEDF0191C5555D3E5F582B81B5E6B23163E9889204A81AFFDF119FE25C92F4ED59BD3285BCD7AAE14824240D2E33C5A97848F4EB7AAC203DE6330D2B4D8FF61691544FBECD120F99A157B3D2F58FA51B2887A9D06CA383C44D071314A12B17928B96F03A06E959A5AFEFA0183664F52CD32B9FC72A04B45913FCB2D5D2D3A415A14F611CF1EAC2D6C785142A8E9CC41B67A6CD85001B06EDB8CA767D367E56E0AE651491BF8A8C17A38A1835DB9E4A9292B1D86D5776C98CC25L,</span><br><span class="line">        0x647327833ACFEF1F9C83E74E171FC300FA347D4A6769476C33DA82C95120ACB38B62B33D429206FE6E9BB0BB7AB748A1036971BEA36EC47130B749C1C9FF6FE03D0F7D9FC5346EB0E575BDFA6C530AA57CD676894FC080D2DD049AB59625F4B9C78BCFD95CDCD2793E440E26E189D251121CB6EB177FEDB596409034E8B0C5BBD9BD9342235DBB226C9170EFE347FF0FD2CFF9A1F7B647CC83E4D8F005FD7125A89251C768AFE70BDD54B88116814D5030F499BCAC4673CCCC342FB4B6AC58EA5A64546DC25912B6C430529F6A7F449FD96536DE269D1A1B015A4AC6B6E46EE19DCE8143726A6503E290E4BAE6BD78319B5878981F6CFFDB3B818209341FD68BL]</span><br><span class="line">    m = libnum.s2n(flag)</span><br><span class="line">    c = str(pow(m, pub_key[1], pub_key[0]))  // RSAçš„å…¬é’¥ pub_key[1]  æ¨¡çš„å¯¹è±¡pub_key[0]</span><br><span class="line">    array0 = []</span><br><span class="line">    array1 = [0xd28ed952,0x57c844df,0xd91ba938,0xf9f3bd2d,0x8ef8e43d,0x24d0a6d4,0x57e35037,0x57b9a2ea,0x3c5f16c0,0xd7821910,0x3b3d098c,0x1a22518d,0xc83555b7,0xe8dff468,0xbdbdffd,0xc5b84feb,0xd9f837c6,0x248c0bef,0x8efa4edd,0x5cc7851,0x8b4b608c,0x57b785f2,0xc0b62792,0x22c8fc3e,0xaab1c22d,0xbdb9c266,0x528335db,0xae9f9816,0xd1f40b3c,0x8206ddc3,0xc4e0badc,0xe407bd26,0x8ae5685,0x8016c6a5,0xaf4ab9d3,0x1e35204a,0x3b483e49,0x85082a0b,0xca0bc95a,0xa7be567c,0x41eb42c8,0x6aad143c,0xdfefb591,0x93346b38,0x4547158e,0x289465d1,0xaee1a7a2,0x80e574ae,0xf154f55f,0x7e755cdc,0xfcbda653,0x8e902444,0xca742e12,0xb8424071,0xb4b15ec2,0x943bfa09,0xbc97cd93,0x4ca0c180,0x2f9e8e58,0x8b58328f,0xf9822360,0xd1fd15ee,0x40398f89,0x559e65ca,0xa2d6c17e,0x59d616ed,0x1dd8eeb5,0xbd8c105,0x8e014807,0x347aaa04,0x7573b596,0xbfc6ee25,0x4540463f,0x2168859c,0x6a405498,0x9d93febe,0x4c9a89ad,0x2f041932,0x47454f1e,0xf2174a07,0x62a2dc3,0x952bfe83,0xf730ac4c,0x24cf49f1,0x3a4e5490,0x6a2f4289,0x8379d23a,0xead737ee,0xe41555fb,0x27500d24,0x99f3b244,0x5d1878b8,0x842c31a4,0x46e33b42,0xa14f3e4,0xa5ce044c,0x4ee902b9,0x31276ee4,0x1854ae7c,0xe0178482,0xf412bbbc,0x59f173e1,0x9ae5225,0xde740b00,0xb7cb64fd,0xebcadb1f,0x8eae2326,0x933c216c,0xd7d1f649,0x1cb99f66,0xa448ac16,0xbc082807,0x4b2a6481,0x7afa8587,0x8474a61d,0x60c272b,0xbc5654d1,0x669749b9,0x40470389,0xa8546b9,0xd3c5280f,0x5d597033,0x73920388,0x595d57ad,0xc59872f8,0x317471ac,0xe51502a2,0x38cc9816,0x4c81d679,0x79e45563,0xebe6a798,0xe09575cd,0xaddf4157,0xc4770191,0x1cbf464d,0x675e4574,0xdac71054,0x99807e43,0xa88d74b1,0xcb77e028,0x5b67a7bb,0xeeebc3b6,0xe7e680e5,0x10450af8,0x12eccbeb,0xc4b10cdc,0x91776399,0x1a32a98,0x63576ed2,0x6796abb9,0x2cc32a20,0x8e364d8f,0xa0985a77,0x218d8f16,0x837d6dc3]</span><br><span class="line">    i = 0</span><br><span class="line">    // æˆ‘è§‰å¾—æŒ‰å¸¸ç†æ¥è¯´æ˜¯å°†æ•°æ®çš„æ¯å››ä¸ªå­—èŠ‚ä¸ºä¸€ç»„ï¼Œ</span><br><span class="line">    while i &lt; len(c):</span><br><span class="line">        tem = 0</span><br><span class="line">        for ii in c[i:i+4]:</span><br><span class="line">        	tem = (tem&lt;&lt;8)+ord(ii)   //å°†è¾“å…¥çš„å…ƒç´ çš„4ä¸ªæ•°æŒ‰ç…§å¤§åºç«¯çš„æ–¹å¼æ’æˆä¸€ä¸ªæ•°</span><br><span class="line">        array0.append(tem)  // æ¯å››ä¸ªå­—èŠ‚çš„æ•°æ®ä¸€èµ·åŠ å¯†</span><br><span class="line">        i += 4</span><br><span class="line">        if not i &lt; len(c):  // åˆ¤æ–­å­—èŠ‚çš„é•¿åº¦</span><br><span class="line">            temArray = [ 54,54,54,54]</span><br><span class="line">            strLen = len(array0)</span><br><span class="line">            res = encrypt(strLen, array0, temArray)</span><br><span class="line">            if array0 == array1:</span><br><span class="line">                print('You are right!')</span><br><span class="line">                input('')</span><br><span class="line">                quit()</span><br><span class="line">            else:</span><br><span class="line">                print('Why not drink a cup of tea and have a rest?')</span><br><span class="line">    continue</span><br><span class="line">array0æ˜¯è¾“å…¥çš„æ•°æ®</span><br><span class="line">strLenæ˜¯è¾“å…¥æ•°æ®çš„é•¿åº¦</span><br><span class="line">temArrayåº”è¯¥æ˜¯å¯†é’¥</span><br><span class="line">array1æ˜¯å¯†æ–‡</span><br></pre></td></tr></tbody></table></figure>

<p>ä½†æ˜¯å› ä¸ºè¿™ä¸ªåç¼–è¯‘çš„ä»£ç ä¸å¤ªæ­£ç¡®ï¼Œæ‰€ä»¥ä½¿ç”¨pycdaså¾—åˆ°å®ƒçš„å­—èŠ‚ç ï¼š <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/45101508">å­—èŠ‚ç </a></p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br></pre></td><td class="code"><pre><span class="line">[Code]</span><br><span class="line">    File Name: å¥‡æ€ªçš„äº¤æ˜“.py</span><br><span class="line">    Object Name: &lt;module&gt;</span><br><span class="line">    Arg Count: 0</span><br><span class="line">    Pos Only Arg Count: 0</span><br><span class="line">    KW Only Arg Count: 0</span><br><span class="line">    Locals: 0</span><br><span class="line">    Stack Size: 6</span><br><span class="line">    Flags: 0x00000040 (CO_NOFREE)</span><br><span class="line">    [Names]</span><br><span class="line">        'cup'</span><br><span class="line">        '__name__'</span><br><span class="line">        'input'</span><br><span class="line">        'flag'</span><br><span class="line">        'pub_key'</span><br><span class="line">        'libnum'</span><br><span class="line">        's2n'</span><br><span class="line">        'm'</span><br><span class="line">        'str'</span><br><span class="line">        'pow'</span><br><span class="line">        'c'</span><br><span class="line">        '\xe1\x98\xa1'</span><br><span class="line">        '\xe1\x98\x99'</span><br><span class="line">        'i'</span><br><span class="line">        'len'</span><br><span class="line">        '\xe1\x98\x9e'</span><br><span class="line">        'ii'</span><br><span class="line">        'ord'</span><br><span class="line">        'append'</span><br><span class="line">        '\xe1\x98\x9d'</span><br><span class="line">        '\xe1\x98\xa0'</span><br><span class="line">        'encrypt'</span><br><span class="line">        'res'</span><br><span class="line">        'print'</span><br><span class="line">        'quit'</span><br><span class="line">    [Var Names]</span><br><span class="line">    [Free Vars]</span><br><span class="line">    [Cell Vars]</span><br><span class="line">    [Constants]</span><br><span class="line">        0</span><br><span class="line">        (</span><br><span class="line">            '*'</span><br><span class="line">        )</span><br><span class="line">        '__main__'</span><br><span class="line">        True</span><br><span class="line">        '\xe8\xaf\xb7\xe8\xbe\x93\xe5\x85\xa5flag'</span><br><span class="line">        0x649EE967E7916A825CC9FD3320BEABF263BEAC68C080F52824A0F521EDB6B78577EC52BF1C9E78F4BB71192F9A23F1A17AA76E5979E4D953329D3CA65FB4A71DA57412B59DFD6AEDF0191C5555D3E5F582B81B5E6B23163E9889204A81AFFDF119FE25C92F4ED59BD3285BCD7AAE14824240D2E33C5A97848F4EB7AAC203DE6330D2B4D8FF61691544FBECD120F99A157B3D2F58FA51B2887A9D06CA383C44D071314A12B17928B96F03A06E959A5AFEFA0183664F52CD32B9FC72A04B45913FCB2D5D2D3A415A14F611CF1EAC2D6C785142A8E9CC41B67A6CD85001B06EDB8CA767D367E56E0AE651491BF8A8C17A38A1835DB9E4A9292B1D86D5776C98CC25L</span><br><span class="line">        0x647327833ACFEF1F9C83E74E171FC300FA347D4A6769476C33DA82C95120ACB38B62B33D429206FE6E9BB0BB7AB748A1036971BEA36EC47130B749C1C9FF6FE03D0F7D9FC5346EB0E575BDFA6C530AA57CD676894FC080D2DD049AB59625F4B9C78BCFD95CDCD2793E440E26E189D251121CB6EB177FEDB596409034E8B0C5BBD9BD9342235DBB226C9170EFE347FF0FD2CFF9A1F7B647CC83E4D8F005FD7125A89251C768AFE70BDD54B88116814D5030F499BCAC4673CCCC342FB4B6AC58EA5A64546DC25912B6C430529F6A7F449FD96536DE269D1A1B015A4AC6B6E46EE19DCE8143726A6503E290E4BAE6BD78319B5878981F6CFFDB3B818209341FD68BL</span><br><span class="line">        1</span><br><span class="line">        (</span><br><span class="line">        0xd28ed952,0x57c844df,0xd91ba938,0xf9f3bd2d,0x8ef8e43d,0x24d0a6d4,0x57e35037,0x57b9a2ea,0x3c5f16c0,0xd7821910,0x3b3d098c,0x1a22518d,0xc83555b7,0xe8dff468,0xbdbdffd,0xc5b84feb,0xd9f837c6,0x248c0bef,0x8efa4edd,0x5cc7851,0x8b4b608c,0x57b785f2,0xc0b62792,0x22c8fc3e,0xaab1c22d,0xbdb9c266,0x528335db,0xae9f9816,0xd1f40b3c,0x8206ddc3,0xc4e0badc,0xe407bd26,0x8ae5685,0x8016c6a5,0xaf4ab9d3,0x1e35204a,0x3b483e49,0x85082a0b,0xca0bc95a,0xa7be567c,0x41eb42c8,0x6aad143c,0xdfefb591,0x93346b38,0x4547158e,0x289465d1,0xaee1a7a2,0x80e574ae,0xf154f55f,0x7e755cdc,0xfcbda653,0x8e902444,0xca742e12,0xb8424071,0xb4b15ec2,0x943bfa09,0xbc97cd93,0x4ca0c180,0x2f9e8e58,0x8b58328f,0xf9822360,0xd1fd15ee,0x40398f89,0x559e65ca,0xa2d6c17e,0x59d616ed,0x1dd8eeb5,0xbd8c105,0x8e014807,0x347aaa04,0x7573b596,0xbfc6ee25,0x4540463f,0x2168859c,0x6a405498,0x9d93febe,0x4c9a89ad,0x2f041932,0x47454f1e,0xf2174a07,0x62a2dc3,0x952bfe83,0xf730ac4c,0x24cf49f1,0x3a4e5490,0x6a2f4289,0x8379d23a,0xead737ee,0xe41555fb,0x27500d24,0x99f3b244,0x5d1878b8,0x842c31a4,0x46e33b42,0xa14f3e4,0xa5ce044c,0x4ee902b9,0x31276ee4,0x1854ae7c,0xe0178482,0xf412bbbc,0x59f173e1,0x9ae5225,0xde740b00,0xb7cb64fd,0xebcadb1f,0x8eae2326,0x933c216c,0xd7d1f649,0x1cb99f66,0xa448ac16,0xbc082807,0x4b2a6481,0x7afa8587,0x8474a61d,0x60c272b,0xbc5654d1,0x669749b9,0x40470389,0xa8546b9,0xd3c5280f,0x5d597033,0x73920388,0x595d57ad,0xc59872f8,0x317471ac,0xe51502a2,0x38cc9816,0x4c81d679,0x79e45563,0xebe6a798,0xe09575cd,0xaddf4157,0xc4770191,0x1cbf464d,0x675e4574,0xdac71054,0x99807e43,0xa88d74b1,0xcb77e028,0x5b67a7bb,0xeeebc3b6,0xe7e680e5,0x10450af8,0x12eccbeb,0xc4b10cdc,0x91776399,0x1a32a98,0x63576ed2,0x6796abb9,0x2cc32a20,0x8e364d8f,0xa0985a77,0x218d8f16,0x837d6dc3,</span><br><span class="line"></span><br><span class="line">        )</span><br><span class="line">        4</span><br><span class="line">        8</span><br><span class="line">        (</span><br><span class="line">            54</span><br><span class="line">            54</span><br><span class="line">            54</span><br><span class="line">            54</span><br><span class="line">        )</span><br><span class="line">        'You are right!'</span><br><span class="line">        ''</span><br><span class="line">        'Why not drink a cup of tea and have a rest?'</span><br><span class="line">        None</span><br><span class="line">    [Disassembly]</span><br><span class="line">        0       LOAD_CONST              0: 0</span><br><span class="line">        2       LOAD_CONST              1: ('*',)</span><br><span class="line">        4       IMPORT_NAME             0: cup</span><br><span class="line">        6       IMPORT_STAR             </span><br><span class="line">        8       LOAD_NAME               1: __name__</span><br><span class="line">        10      LOAD_CONST              2: '__main__'</span><br><span class="line">        12      COMPARE_OP              2 (==)</span><br><span class="line">        14      POP_JUMP_IF_FALSE       119 (to 238)</span><br><span class="line">        16      NOP                     </span><br><span class="line">        18      LOAD_NAME               2: input</span><br><span class="line">        20      LOAD_CONST              4: '\xe8\xaf\xb7\xe8\xbe\x93\xe5\x85\xa5flag'</span><br><span class="line">        22      CALL_FUNCTION           1</span><br><span class="line">        24      STORE_NAME              3: flag</span><br><span class="line">        26      LOAD_CONST              5: 0x649EE967E7916A825CC9FD3320BEABF263BEAC68C080F52824A0F521EDB6B78577EC52BF1C9E78F4BB71192F9A23F1A17AA76E5979E4D953329D3CA65FB4A71DA57412B59DFD6AEDF0191C5555D3E5F582B81B5E6B23163E9889204A81AFFDF119FE25C92F4ED59BD3285BCD7AAE14824240D2E33C5A97848F4EB7AAC203DE6330D2B4D8FF61691544FBECD120F99A157B3D2F58FA51B2887A9D06CA383C44D071314A12B17928B96F03A06E959A5AFEFA0183664F52CD32B9FC72A04B45913FCB2D5D2D3A415A14F611CF1EAC2D6C785142A8E9CC41B67A6CD85001B06EDB8CA767D367E56E0AE651491BF8A8C17A38A1835DB9E4A9292B1D86D5776C98CC25L</span><br><span class="line">        28      LOAD_CONST              6: 0x647327833ACFEF1F9C83E74E171FC300FA347D4A6769476C33DA82C95120ACB38B62B33D429206FE6E9BB0BB7AB748A1036971BEA36EC47130B749C1C9FF6FE03D0F7D9FC5346EB0E575BDFA6C530AA57CD676894FC080D2DD049AB59625F4B9C78BCFD95CDCD2793E440E26E189D251121CB6EB177FEDB596409034E8B0C5BBD9BD9342235DBB226C9170EFE347FF0FD2CFF9A1F7B647CC83E4D8F005FD7125A89251C768AFE70BDD54B88116814D5030F499BCAC4673CCCC342FB4B6AC58EA5A64546DC25912B6C430529F6A7F449FD96536DE269D1A1B015A4AC6B6E46EE19DCE8143726A6503E290E4BAE6BD78319B5878981F6CFFDB3B818209341FD68BL</span><br><span class="line">        30      BUILD_LIST              2</span><br><span class="line">        32      STORE_NAME              4: pub_key</span><br><span class="line">        34      LOAD_NAME               5: libnum</span><br><span class="line">        36      LOAD_METHOD             6: s2n</span><br><span class="line">        38      LOAD_NAME               3: flag</span><br><span class="line">        40      CALL_METHOD             1</span><br><span class="line">        42      STORE_NAME              7: m</span><br><span class="line">        44      LOAD_NAME               8: str</span><br><span class="line">        46      LOAD_NAME               9: pow</span><br><span class="line">        48      LOAD_NAME               7: m</span><br><span class="line">        50      LOAD_NAME               4: pub_key</span><br><span class="line">        52      LOAD_CONST              7: 1</span><br><span class="line">        54      BINARY_SUBSCR           </span><br><span class="line">        56      LOAD_NAME               4: pub_key</span><br><span class="line">        58      LOAD_CONST              0: 0</span><br><span class="line">        60      BINARY_SUBSCR           </span><br><span class="line">        62      CALL_FUNCTION           3</span><br><span class="line">        64      CALL_FUNCTION           1</span><br><span class="line">        66      STORE_NAME              10: c</span><br><span class="line">        68      BUILD_LIST              0</span><br><span class="line">        70      STORE_NAME              11: store</span><br><span class="line">        72      BUILD_LIST              0</span><br><span class="line">        74      LOAD_CONST              8: (0xD28ED952L, 1472742623, 0xD91BA938L, 0xF9F3BD2DL, 0x8EF8E43DL, 617653972, 1474514999, 1471783658, 1012864704, 0xD7821910L, 993855884, 438456717, 0xC83555B7L, 0xE8DFF468L, 198959101, 0xC5B84FEBL, 0xD9F837C6L, 613157871, 0x8EFA4EDDL, 97286225, 0x8B4B608CL, 1471645170, 0xC0B62792L, 583597118, 0xAAB1C22DL, 0xBDB9C266L, 1384330715, 0xAE9F9816L, 0xD1F40B3CL, 0x8206DDC3L, 0xC4E0BADCL, 0xE407BD26L, 145643141, 0x8016C6A5L, 0xAF4AB9D3L, 506798154, 994590281, 0x85082A0BL, 0xCA0BC95AL, 0xA7BE567CL, 1105937096, 1789727804, 0xDFEFB591L, 0x93346B38L, 1162286478, 680814033, 0xAEE1A7A2L, 0x80E574AEL, 0xF154F55FL, 2121620700, 0xFCBDA653L, 0x8E902444L, 0xCA742E12L, 0xB8424071L, 0xB4B15EC2L, 0x943BFA09L, 0xBC97CD93L, 1285603712, 798920280, 0x8B58328FL, 0xF9822360L, 0xD1FD15EEL, 1077514121, 1436444106, 0xA2D6C17EL, 1507202797, 500756149, 198754565, 0x8E014807L, 880454148, 1970517398, 0xBFC6EE25L, 1161840191, 560498076, 1782600856, 0x9D93FEBEL, 1285196205, 788797746, 1195724574, 0xF2174A07L, 103427523, 0x952BFE83L, 0xF730AC4CL, 617564657, 978211984, 1781482121, 0x8379D23AL, 0xEAD737EEL, 0xE41555FBL, 659557668, 0x99F3B244L, 1561884856, 0x842C31A4L, 1189296962, 169145316, 0xA5CE044CL, 1323893433, 824667876, 408202876, 0xE0178482L, 0xF412BBBCL, 1508996065, 162419237, 0xDE740B00L, 0xB7CB64FDL, 0xEBCADB1FL, 0x8EAE2326L, 0x933C216CL, 0xD7D1F649L, 481927014, 0xA448AC16L, 0xBC082807L, 1261069441, 2063238535, 0x8474A61DL, 101459755, 0xBC5654D1L, 1721190841, 1078395785, 176506553, 0xD3C5280FL, 1566142515, 1938949000, 1499289517, 0xC59872F8L, 829714860, 0xE51502A2L, 952932374, 1283577465, 2045007203, 0xEBE6A798L, 0xE09575CDL, 0xADDF4157L, 0xC4770191L, 482297421, 1734231412, 0xDAC71054L, 0x99807E43L, 0xA88D74B1L, 0xCB77E028L, 1533519803, 0xEEEBC3B6L, 0xE7E680E5L, 272960248, 317508587, 0xC4B10CDCL, 0x91776399L, 27470488, 1666674386, 1737927609, 750987808, 0x8E364D8FL, 0xA0985A77L, 562925334, 0x837D6DC3L)</span><br><span class="line">        76      LIST_EXTEND             1</span><br><span class="line">        78      STORE_NAME              12: á˜™</span><br><span class="line">        80      LOAD_CONST              0: 0</span><br><span class="line">        82      STORE_NAME              13: i</span><br><span class="line">        84      LOAD_NAME               13: i</span><br><span class="line">        86      LOAD_NAME               14: len      while i&lt;len(c):</span><br><span class="line">        88      LOAD_NAME               10: c</span><br><span class="line">        90      CALL_FUNCTION           1</span><br><span class="line">        92      COMPARE_OP              0 (&lt;)</span><br><span class="line">        94      POP_JUMP_IF_FALSE       84 (to 168) // å½“ä¸æˆç«‹çš„æ—¶å€™å°±é”™è¯¯çš„è·³è½¬</span><br><span class="line">        96      LOAD_CONST              0: 0</span><br><span class="line">        98      STORE_NAME              15: index   index = 0</span><br><span class="line">        100     LOAD_NAME               10: c</span><br><span class="line">        102     LOAD_NAME               13: i</span><br><span class="line">        104     LOAD_NAME               13: i</span><br><span class="line">        106     LOAD_CONST              9: 4</span><br><span class="line">        108     BINARY_ADD                   // i+4</span><br><span class="line">        110     BUILD_SLICE             2    c[i:i+4]</span><br><span class="line">        112     BINARY_SUBSCR               // è¯»å–å…¶ä¸­çš„å€¼    </span><br><span class="line">        114     GET_ITER                    // å¼€å§‹è¿­ä»£</span><br><span class="line">        116     FOR_ITER                10 (to 138)</span><br><span class="line">        118     STORE_NAME              16: ii</span><br><span class="line">        120     LOAD_NAME               15: index</span><br><span class="line">        122     LOAD_CONST              10: 8</span><br><span class="line">        124     BINARY_LSHIFT           // index&lt;&lt;8</span><br><span class="line">        126     LOAD_NAME               17: ord</span><br><span class="line">        128     LOAD_NAME               16: ii</span><br><span class="line">        130     CALL_FUNCTION           1</span><br><span class="line">        132     BINARY_ADD              (index&lt;&lt;8)+ord(ii)</span><br><span class="line">        134     STORE_NAME              15: index   index =  (index&lt;&lt;8)+ord(ii)</span><br><span class="line">        136     JUMP_ABSOLUTE           58</span><br><span class="line">        138     LOAD_NAME               11: store</span><br><span class="line">        140     LOAD_METHOD             18: append</span><br><span class="line">        142     LOAD_NAME               15: index   </span><br><span class="line">        144     CALL_METHOD             1    store.append(index)</span><br><span class="line">        146     POP_TOP                 </span><br><span class="line">        148     LOAD_NAME               13: i</span><br><span class="line">        150     LOAD_CONST              9: 4</span><br><span class="line">        152     INPLACE_ADD               // i = i+4</span><br><span class="line">        154     STORE_NAME              13: i</span><br><span class="line">        156     LOAD_NAME               13: i</span><br><span class="line">        158     LOAD_NAME               14: len</span><br><span class="line">        160     LOAD_NAME               10: c</span><br><span class="line">        162     CALL_FUNCTION           1</span><br><span class="line">        164     COMPARE_OP              0 (&lt;)  i&lt;len(c)</span><br><span class="line">        166     POP_JUMP_IF_TRUE        48 (to 96)     if not i&lt;len(c):</span><br><span class="line">        168     BUILD_LIST              0</span><br><span class="line">        170     LOAD_CONST              11: (54, 54, 54, 54)</span><br><span class="line">        172     LIST_EXTEND             1</span><br><span class="line">        174     STORE_NAME              19: á˜</span><br><span class="line">        176     LOAD_NAME               14: len</span><br><span class="line">        178     LOAD_NAME               11: store</span><br><span class="line">        180     CALL_FUNCTION           1</span><br><span class="line">        182     STORE_NAME              20: á˜ </span><br><span class="line">        184     LOAD_NAME               21: encrypt</span><br><span class="line">        186     LOAD_NAME               20: á˜ </span><br><span class="line">        188     LOAD_NAME               11: store</span><br><span class="line">        190     LOAD_NAME               19: á˜</span><br><span class="line">        192     CALL_FUNCTION           3</span><br><span class="line">        194     STORE_NAME              22: res</span><br><span class="line">        196     LOAD_NAME               11: store</span><br><span class="line">        198     LOAD_NAME               12: á˜™</span><br><span class="line">        200     COMPARE_OP              2 (==)</span><br><span class="line">        202     POP_JUMP_IF_FALSE       114 (to 228)</span><br><span class="line">        204     LOAD_NAME               23: print</span><br><span class="line">        206     LOAD_CONST              12: 'You are right!'</span><br><span class="line">        208     CALL_FUNCTION           1</span><br><span class="line">        210     POP_TOP                 </span><br><span class="line">        212     LOAD_NAME               2: input</span><br><span class="line">        214     LOAD_CONST              13: ''</span><br><span class="line">        216     CALL_FUNCTION           1</span><br><span class="line">        218     POP_TOP                 </span><br><span class="line">        220     LOAD_NAME               24: quit</span><br><span class="line">        222     CALL_FUNCTION           0</span><br><span class="line">        224     POP_TOP                 </span><br><span class="line">        226     JUMP_FORWARD            4 (to 236)</span><br><span class="line">        228     LOAD_NAME               23: print</span><br><span class="line">        230     LOAD_CONST              14: 'Why not drink a cup of tea and have a rest?'</span><br><span class="line">        232     CALL_FUNCTION           1</span><br><span class="line">        234     POP_TOP                 </span><br><span class="line">        236     JUMP_ABSOLUTE           9</span><br><span class="line">        238     LOAD_CONST              15: None</span><br><span class="line">        240     RETURN_VALUE            </span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<h3 id="pyzæ–‡ä»¶è§£å¯†"><a href="#pyzæ–‡ä»¶è§£å¯†" class="headerlink" title="pyzæ–‡ä»¶è§£å¯†"></a>pyzæ–‡ä»¶è§£å¯†</h3><p>é€ä¸Šé¢ä¿®å¤çš„åç¼–è¯‘çš„ç»“æœä¹‹ä¸­æˆ‘ä»¬èƒ½å¤Ÿçœ‹åˆ°ï¼Œè¿™é‡Œå¼•ç”¨äº†ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯é‡cupè¿™ä¸ªåŒ…ä¸­å¯¼å…¥çš„</p>
<p>è¿™ä¸ªåŒ…çš„è·å¾—æ˜¯åœ¨PYZ-00.pyz_extractedæ–‡ä»¶å¤¹ï¼š</p>
<blockquote>
<p>ä¸€èˆ¬ä¸€ä¸ªç¨å¾®å¤§ä¸€ç‚¹çš„é¡¹ç›®éƒ½ä¼šåˆ†æˆå¤šä¸ªpyæ–‡ä»¶ï¼Œç”šè‡³ä¼šä¾èµ–å…¶ä»–æ¨¡å—ï¼Œè¿™äº›è¢«ä¾èµ–çš„æ–‡ä»¶è§£æåéƒ½ä¼šæ”¾å…¥PYZ-00.pyz_extractedæ–‡ä»¶å¤¹ä¹‹ä¸­ï¼Œè¿™ä¸ªæ–‡ä»¶ä¹‹ä¸­ç›¸å½“äºæ”¾çš„æ˜¯æ ¸å¿ƒä»£ç ï¼Œè¿™ä¸ªæ–‡ä»¶ä¹‹ä¸­æ”¾å…¥çš„å°±æ˜¯PYZ-00.pyzè¿™ä¸ªæ–‡ä»¶è§£å‹ä¹‹åå¾—åˆ°çš„æ–‡ä»¶ï¼Œæ³¨æ„è¿™ä¸ªæ–‡ä»¶æƒ³è¦ç”¨pyinstxtractor.pyæ­£å¸¸å¾—åˆ°ï¼Œæˆ‘ä»¬éœ€è¦åœ¨è¿™ä¸ªpycç›¸å¯¹åº”çš„pythonç¯å¢ƒä¹‹ä¸­è¿è¡Œè¯¥è„šæœ¬ï¼ˆä¸Šé¢å·²ç»ä»‹ç»äº†æ€ä¹ˆç®¡ç†å¤šä¸ªpythonç¯å¢ƒï¼‰</p>
</blockquote>
<p>è¿™é‡Œçš„pyzæ–‡ä»¶è¿›è¡Œäº†åŠ å¯†ï¼Œå› ä¸ºpyinstallerå¯ä»¥å°†æ–‡ä»¶pycè¿›è¡Œä¸€å®šçš„å‹ç¼©åŠ å¯†ï¼Œä»¥é˜²æ­¢è¢«é€†å‘</p>
<p><a target="_blank" rel="noopener" href="https://bbs.pediy.com/thread-271253.htm">pyzæ–‡ä»¶åŠ å¯†è§£å¯†</a></p>
<h4 id="pyzæ–‡ä»¶åŠ å¯†çš„å¯†é’¥å’Œè¿‡ç¨‹çš„æ–‡ä»¶"><a href="#pyzæ–‡ä»¶åŠ å¯†çš„å¯†é’¥å’Œè¿‡ç¨‹çš„æ–‡ä»¶" class="headerlink" title="pyzæ–‡ä»¶åŠ å¯†çš„å¯†é’¥å’Œè¿‡ç¨‹çš„æ–‡ä»¶"></a>pyzæ–‡ä»¶åŠ å¯†çš„å¯†é’¥å’Œè¿‡ç¨‹çš„æ–‡ä»¶</h4><p>é€šè¿‡pyinstxtractorè·å¾—äº†éƒ¨åˆ†æ²¡æœ‰åŠ å¯†çš„pycæ–‡ä»¶ï¼Œå…¶ä¸­å°±æœ‰archive.pycæ–‡ä»¶ï¼ˆå¾—åˆ°åŠ å¯†è¿‡ç¨‹ï¼‰å’Œcrypto_keyæ–‡ä»¶(å¾—åˆ°å…·ä½“keyå‚æ•°)</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220504152929032.png" alt="image-20220504152929032"></p>
<p>archive.pycæ–‡ä»¶:(åç¼–è¯‘)</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220504153248511.png" alt="image-20220504153248511"></p>
<p>åŠ å¯†çš„å…³é”®ä»£ç </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220504153401888.png" alt="image-20220504153401888"></p>
<p>crypto_keyæ–‡ä»¶:(åç¼–è¯‘)</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">key = '0000000000000tea'</span><br></pre></td></tr></tbody></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220504153121767.png" alt="image-20220504153121767"></p>
<p>å› ä¸ºåœ¨æºåŠ å¯†ä»£ç ä¹‹ä¸­åŠ å¯†å‡½æ•°æ˜¯ä»cupè¿™ä¸ªåŒ…ä¹‹ä¸­å¼•å…¥çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨é‚£ä¸ªè§£å‹ç¼©ä¹‹åå¾—åˆ°çš„æ–‡ä»¶å¤¹ä¹‹ä¸­æ‰¾åˆ°å¯¹åº”çš„å¯¹åº”çš„åŒ…çš„åŠ å¯†æ–‡ä»¶</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF2022-FATE/image-20220504154026910.png" alt="image-20220504154026910"></p>
<h4 id="pyzæ–‡ä»¶è§£å¯†è„šæœ¬"><a href="#pyzæ–‡ä»¶è§£å¯†è„šæœ¬" class="headerlink" title="pyzæ–‡ä»¶è§£å¯†è„šæœ¬"></a>pyzæ–‡ä»¶è§£å¯†è„šæœ¬</h4><p><a target="_blank" rel="noopener" href="https://github.com/extremecoders-re/pyinstxtractor/wiki/Frequently-Asked-Questions">è§£å¯†</a>è¯¥æ–‡ä»¶ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">import tinyaes</span><br><span class="line">import zlib</span><br><span class="line"></span><br><span class="line">CRYPT_BLOCK_SIZE = 16</span><br><span class="line"></span><br><span class="line"># key obtained from pyimod00_crypto_key</span><br><span class="line">key = bytes('0000000000000tea', 'utf-8')</span><br><span class="line"></span><br><span class="line">inf = open('cup.pyc.encrypted', 'rb') # encrypted file input</span><br><span class="line">outf = open('cup.pyc', 'wb') # output file</span><br><span class="line"></span><br><span class="line"># Initialization vector</span><br><span class="line">iv = inf.read(CRYPT_BLOCK_SIZE)</span><br><span class="line"></span><br><span class="line">cipher = tinyaes.AES(key, iv)</span><br><span class="line"></span><br><span class="line"># Decrypt and decompress</span><br><span class="line">plaintext = zlib.decompress(cipher.CTR_xcrypt_buffer(inf.read()))</span><br><span class="line"></span><br><span class="line"># Write pyc header</span><br><span class="line"># The header below is for Python 3.8</span><br><span class="line">outf.write(b'\x6f\x0d\x0d\x0a\0\0\0\0\0\0\0\0\0\0\0\0')</span><br><span class="line"></span><br><span class="line"># Write decrypted data</span><br><span class="line">outf.write(plaintext)</span><br><span class="line"></span><br><span class="line">inf.close()</span><br><span class="line">outf.close()</span><br></pre></td></tr></tbody></table></figure>

<p>å„ä¸ªpythonç‰ˆæœ¬æ‰“åŒ…çš„pycæ–‡ä»¶çš„æ–‡ä»¶å¤´ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Python 2.7: \x03\xf3\x0d\x0a\0\0\0\0</span><br><span class="line">Python 3.0: \x3b\x0c\x0d\x0a\0\0\0\0</span><br><span class="line">Python 3.1: \x4f\x0c\x0d\x0a\0\0\0\0</span><br><span class="line">Python 3.2: \x6c\x0c\x0d\x0a\0\0\0\0</span><br><span class="line">Python 3.3: \x9e\x0c\x0d\x0a\0\0\0\0\0\0\0\0</span><br><span class="line">Python 3.4: \xee\x0c\x0d\x0a\0\0\0\0\0\0\0\0</span><br><span class="line">Python 3.5: \x17\x0d\x0d\x0a\0\0\0\0\0\0\0\0</span><br><span class="line">Python 3.6: \x33\x0d\x0d\x0a\0\0\0\0\0\0\0\0</span><br><span class="line">Python 3.7: \x42\x0d\x0d\x0a\0\0\0\0\0\0\0\0\0\0\0\0</span><br><span class="line">Python 3.8: \x55\x0d\x0d\x0a\0\0\0\0\0\0\0\0\0\0\0\0</span><br><span class="line">Python 3.9: \x61\x0d\x0d\x0a\0\0\0\0\0\0\0\0\0\0\0\0</span><br><span class="line">Python 3.10: \x6f\x0d\x0d\x0a\0\0\0\0\0\0\0\0\0\0\0\0</span><br></pre></td></tr></tbody></table></figure>

<h3 id="xxteaè§£å¯†"><a href="#xxteaè§£å¯†" class="headerlink" title="xxteaè§£å¯†"></a>xxteaè§£å¯†</h3><p>å¾—åˆ°çš„åŠ å¯†å‡½æ•°encrypt()çš„pycæ–‡ä»¶ï¼Œæ‰€ä»¥å¯¹è¿™ä¸ªæ–‡ä»¶åç¼–è¯‘å°±èƒ½å¤ŸçŸ¥é“å‡½æ•°é€»è¾‘</p>
<p>å¯ä»¥çœ‹åˆ°è¿™é‡ŒåŠ å¯†çš„æ–¹æ³•æ˜¯xxteaï¼Œè¿™é‡Œåç¼–è¯‘å¾—åˆ°çš„ä»£ç è¿˜æ˜¯æœ‰ç‚¹é—®é¢˜ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥æ˜æ˜¾çš„çŸ¥é“è¿™ä¸ªåœ°æ–¹ç”¨çš„éƒ½æ˜¯xxteaåŠ å¯†</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"># visit https://tool.lu/pyc/ for more information</span><br><span class="line"># Version: Python 3.10</span><br><span class="line"></span><br><span class="line">import libnum</span><br><span class="line">from ctypes import *</span><br><span class="line"></span><br><span class="line">def MX(z, y, total, key, p, e):</span><br><span class="line">    temp1 = (z.value &gt;&gt; 5 ^ y.value &lt;&lt; 2) + (y.value &gt;&gt; 3 ^ z.value &lt;&lt; 4)</span><br><span class="line">    temp2 = (total.value ^ y.value) + (key[p &amp; 3 ^ e.value] ^ z.value)</span><br><span class="line">    return c_uint32(temp1 ^ temp2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def encrypt(n, v, key):</span><br><span class="line">    DELTA = 0x9E3779B9L</span><br><span class="line">    rounds = 6 + 52 // n</span><br><span class="line">    total = c_uint32(0)</span><br><span class="line">    z = c_uint32(v[n - 1])</span><br><span class="line">    e = c_uint32(0)</span><br><span class="line">    while rounds &gt; 0:</span><br><span class="line">        total.value += DELTA</span><br><span class="line">        e.value = total.value &gt;&gt; 2 &amp; 3</span><br><span class="line">        y = c_uint32(v[0])</span><br><span class="line">        v[n - 1] = c_uint32(v[n - 1] + MX(z, y, total, key, n - 1, e).value).value</span><br><span class="line">        z.value = v[n - 1]</span><br><span class="line">        rounds -= 1</span><br><span class="line">        if not rounds &gt; 0:</span><br><span class="line">            return v</span><br></pre></td></tr></tbody></table></figure>

<p>æ‰€ä»¥xxteaè§£å¯†ï¼š</p>
<p>å› ä¸ºåŠ å¯†çš„æ•°æ®æ˜¯æŒ‰ç…§å¤§åºç«¯å­˜æ”¾çš„ï¼Œå¹¶ä¸”ç»™å¾—åˆ°çš„æ˜¯ç»è¿‡rsaåŠ å¯†çš„æ•°å­—çš„å­—ç¬¦ä¸²</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DELTA 0x9E3779B9</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MX (((z&gt;&gt;5^y<span class="string">&lt;&lt;2) + (y&gt;</span>&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">btea</span><span class="params">(<span class="type">uint32_t</span> *v, <span class="type">int</span> n, <span class="type">uint32_t</span> <span class="type">const</span> key[<span class="number">4</span>])</span></span><br><span class="line">{</span><br><span class="line">    <span class="type">uint32_t</span> y, z, sum;</span><br><span class="line">    <span class="type">unsigned</span> p, rounds, e;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>)            <span class="comment">/* Coding Part */</span></span><br><span class="line">    {</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span>/n;</span><br><span class="line">        sum = <span class="number">0</span>;</span><br><span class="line">        z = v[n<span class="number">-1</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        {</span><br><span class="line">            sum += DELTA;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p=<span class="number">0</span>; p&lt;n<span class="number">-1</span>; p++)</span><br><span class="line">            {</span><br><span class="line">                y = v[p+<span class="number">1</span>];</span><br><span class="line">                z = v[p] += MX;</span><br><span class="line">            }</span><br><span class="line">            y = v[<span class="number">0</span>];</span><br><span class="line">            z = v[n<span class="number">-1</span>] += MX;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">while</span> (--rounds);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n &lt; <span class="number">-1</span>)      <span class="comment">/* Decoding Part */</span></span><br><span class="line">    {</span><br><span class="line">        n = -n;</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span>/n;</span><br><span class="line">        sum = rounds*DELTA;</span><br><span class="line">        y = v[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        {</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p=n<span class="number">-1</span>; p&gt;<span class="number">0</span>; p--)</span><br><span class="line">            {</span><br><span class="line">                z = v[p<span class="number">-1</span>];</span><br><span class="line">                y = v[p] -= MX;</span><br><span class="line">            }</span><br><span class="line">            z = v[n<span class="number">-1</span>];</span><br><span class="line">            y = v[<span class="number">0</span>] -= MX;</span><br><span class="line">            sum -= DELTA;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">while</span> (--rounds);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">{</span><br><span class="line">    <span class="type">uint32_t</span> v[]= {<span class="number">0xd28ed952</span>,<span class="number">0x57c844df</span>,<span class="number">0xd91ba938</span>,<span class="number">0xf9f3bd2d</span>,<span class="number">0x8ef8e43d</span>,<span class="number">0x24d0a6d4</span>,<span class="number">0x57e35037</span>,<span class="number">0x57b9a2ea</span>,<span class="number">0x3c5f16c0</span>,<span class="number">0xd7821910</span>,<span class="number">0x3b3d098c</span>,<span class="number">0x1a22518d</span>,<span class="number">0xc83555b7</span>,<span class="number">0xe8dff468</span>,<span class="number">0xbdbdffd</span>,<span class="number">0xc5b84feb</span>,<span class="number">0xd9f837c6</span>,<span class="number">0x248c0bef</span>,<span class="number">0x8efa4edd</span>,<span class="number">0x5cc7851</span>,<span class="number">0x8b4b608c</span>,<span class="number">0x57b785f2</span>,<span class="number">0xc0b62792</span>,<span class="number">0x22c8fc3e</span>,<span class="number">0xaab1c22d</span>,<span class="number">0xbdb9c266</span>,<span class="number">0x528335db</span>,<span class="number">0xae9f9816</span>,<span class="number">0xd1f40b3c</span>,<span class="number">0x8206ddc3</span>,<span class="number">0xc4e0badc</span>,<span class="number">0xe407bd26</span>,<span class="number">0x8ae5685</span>,<span class="number">0x8016c6a5</span>,<span class="number">0xaf4ab9d3</span>,<span class="number">0x1e35204a</span>,<span class="number">0x3b483e49</span>,<span class="number">0x85082a0b</span>,<span class="number">0xca0bc95a</span>,<span class="number">0xa7be567c</span>,<span class="number">0x41eb42c8</span>,<span class="number">0x6aad143c</span>,<span class="number">0xdfefb591</span>,<span class="number">0x93346b38</span>,<span class="number">0x4547158e</span>,<span class="number">0x289465d1</span>,<span class="number">0xaee1a7a2</span>,<span class="number">0x80e574ae</span>,<span class="number">0xf154f55f</span>,<span class="number">0x7e755cdc</span>,<span class="number">0xfcbda653</span>,<span class="number">0x8e902444</span>,<span class="number">0xca742e12</span>,<span class="number">0xb8424071</span>,<span class="number">0xb4b15ec2</span>,<span class="number">0x943bfa09</span>,<span class="number">0xbc97cd93</span>,<span class="number">0x4ca0c180</span>,<span class="number">0x2f9e8e58</span>,<span class="number">0x8b58328f</span>,<span class="number">0xf9822360</span>,<span class="number">0xd1fd15ee</span>,<span class="number">0x40398f89</span>,<span class="number">0x559e65ca</span>,<span class="number">0xa2d6c17e</span>,<span class="number">0x59d616ed</span>,<span class="number">0x1dd8eeb5</span>,<span class="number">0xbd8c105</span>,<span class="number">0x8e014807</span>,<span class="number">0x347aaa04</span>,<span class="number">0x7573b596</span>,<span class="number">0xbfc6ee25</span>,<span class="number">0x4540463f</span>,<span class="number">0x2168859c</span>,<span class="number">0x6a405498</span>,<span class="number">0x9d93febe</span>,<span class="number">0x4c9a89ad</span>,<span class="number">0x2f041932</span>,<span class="number">0x47454f1e</span>,<span class="number">0xf2174a07</span>,<span class="number">0x62a2dc3</span>,<span class="number">0x952bfe83</span>,<span class="number">0xf730ac4c</span>,<span class="number">0x24cf49f1</span>,<span class="number">0x3a4e5490</span>,<span class="number">0x6a2f4289</span>,<span class="number">0x8379d23a</span>,<span class="number">0xead737ee</span>,<span class="number">0xe41555fb</span>,<span class="number">0x27500d24</span>,<span class="number">0x99f3b244</span>,<span class="number">0x5d1878b8</span>,<span class="number">0x842c31a4</span>,<span class="number">0x46e33b42</span>,<span class="number">0xa14f3e4</span>,<span class="number">0xa5ce044c</span>,<span class="number">0x4ee902b9</span>,<span class="number">0x31276ee4</span>,<span class="number">0x1854ae7c</span>,<span class="number">0xe0178482</span>,<span class="number">0xf412bbbc</span>,<span class="number">0x59f173e1</span>,<span class="number">0x9ae5225</span>,<span class="number">0xde740b00</span>,<span class="number">0xb7cb64fd</span>,<span class="number">0xebcadb1f</span>,<span class="number">0x8eae2326</span>,<span class="number">0x933c216c</span>,<span class="number">0xd7d1f649</span>,<span class="number">0x1cb99f66</span>,<span class="number">0xa448ac16</span>,<span class="number">0xbc082807</span>,<span class="number">0x4b2a6481</span>,<span class="number">0x7afa8587</span>,<span class="number">0x8474a61d</span>,<span class="number">0x60c272b</span>,<span class="number">0xbc5654d1</span>,<span class="number">0x669749b9</span>,<span class="number">0x40470389</span>,<span class="number">0xa8546b9</span>,<span class="number">0xd3c5280f</span>,<span class="number">0x5d597033</span>,<span class="number">0x73920388</span>,<span class="number">0x595d57ad</span>,<span class="number">0xc59872f8</span>,<span class="number">0x317471ac</span>,<span class="number">0xe51502a2</span>,<span class="number">0x38cc9816</span>,<span class="number">0x4c81d679</span>,<span class="number">0x79e45563</span>,<span class="number">0xebe6a798</span>,<span class="number">0xe09575cd</span>,<span class="number">0xaddf4157</span>,<span class="number">0xc4770191</span>,<span class="number">0x1cbf464d</span>,<span class="number">0x675e4574</span>,<span class="number">0xdac71054</span>,<span class="number">0x99807e43</span>,<span class="number">0xa88d74b1</span>,<span class="number">0xcb77e028</span>,<span class="number">0x5b67a7bb</span>,<span class="number">0xeeebc3b6</span>,<span class="number">0xe7e680e5</span>,<span class="number">0x10450af8</span>,<span class="number">0x12eccbeb</span>,<span class="number">0xc4b10cdc</span>,<span class="number">0x91776399</span>,<span class="number">0x1a32a98</span>,<span class="number">0x63576ed2</span>,<span class="number">0x6796abb9</span>,<span class="number">0x2cc32a20</span>,<span class="number">0x8e364d8f</span>,<span class="number">0xa0985a77</span>,<span class="number">0x218d8f16</span>,<span class="number">0x837d6dc3</span>,<span class="number">0x0</span>};</span><br><span class="line">    <span class="type">uint32_t</span> <span class="type">const</span> k[<span class="number">4</span>]= {<span class="number">54</span>,<span class="number">54</span>,<span class="number">54</span>,<span class="number">54</span>};</span><br><span class="line">    <span class="type">int</span> n= <span class="number">155</span>; <span class="comment">//nçš„ç»å¯¹å€¼è¡¨ç¤ºvçš„é•¿åº¦ï¼Œå–æ­£è¡¨ç¤ºåŠ å¯†ï¼Œå–è´Ÿè¡¨ç¤ºè§£å¯†</span></span><br><span class="line">    <span class="comment">// vä¸ºè¦åŠ å¯†çš„æ•°æ®æ˜¯ä¸¤ä¸ª32ä½æ— ç¬¦å·æ•´æ•°</span></span><br><span class="line">    <span class="comment">// kä¸ºåŠ å¯†è§£å¯†å¯†é’¥ï¼Œä¸º4ä¸ª32ä½æ— ç¬¦å·æ•´æ•°ï¼Œå³å¯†é’¥é•¿åº¦ä¸º128ä½</span></span><br><span class="line"><span class="comment">//    printf("åŠ å¯†å‰åŸå§‹æ•°æ®ï¼š%s\n",(char*)v);</span></span><br><span class="line"><span class="comment">//    btea(v, n, k);</span></span><br><span class="line"><span class="comment">//    printf("åŠ å¯†åçš„æ•°æ®ï¼š%u %u %u\n",v[0],v[1],v[3]);</span></span><br><span class="line">    btea(v, -n, k);</span><br><span class="line"><span class="comment">//    printf("è§£å¯†åçš„æ•°æ®ï¼š%s\n",(char*)v);</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">155</span>;i++)</span><br><span class="line">{</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;<span class="number">4</span>;j++)</span><br><span class="line">    {</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%c"</span>,((v[i]&gt;&gt;<span class="number">24</span>)&amp;<span class="number">0xff</span>));</span><br><span class="line">        v[i] = v[i]&lt;&lt;<span class="number">8</span>; <span class="comment">// å°†è¿™ä¸ªæ•°å·¦ç§»8ä½</span></span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p>xxteaè§£å¯†ç»“æœï¼šï¼ˆRSAçš„å¯†æ–‡ï¼‰</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10610336534759505889607399322387179316771488492347274741918862678692508953185876570981227584004676580623553664818853686933004290078153620168054665086468417541382824708104480882577200529822968531743002301934310349005341104696887943182074473298650903541494918266823037984054778903666406545980557074219162536057146090758158128189406073809226361445046225524917089434897957301396534515964547462425719205819342172669899546965221084098690893672595962129879041507903210851706793788311452973769358455761907303633956322972510500253009083922781934406731633755418753858930476576720874219359466503538931371444470303193503733920039</span><br></pre></td></tr></tbody></table></figure>

<h3 id="RSAä½è§£å¯†æŒ‡æ•°æ”»å‡»"><a href="#RSAä½è§£å¯†æŒ‡æ•°æ”»å‡»" class="headerlink" title="RSAä½è§£å¯†æŒ‡æ•°æ”»å‡»"></a>RSAä½è§£å¯†æŒ‡æ•°æ”»å‡»</h3><p>RSAè§£å¯†ï¼Œåœ¨é¢˜ç›®ä¹‹ä¸­æä¾›äº†nå’Œå…¬é’¥ </p>
<p>ç´ æ•°åˆ†è§£çš„ç½‘ç«™ <a target="_blank" rel="noopener" href="http://www.factordb.com/index.php%EF%BC%88%E8%BF%99%E9%81%93%E9%A2%98%E7%94%A8%E4%B8%8D%E4%B8%8A%EF%BC%89">http://www.factordb.com/index.phpï¼ˆè¿™é“é¢˜ç”¨ä¸ä¸Šï¼‰</a></p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">e = 0x647327833ACFEF1F9C83E74E171FC300FA347D4A6769476C33DA82C95120ACB38B62B33D429206FE6E9BB0BB7AB748A1036971BEA36EC47130B749C1C9FF6FE03D0F7D9FC5346EB0E575BDFA6C530AA57CD676894FC080D2DD049AB59625F4B9C78BCFD95CDCD2793E440E26E189D251121CB6EB177FEDB596409034E8B0C5BBD9BD9342235DBB226C9170EFE347FF0FD2CFF9A1F7B647CC83E4D8F005FD7125A89251C768AFE70BDD54B88116814D5030F499BCAC4673CCCC342FB4B6AC58EA5A64546DC25912B6C430529F6A7F449FD96536DE269D1A1B015A4AC6B6E46EE19DCE8143726A6503E290E4BAE6BD78319B5878981F6CFFDB3B818209341FD68B</span><br><span class="line">n = </span><br><span class="line">0x649EE967E7916A825CC9FD3320BEABF263BEAC68C080F52824A0F521EDB6B78577EC52BF1C9E78F4BB71192F9A23F1A17AA76E5979E4D953329D3CA65FB4A71DA57412B59DFD6AEDF0191C5555D3E5F582B81B5E6B23163E9889204A81AFFDF119FE25C92F4ED59BD3285BCD7AAE14824240D2E33C5A97848F4EB7AAC203DE6330D2B4D8FF61691544FBECD120F99A157B3D2F58FA51B2887A9D06CA383C44D071314A12B17928B96F03A06E959A5AFEFA0183664F52CD32B9FC72A04B45913FCB2D5D2D3A415A14F611CF1EAC2D6C785142A8E9CC41B67A6CD85001B06EDB8CA767D367E56E0AE651491BF8A8C17A38A1835DB9E4A9292B1D86D5776C98CC25</span><br></pre></td></tr></tbody></table></figure>

<p>è¿™é‡Œçš„RSAæ˜¯ä½è§£å¯†æŒ‡æ•°æ”»å‡»</p>
<blockquote>
<p>åœ¨RSAä¸­dä¹Ÿç§°ä¸ºè§£å¯†æŒ‡æ•°ï¼Œå½“dæ¯”è¾ƒå°çš„æ—¶å€™ï¼Œeä¹Ÿå°±æ˜¾å¾—ç‰¹åˆ«å¤§äº†ã€‚<br>é€‚ç”¨æƒ…å†µï¼šeè¿‡å¤§æˆ–è¿‡å°ï¼ˆä¸€èˆ¬eè¿‡å¤§æ—¶ä½¿ç”¨ï¼‰</p>
<p>ä½¿ç”¨å·¥å…·ï¼šå·¥å…·rsa-wiener-attack</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/Mr-Aur0ra/RSA/blob/master/PKCS1_OAEP%E6%A8%A1%E5%BC%8F%E7%9A%84RSA/%E5%9F%BA%E4%BA%8Ersa-wiener-attack%E8%A7%A3%E9%A2%98/%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF.md">ä½¿ç”¨å·¥å…·rsa-wiener-attackè§£å¯†</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/pablocelayes/rsa-wiener-attack">rsa-wiener-attackä¸‹è½½åœ°å€</a></p>
<p>åˆ©ç”¨è¿™ä¸ªå·¥å…·æ˜¯ä¸ºäº†å¾—åˆ°dï¼Œç„¶åå†ä½¿ç”¨RSAè§£å¯†è¿ç®— pow(c,d,n) å¾—åˆ°æœ€ç»ˆçš„å¯†æ–‡</p>
<p>RSAè§£å¯†è„šæœ¬ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.PublicKey import RSA</span><br><span class="line">import ContinuedFractions, Arithmetic</span><br><span class="line">from Crypto.Util.number import long_to_bytes</span><br><span class="line"></span><br><span class="line">def wiener_hack(e, n):</span><br><span class="line">    # firstly git clone https://github.com/pablocelayes/rsa-wiener-attack.git !</span><br><span class="line">    frac = ContinuedFractions.rational_to_contfrac(e, n)</span><br><span class="line">    convergents = ContinuedFractions.convergents_from_contfrac(frac)</span><br><span class="line">    for (k, d) in convergents:</span><br><span class="line">        if k != 0 and (e * d - 1) % k == 0:</span><br><span class="line">            phi = (e * d - 1) // k</span><br><span class="line">            s = n - phi + 1</span><br><span class="line">            discr = s * s - 4 * n</span><br><span class="line">            if (discr &gt;= 0):</span><br><span class="line">                t = Arithmetic.is_perfect_square(discr)</span><br><span class="line">                if t != -1 and (s + t) % 2 == 0:</span><br><span class="line">                    print("First: Hacked d.")</span><br><span class="line">                    return d</span><br><span class="line">    return False</span><br><span class="line">n = 0x649EE967E7916A825CC9FD3320BEABF263BEAC68C080F52824A0F521EDB6B78577EC52BF1C9E78F4BB71192F9A23F1A17AA76E5979E4D953329D3CA65FB4A71DA57412B59DFD6AEDF0191C5555D3E5F582B81B5E6B23163E9889204A81AFFDF119FE25C92F4ED59BD3285BCD7AAE14824240D2E33C5A97848F4EB7AAC203DE6330D2B4D8FF61691544FBECD120F99A157B3D2F58FA51B2887A9D06CA383C44D071314A12B17928B96F03A06E959A5AFEFA0183664F52CD32B9FC72A04B45913FCB2D5D2D3A415A14F611CF1EAC2D6C785142A8E9CC41B67A6CD85001B06EDB8CA767D367E56E0AE651491BF8A8C17A38A1835DB9E4A9292B1D86D5776C98CC25</span><br><span class="line">e = 0x647327833ACFEF1F9C83E74E171FC300FA347D4A6769476C33DA82C95120ACB38B62B33D429206FE6E9BB0BB7AB748A1036971BEA36EC47130B749C1C9FF6FE03D0F7D9FC5346EB0E575BDFA6C530AA57CD676894FC080D2DD049AB59625F4B9C78BCFD95CDCD2793E440E26E189D251121CB6EB177FEDB596409034E8B0C5BBD9BD9342235DBB226C9170EFE347FF0FD2CFF9A1F7B647CC83E4D8F005FD7125A89251C768AFE70BDD54B88116814D5030F499BCAC4673CCCC342FB4B6AC58EA5A64546DC25912B6C430529F6A7F449FD96536DE269D1A1B015A4AC6B6E46EE19DCE8143726A6503E290E4BAE6BD78319B5878981F6CFFDB3B818209341FD68B</span><br><span class="line">c = 10610336534759505889607399322387179316771488492347274741918862678692508953185876570981227584004676580623553664818853686933004290078153620168054665086468417541382824708104480882577200529822968531743002301934310349005341104696887943182074473298650903541494918266823037984054778903666406545980557074219162536057146090758158128189406073809226361445046225524917089434897957301396534515964547462425719205819342172669899546965221084098690893672595962129879041507903210851706793788311452973769358455761907303633956322972510500253009083922781934406731633755418753858930476576720874219359466503538931371444470303193503733920039</span><br><span class="line"></span><br><span class="line">d = wiener_hack(e, n)</span><br><span class="line">m = pow(c,d,n)</span><br><span class="line">print(long_to_bytes(m))</span><br><span class="line">b'flag{You_Need_Some_Tea}'</span><br></pre></td></tr></tbody></table></figure>

<p>æ‰€ä»¥æœ€åçš„flagæ˜¯  flag{You_Need_Some_Tea} </p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="mailto:undefined">Gruge</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="http://example.com/2022/05/04/DASCTF2022-FATE/">http://example.com/2022/05/04/DASCTF2022-FATE/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="http://example.com" target="_blank">Gruge's Blog</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/md5/">md5</a><a class="post-meta__tags" href="/tags/SHA1/">SHA1</a><a class="post-meta__tags" href="/tags/Wincrpt%E8%A7%A3%E5%AF%86AES/">Wincrptè§£å¯†AES</a><a class="post-meta__tags" href="/tags/APK%E5%8A%A0%E5%9B%BA/">APKåŠ å›º</a><a class="post-meta__tags" href="/tags/APK%E8%84%B1%E5%A3%B3-blackdex/">APKè„±å£³(blackdex)</a><a class="post-meta__tags" href="/tags/pyc%E6%96%87%E4%BB%B6%E8%A7%A3%E5%8C%85-pyinstxtractor/">pycæ–‡ä»¶è§£åŒ…(pyinstxtractor)</a><a class="post-meta__tags" href="/tags/pyz%E6%96%87%E4%BB%B6%E8%A7%A3%E5%AF%86/">pyzæ–‡ä»¶è§£å¯†</a><a class="post-meta__tags" href="/tags/pyc%E6%96%87%E4%BB%B6%E5%8F%8D%E7%BC%96%E8%AF%91-pycdc%E5%B7%A5%E5%85%B7/">pycæ–‡ä»¶åç¼–è¯‘(pycdcå·¥å…·)</a><a class="post-meta__tags" href="/tags/RSA%E4%BD%8E%E8%A7%A3%E5%AF%86%E6%8C%87%E6%95%B0%E6%94%BB%E5%87%BB/">RSAä½è§£å¯†æŒ‡æ•°æ”»å‡»</a></div><div class="post_share"><div class="social-share" data-image="https://s3.bmp.ovh/imgs/2022/02/ca6f47126f533a59.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer=""></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2022/04/25/starCTF2022-Simple-NaCl/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s3.bmp.ovh/imgs/2022/02/ca6f47126f533a59.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">starCTF2022_Simple+NaCl</div></div></a></div></nav><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s3.bmp.ovh/imgs/2022/02/463b631c6a0f63ec.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"></div><div class="author-info__name">Gruge</div><div class="author-info__description"></div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">17</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">41</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">6</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#CrackMe"><span class="toc-number">1.</span> <span class="toc-text">CrackMe</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%BD%8D%E5%85%B3%E9%94%AE%E5%87%BD%E6%95%B0"><span class="toc-number">1.1.</span> <span class="toc-text">å®šä½å…³é”®å‡½æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E6%9E%90%E5%85%B3%E9%94%AE%E5%87%BD%E6%95%B0%E9%80%BB%E8%BE%91"><span class="toc-number">1.2.</span> <span class="toc-text">åˆ†æå…³é”®å‡½æ•°é€»è¾‘</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4%E4%B8%AA%E5%8A%A0%E5%AF%86%E5%87%BD%E6%95%B0"><span class="toc-number">1.2.1.</span> <span class="toc-text">4ä¸ªåŠ å¯†å‡½æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8F%90%E5%8F%96%E5%8A%A0%E5%AF%86%E7%BB%93%E6%9E%9C%E7%9A%84%E6%95%B0%E6%8D%AE%EF%BC%88OD%EF%BC%89"><span class="toc-number">1.2.2.</span> <span class="toc-text">æå–åŠ å¯†ç»“æœçš„æ•°æ®ï¼ˆODï¼‰</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#md5%E8%A7%A3%E5%AF%86"><span class="toc-number">1.3.</span> <span class="toc-text">md5è§£å¯†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SHA1%E8%A7%A3%E5%AF%86"><span class="toc-number">1.4.</span> <span class="toc-text">SHA1è§£å¯†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Wincrpt%E8%A7%A3%E5%AF%86AES"><span class="toc-number">1.5.</span> <span class="toc-text">Wincrptè§£å¯†AES</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Wincrpt"><span class="toc-number">1.5.1.</span> <span class="toc-text">Wincrpt</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CryptDecrypt%E7%9A%84%E8%AE%B2%E8%A7%A3"><span class="toc-number">1.5.2.</span> <span class="toc-text">CryptDecryptçš„è®²è§£</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CryptDecrypt%E7%9A%84%E8%AE%B2%E8%A7%A3-1"><span class="toc-number">1.5.3.</span> <span class="toc-text">CryptDecryptçš„è®²è§£</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E5%AF%86%E8%84%9A%E6%9C%AC"><span class="toc-number">1.5.4.</span> <span class="toc-text">è§£å¯†è„šæœ¬</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fakePica"><span class="toc-number">2.</span> <span class="toc-text">fakePica</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E6%9E%90APK%E5%8A%A0%E5%9B%BA%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">2.1.</span> <span class="toc-text">åˆ†æAPKåŠ å›ºçš„æ–¹æ³•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#blackdex-APK%E8%84%B1%E5%A3%B3"><span class="toc-number">2.2.</span> <span class="toc-text">blackdex-APKè„±å£³</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A4%E6%96%AD32%E4%BD%8D%E8%BF%98%E6%98%AF64%E4%BD%8D%E7%9A%84APK%E6%96%87%E4%BB%B6"><span class="toc-number">2.2.1.</span> <span class="toc-text">åˆ¤æ–­32ä½è¿˜æ˜¯64ä½çš„APKæ–‡ä»¶</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E6%9E%90%E8%84%B1%E5%A3%B3%E5%BE%97%E5%88%B0%E7%9A%84dex%E6%96%87%E4%BB%B6"><span class="toc-number">2.3.</span> <span class="toc-text">åˆ†æè„±å£³å¾—åˆ°çš„dexæ–‡ä»¶</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#AES%E8%A7%A3%E5%AF%86"><span class="toc-number">2.3.1.</span> <span class="toc-text">AESè§£å¯†</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A5%87%E6%80%AA%E7%9A%84%E4%BA%A4%E6%98%93"><span class="toc-number">3.</span> <span class="toc-text">å¥‡æ€ªçš„äº¤æ˜“</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#pyc%E6%96%87%E4%BB%B6%E4%BB%A5%E5%8F%8A%E5%85%B6%E4%B8%AD%E7%9A%84pyz%E6%96%87%E4%BB%B6%E8%A7%A3%E5%8C%85"><span class="toc-number">3.1.</span> <span class="toc-text">pycæ–‡ä»¶ä»¥åŠå…¶ä¸­çš„pyzæ–‡ä»¶è§£åŒ…</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pyz%E6%96%87%E4%BB%B6%E8%A7%A3%E5%AF%86"><span class="toc-number">3.2.</span> <span class="toc-text">pyzæ–‡ä»¶è§£å¯†</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#pyz%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E7%9A%84%E5%AF%86%E9%92%A5%E5%92%8C%E8%BF%87%E7%A8%8B%E7%9A%84%E6%96%87%E4%BB%B6"><span class="toc-number">3.2.1.</span> <span class="toc-text">pyzæ–‡ä»¶åŠ å¯†çš„å¯†é’¥å’Œè¿‡ç¨‹çš„æ–‡ä»¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#pyz%E6%96%87%E4%BB%B6%E8%A7%A3%E5%AF%86%E8%84%9A%E6%9C%AC"><span class="toc-number">3.2.2.</span> <span class="toc-text">pyzæ–‡ä»¶è§£å¯†è„šæœ¬</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#xxtea%E8%A7%A3%E5%AF%86"><span class="toc-number">3.3.</span> <span class="toc-text">xxteaè§£å¯†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA%E4%BD%8E%E8%A7%A3%E5%AF%86%E6%8C%87%E6%95%B0%E6%94%BB%E5%87%BB"><span class="toc-number">3.4.</span> <span class="toc-text">RSAä½è§£å¯†æŒ‡æ•°æ”»å‡»</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/05/04/DASCTF2022-FATE/" title="DASCTF2022-FATE"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s3.bmp.ovh/imgs/2022/02/ca6f47126f533a59.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="DASCTF2022-FATE"></a><div class="content"><a class="title" href="/2022/05/04/DASCTF2022-FATE/" title="DASCTF2022-FATE">DASCTF2022-FATE</a><time datetime="2022-05-04T09:44:12.000Z" title="å‘è¡¨äº 2022-05-04 17:44:12">2022-05-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/04/25/starCTF2022-Simple-NaCl/" title="starCTF2022_Simple+NaCl"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s3.bmp.ovh/imgs/2022/02/ca6f47126f533a59.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="starCTF2022_Simple+NaCl"></a><div class="content"><a class="title" href="/2022/04/25/starCTF2022-Simple-NaCl/" title="starCTF2022_Simple+NaCl">starCTF2022_Simple+NaCl</a><time datetime="2022-04-25T12:10:56.000Z" title="å‘è¡¨äº 2022-04-25 20:10:56">2022-04-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/04/21/DASCTF-Login/" title="DASCTF_Login"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s3.bmp.ovh/imgs/2022/02/ca6f47126f533a59.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="DASCTF_Login"></a><div class="content"><a class="title" href="/2022/04/21/DASCTF-Login/" title="DASCTF_Login">DASCTF_Login</a><time datetime="2022-04-21T06:04:38.000Z" title="å‘è¡¨äº 2022-04-21 14:04:38">2022-04-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/04/15/HFCTF2022-theShellcode/" title="HFCTF2022_theShellcode"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s3.bmp.ovh/imgs/2022/02/ca6f47126f533a59.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="HFCTF2022_theShellcode"></a><div class="content"><a class="title" href="/2022/04/15/HFCTF2022-theShellcode/" title="HFCTF2022_theShellcode">HFCTF2022_theShellcode</a><time datetime="2022-04-15T14:35:25.000Z" title="å‘è¡¨äº 2022-04-15 22:35:25">2022-04-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/04/13/starCTF/" title="starCTF2021"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s3.bmp.ovh/imgs/2022/02/ca6f47126f533a59.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="starCTF2021"></a><div class="content"><a class="title" href="/2022/04/13/starCTF/" title="starCTF2021">starCTF2021</a><time datetime="2022-04-13T01:20:26.000Z" title="å‘è¡¨äº 2022-04-13 09:20:26">2022-04-13</time></div></div></div></div></div></div></main><footer id="footer" style="background: transparent"><div id="footer-wrap"><div class="copyright">Â©2022 By Gruge</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœ¬åœ°æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  æ•°æ®åº“åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"></div></div><hr><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: '1aa3bac2fd8cfac9d7c3',
      clientSecret: '7640d6d45e9030f665c75a640991b67e8367e67d',
      repo: 'G2uge.github.io',
      owner: 'G2uge',
      admin: ['G2uge'],
      id: 'c5e146010de482c3faf7f26c0b237fb6',
      updateCountCallback: commentCount
    },null))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    getScript('https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Gitalk' === 'Gitalk' || !false) {
  if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zindex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-heart.min.js" async="async" mobile="false"></script><script async="" data-pjax="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>