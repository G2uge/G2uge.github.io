<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>DASCTF_Login | Gruge's Blog</title><meta name="keywords" content="RSA,hill解密,AES解密"><meta name="author" content="Gruge"><meta name="copyright" content="Gruge"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Login这道题里面给了两个文件，一个作为了客户端，一个作为服务器，两个程序之间相互传输数据，对登录的token、password以及verify这三个数进行了验证。 验证的主逻辑是在check程序之中，这里有三中加密（RSA、Hill、AES），这次的AES进行了魔改，解密的脚本不得不自己来码代码！！ 两个程序的交互提供了两个文件，一个文佳时客户端界面，一个时服务器界面，要实现两个页面的交互 打">
<meta property="og:type" content="article">
<meta property="og:title" content="DASCTF_Login">
<meta property="og:url" content="http://example.com/2022/04/21/DASCTF-Login/index.html">
<meta property="og:site_name" content="Gruge's Blog">
<meta property="og:description" content="Login这道题里面给了两个文件，一个作为了客户端，一个作为服务器，两个程序之间相互传输数据，对登录的token、password以及verify这三个数进行了验证。 验证的主逻辑是在check程序之中，这里有三中加密（RSA、Hill、AES），这次的AES进行了魔改，解密的脚本不得不自己来码代码！！ 两个程序的交互提供了两个文件，一个文佳时客户端界面，一个时服务器界面，要实现两个页面的交互 打">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s3.bmp.ovh/imgs/2022/02/ca6f47126f533a59.jpg">
<meta property="article:published_time" content="2022-04-21T06:04:38.000Z">
<meta property="article:modified_time" content="2022-04-21T06:15:01.189Z">
<meta property="article:author" content="Gruge">
<meta property="article:tag" content="RSA">
<meta property="article:tag" content="hill解密">
<meta property="article:tag" content="AES解密">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s3.bmp.ovh/imgs/2022/02/ca6f47126f533a59.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2022/04/21/DASCTF-Login/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"top-right"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'DASCTF_Login',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-04-21 14:15:01'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/modify.css"><meta name="generator" content="Hexo 5.4.1"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s3.bmp.ovh/imgs/2022/02/463b631c6a0f63ec.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">15</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">28</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-coffee"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://s3.bmp.ovh/imgs/2022/02/ca6f47126f533a59.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Gruge's Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-coffee"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">DASCTF_Login</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-04-21T06:04:38.000Z" title="发表于 2022-04-21 14:04:38">2022-04-21</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-04-21T06:15:01.189Z" title="更新于 2022-04-21 14:15:01">2022-04-21</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%A4%8D%E7%8E%B0/">复现</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="DASCTF_Login"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><div class="top-img" style="background-image: url('https://s3.bmp.ovh/imgs/2022/02/ca6f47126f533a59.jpg');"></div><article class="post-content" id="article-container"><h2 id="Login"><a href="#Login" class="headerlink" title="Login"></a>Login</h2><p>这道题里面给了两个文件，一个作为了客户端，一个作为服务器，两个程序之间相互传输数据，对登录的token、password以及verify这三个数进行了验证。</p>
<p>验证的主逻辑是在check程序之中，这里有三中加密（RSA、Hill、AES），这次的AES进行了魔改，解密的脚本不得不自己来码代码！！</p>
<h3 id="两个程序的交互"><a href="#两个程序的交互" class="headerlink" title="两个程序的交互"></a>两个程序的交互</h3><p>提供了两个文件，一个文佳时客户端界面，一个时服务器界面，要实现两个页面的交互</p>
<p>打开的是两个程序，一个程序作为的是客户端（login），一个作为的是服务器（check）</p>
<p>在这两个程序之中找到start函数，然后打开第一个参数，就是main函数</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF-Login/image-20220418182800620.png" alt="image-20220418182800620"></p>
<p>login程序：</p>
<ul>
<li>和服务器进行一系列的交互</li>
<li>一个while循环向服务器发送和接受消息</li>
<li>其中的if语句会根据接受到的参数，来做出特定的反应</li>
</ul>
<p>连接服务器：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF-Login/image-20220418185651992.png" alt="image-20220418185651992"></p>
<p>客户端和服务器间的交互：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF-Login/image-20220418190656569.png" alt="image-20220418190656569"></p>
<p>if语句发送数据：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF-Login/image-20220418184030804.png" alt="image-20220418184030804"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF-Login/image-20220418184014037.png" alt="image-20220418184014037"></p>
<p>客户端：</p>
<p>连接客户端：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF-Login/image-20220418185943841.png" alt="image-20220418185943841"></p>
<p>进入main函数之中，和客户端进行交互，验证三个数据</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF-Login/image-20220418232408361.png" alt="image-20220418232408361"></p>
<h3 id="rsa解密"><a href="#rsa解密" class="headerlink" title="rsa解密"></a>rsa解密</h3><p>大素数：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">13123058934861171416713230498081453101147538789122070079961388806126697916963123413431108069961369055630747412550900239402710827847917960870358653962948282381351741121884528399369764530446509936240262290248305226552117100584726616255292963971141510518678552679033220315246377746270515853987903184512948801397452104554589803725619076066339968999308910127885089547678968793196148780382182445270838659078189316664538631875879022325427220682805580410213245364855569367702919157881367085677283124732874621569379901272662162025780608669577546548333274766058755786449491277002349918598971841605936268030140638579388226573929</span><br></pre></td></tr></tbody></table></figure>

<p>分解的质数：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">p = 98197216341757567488149177586991336976901080454854408243068885480633972200382596026756300968618883148721598031574296054706280190113587145906781375704611841087782526897314537785060868780928063942914187241017272444601926795083433477673935377466676026146695321415853502288291409333200661670651818749836420808033</span><br><span class="line">q = 133639826298015917901017908376475546339925646165363264658181838203059432536492968144231040597990919971381628901127402671873954769629458944972912180415794436700950304720548263026421362847590283353425105178540468631051824814390421486132775876582962969734956410033443729557703719598998956317920674659744121941513</span><br><span class="line">e = 0x10001</span><br></pre></td></tr></tbody></table></figure>

<p>密文：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c = 0x2e7469206873696c6f70206577206e6f697461737265766e6f63207962202c646e696d2065687420686369726e6520657720676e6964616572207942</span><br></pre></td></tr></tbody></table></figure>

<p>解密脚本：</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Decrypt</span>(<span class="params">c,e,p,q</span>):</span><br><span class="line">    L = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">    d = gmpy2.invert(e,L)</span><br><span class="line">    n = p * q</span><br><span class="line">    m = gmpy2.powmod(c, d, n)</span><br><span class="line">    flag = <span class="built_in">str</span>(m)</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line">p = <span class="number">98197216341757567488149177586991336976901080454854408243068885480633972200382596026756300968618883148721598031574296054706280190113587145906781375704611841087782526897314537785060868780928063942914187241017272444601926795083433477673935377466676026146695321415853502288291409333200661670651818749836420808033</span></span><br><span class="line">q = <span class="number">133639826298015917901017908376475546339925646165363264658181838203059432536492968144231040597990919971381628901127402671873954769629458944972912180415794436700950304720548263026421362847590283353425105178540468631051824814390421486132775876582962969734956410033443729557703719598998956317920674659744121941513</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">c = <span class="number">0x2e7469206873696c6f70206577206e6f697461737265766e6f63207962202c646e696d2065687420686369726e6520657720676e6964616572207942</span></span><br><span class="line">Decrypt(c,e,p,q)</span><br></pre></td></tr></tbody></table></figure>

<p>明文：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">token = 11963777321199993924175387978397443935563034091716786597947508874393819454915798980986262132792605021295930274531653741552766395859285325677395421549163602968276475448835066393456449574469736327622969755801884982386140722904578598391534204834007447860153096480268812700725451958035204357033892179559153729604237187552716580637492579876006993181920209114166153317182827927606249871955662032809256743464460825303610341043145126848787575238499023185150429072724679210155061579052743238859739734301162335989939278904459012917375108407803445722785027315562371588439877746983153339473213449448259686486917983129418859935686</span><br></pre></td></tr></tbody></table></figure>

<h3 id="hill解密"><a href="#hill解密" class="headerlink" title="hill解密"></a>hill解密</h3><p>密钥矩阵：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">0xA34C0F7A2E25DB71,0x7AA91B6E29AA226A,0x56AA0EF0802F278A,0x9AF6F2A9005859F7,0xC9481C4E</span><br><span class="line">形成6*6的矩阵 (GF(257))</span><br><span class="line">0x71,0xdb,0x25,0x2e,0x7a,0x0f</span><br><span class="line">0x4c,0xa3,0x6a,0x22,0xaa,0x29</span><br><span class="line">0x6e,0x1b,0xa9,0x7a,0x8a,0x27</span><br><span class="line">0x2f,0x80,0xf0,0x0e,0xaa,0x56</span><br><span class="line">0xf7,0x59,0x58,0x00,0xa9,0xf2</span><br><span class="line">0xf6,0x9a,0x4e,0x1c,0x48,0xc9</span><br><span class="line">[[0x71,0xdb,0x25,0x2e,0x7a,0x0f],[0x4c,0xa3,0x6a,0x22,0xaa,0x29],[0x6e,0x1b,0xa9,0x7a,0x8a,0x27],[0x2f,0x80,0xf0,0x0e,0xaa,0x56],[0xf7,0x59,0x58,0x00,0xa9,0xf2],[0xf6,0x9a,0x4e,0x1c,0x48,0xc9]]</span><br></pre></td></tr></tbody></table></figure>

<p>密文随机数（GF(255)）:</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1804289383,846930886,1681692777,1714636915,1957747793,424238335,719885386,1649760492,596516649,1189641421,1025202362,1350490027,783368690,1102520059,2044897763,1967513926,1365180540,1540383426,304089172,1303455736,35005211,521595368,294702567,1726956429,336465782,861021530,278722862,233665123,2145174067,468703135,1101513929,1801979802,1315634022,635723058,1369133069,1125898167,1059961393,2089018456,628175011,1656478042,1131176229,1653377373,859484421,1914544919,608413784,756898537,1734575198,1973594324,149798315,2038664370,1129566413,184803526,412776091,1424268980,1911759956,749241873,137806862,42999170,982906996,135497281,511702305,2084420925,1937477084,1827336327,572660336,1159126505,805750846,1632621729,1100661313,1433925857,1141616124,84353895,939819582,2001100545,1998898814,1548233367,610515434,1585990364,1374344043,760313750,1477171087,356426808,945117276,1889947178,1780695788,709393584,491705403,1918502651,752392754,1474612399,2053999932,1264095060,1411549676,1843993368,943947739,1984210012,855636226,1749698586,1469348094,1956297539</span><br></pre></td></tr></tbody></table></figure>

<p>密文矩阵：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[0xa3,0x97,0xa2,0x55,0x53,0xbe],[0xf1,0xfc,0xf9,0x79,0x6b,0x52],[0x14,0x13,0xe9,0xe2,0x2d,0x51],[0x8e,0x1f,0x56,0x08,0x57,0x27],[0xa7,0x05,0xd4,0xd0,0x52,0x82],[0x77,0x75,0x1b,0x99,0x4a,0xed]]</span><br></pre></td></tr></tbody></table></figure>

<p>使用sage解矩阵的乘法运算</p>
<p>问题：这个函数的作用为什么是将输入的password（明文）转换成array形式</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF-Login/image-20220419214617366.png" alt="image-20220419214617366"></p>
<p>计算得到数据：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[ 81  50 210   2 195  45]</span><br><span class="line">[149 185 249 120 213  20]</span><br><span class="line">[227  41  66  32  81  59]</span><br><span class="line">[ 21  98  52 130 180 192]</span><br><span class="line">[ 46 154 253 232 186 213]</span><br><span class="line">[236   7  72 106  84 136]</span><br><span class="line">所以password是：5132d202c32d95b9f978d514e3294220513b15623482b4c02e9afde8bad5ec07486a5488</span><br></pre></td></tr></tbody></table></figure>

<p>将上面的token和login的数据输入之后登录成功：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF-Login/image-20220419225219658.png" alt="image-20220419225219658"></p>
<h3 id="运行调试两个程序"><a href="#运行调试两个程序" class="headerlink" title="运行调试两个程序"></a>运行调试两个程序</h3><p>如果需要动调：</p>
<p>ida之中动调的对象是服务器端口：</p>
<p>在Linux之中 使用./linux_server64 -p 1234 监听1234端口</p>
<p>在ida之中设置的端口号也应该是1234</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF-Login/image-20220419225918050.png" alt="image-20220419225918050"></p>
<p>在Linux之中运行一下这两个程序</p>
<p>先将服务端运行起来 ./check</p>
<p>然后将客户端运行起来 ./login 127.0.0.1     // 因为服务端是在本地运行的，所以ip address 就是127.0.0.1</p>
<p>客户端需要输入ip address</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF-Login/image-20220419224934834.png" alt="image-20220419224934834"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF-Login/image-20220419225000482.png" alt="image-20220419225000482"></p>
<h3 id="AES解密"><a href="#AES解密" class="headerlink" title="AES解密"></a>AES解密</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_28205153/article/details/55798628?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522164903726916781685316114%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=164903726916781685316114&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-55798628.142%5Ev5%5Earticle_score_rank,157%5Ev4%5Econtrol&amp;utm_term=AES&amp;spm=1018.2226.3001.4187">常规AES加密解密</a></p>
<p>魔改的部分：</p>
<ul>
<li>S盒子和逆S盒交换着使用了</li>
<li>密钥扩展中异或的部分魔改了</li>
<li>在进入加密器之前进行了和IV向量的异或运算</li>
</ul>
<p>这里面数据提取和处理的方法也要注意</p>
<h4 id="S盒"><a href="#S盒" class="headerlink" title="S盒"></a>S盒</h4><p>S盒的生成：S盒的大小规格是16*16 = 256的</p>
<p>客户端接受到的数据是:</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">52096ad53036a538bf40a39e81f3d7fb7ce339829b2fff87348e4344c4dee9cb547b9432a6c2233dee4c950b42fac34e082ea16628d924b2765ba2496d8bd12572f8f66486689816d4a45ccc5d65b6926c704850fdedb9da5e154657a78d9d8490d8ab008cbcd30af7e45805b8b34506d02c1e8fca3f0f02c1afbd0301138a6b3a9111414f67dcea97f2cfcef0b4e67396ac7422e7ad3585e2f937e81c75df6e47f11a711d29c5896fb7620eaa18be1bfc563e4bc6d279209adbc0fe78cd5af41fdda8338807c731b11210592780ec5f60517fa919b54a0d2de57a9f93c99cefa0e03b4dae2af5b0c8ebbb3c83539961172b047eba77d626e169146355210c7d</span><br></pre></td></tr></tbody></table></figure>

<p>利用接受到的数据生成S盒</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x52,0x09,0x6a,0xd5,0x30,0x36,0xa5,0x38,0xbf,0x40,0xa3,0x9e,0x81,0xf3,0xd7,0xfb,0x7c,0xe3,0x39,0x82,0x9b,0x2f,0xff,0x87,0x34,0x8e,0x43,0x44,0xc4,0xde,0xe9,0xcb,0x54,0x7b,0x94,0x32,0xa6,0xc2,0x23,0x3d,0xee,0x4c,0x95,0x0b,0x42,0xfa,0xc3,0x4e,0x08,0x2e,0xa1,0x66,0x28,0xd9,0x24,0xb2,0x76,0x5b,0xa2,0x49,0x6d,0x8b,0xd1,0x25,0x72,0xf8,0xf6,0x64,0x86,0x68,0x98,0x16,0xd4,0xa4,0x5c,0xcc,0x5d,0x65,0xb6,0x92,0x6c,0x70,0x48,0x50,0xfd,0xed,0xb9,0xda,0x5e,0x15,0x46,0x57,0xa7,0x8d,0x9d,0x84,0x90,0xd8,0xab,0x00,0x8c,0xbc,0xd3,0x0a,0xf7,0xe4,0x58,0x05,0xb8,0xb3,0x45,0x06,0xd0,0x2c,0x1e,0x8f,0xca,0x3f,0x0f,0x02,0xc1,0xaf,0xbd,0x03,0x01,0x13,0x8a,0x6b,0x3a,0x91,0x11,0x41,0x4f,0x67,0xdc,0xea,0x97,0xf2,0xcf,0xce,0xf0,0xb4,0xe6,0x73,0x96,0xac,0x74,0x22,0xe7,0xad,0x35,0x85,0xe2,0xf9,0x37,0xe8,0x1c,0x75,0xdf,0x6e,0x47,0xf1,0x1a,0x71,0x1d,0x29,0xc5,0x89,0x6f,0xb7,0x62,0x0e,0xaa,0x18,0xbe,0x1b,0xfc,0x56,0x3e,0x4b,0xc6,0xd2,0x79,0x20,0x9a,0xdb,0xc0,0xfe,0x78,0xcd,0x5a,0xf4,0x1f,0xdd,0xa8,0x33,0x88,0x07,0xc7,0x31,0xb1,0x12,0x10,0x59,0x27,0x80,0xec,0x5f,0x60,0x51,0x7f,0xa9,0x19,0xb5,0x4a,0x0d,0x2d,0xe5,0x7a,0x9f,0x93,0xc9,0x9c,0xef,0xa0,0xe0,0x3b,0x4d,0xae,0x2a,0xf5,0xb0,0xc8,0xeb,0xbb,0x3c,0x83,0x53,0x99,0x61,0x17,0x2b,0x04,0x7e,0xba,0x77,0xd6,0x26,0xe1,0x69,0x14,0x63,0x55,0x21,0x0c,0x7d</span><br></pre></td></tr></tbody></table></figure>

<h4 id="pass-token的获取"><a href="#pass-token的获取" class="headerlink" title="pass_token的获取"></a>pass_token的获取</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF-Login/image-20220420162301465.png" alt="image-20220420162301465"></p>
<p>token的数组数据：（按照char的类型来取值）</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">token = "11963777321199993924175387978397443935563034091716786597947508874393819454915798980986262132792605021295930274531653741552766395859285325677395421549163602968276475448835066393456449574469736327622969755801884982386140722904578598391534204834007447860153096480268812700725451958035204357033892179559153729604237187552716580637492579876006993181920209114166153317182827927606249871955662032809256743464460825303610341043145126848787575238499023185150429072724679210155061579052743238859739734301162335989939278904459012917375108407803445722785027315562371588439877746983153339473213449448259686486917983129418859935686"</span><br></pre></td></tr></tbody></table></figure>

<p>pass的数组数据：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x51,0x32,0xd2,0x02,0xc3,0x2d,0x95,0xb9,0xf9,0x78,0xd5,0x14,0xe3,0x29,0x42,0x20,0x51,0x3b,0x15,0x62,0x34,0x82,0xb4,0xc0,0x2e,0x9a,0xfd,0xe8,0xba,0xd5,0xec,0x07,0x48,0x6a,0x54,0x88</span><br></pre></td></tr></tbody></table></figure>

<p>随机数：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1804289383,846930886,1681692777,1714636915,1957747793,424238335,719885386,1649760492,596516649,1189641421,1025202362,1350490027,783368690,1102520059,2044897763,1967513926,1365180540,1540383426,304089172,1303455736,35005211,521595368,294702567,1726956429,336465782,861021530,278722862,233665123,2145174067,468703135,1101513929,1801979802,1315634022,635723058,1369133069,1125898167,1059961393,2089018456,628175011,1656478042,1131176229,1653377373,859484421,1914544919,608413784,756898537,1734575198,1973594324,149798315,2038664370,1129566413,184803526,412776091,1424268980,1911759956,749241873,137806862,42999170,982906996,135497281,511702305,2084420925,1937477084,1827336327,572660336,1159126505,805750846,1632621729,1100661313,1433925857,1141616124,84353895,939819582,2001100545,1998898814,1548233367,610515434,1585990364,1374344043,760313750,1477171087,356426808,945117276,1889947178,1780695788,709393584,491705403,1918502651,752392754,1474612399,2053999932,1264095060,1411549676,1843993368,943947739,1984210012,855636226,1749698586,1469348094,1956297539</span><br></pre></td></tr></tbody></table></figure>

<p>生成pass_token:（IV和密钥）这里的随机数使用的是第36个随机数之后的数，因为在程序的前面生成过一次36个随机数。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">token = <span class="string">"11963777321199993924175387978397443935563034091716786597947508874393819454915798980986262132792605021295930274531653741552766395859285325677395421549163602968276475448835066393456449574469736327622969755801884982386140722904578598391534204834007447860153096480268812700725451958035204357033892179559153729604237187552716580637492579876006993181920209114166153317182827927606249871955662032809256743464460825303610341043145126848787575238499023185150429072724679210155061579052743238859739734301162335989939278904459012917375108407803445722785027315562371588439877746983153339473213449448259686486917983129418859935686"</span></span><br><span class="line">password = [<span class="number">0x51</span>,<span class="number">0x32</span>,<span class="number">0xd2</span>,<span class="number">0x02</span>,<span class="number">0xc3</span>,<span class="number">0x2d</span>,<span class="number">0x95</span>,<span class="number">0xb9</span>,<span class="number">0xf9</span>,<span class="number">0x78</span>,<span class="number">0xd5</span>,<span class="number">0x14</span>,<span class="number">0xe3</span>,<span class="number">0x29</span>,<span class="number">0x42</span>,<span class="number">0x20</span>,<span class="number">0x51</span>,<span class="number">0x3b</span>,<span class="number">0x15</span>,<span class="number">0x62</span>,<span class="number">0x34</span>,<span class="number">0x82</span>,<span class="number">0xb4</span>,<span class="number">0xc0</span>,<span class="number">0x2e</span>,<span class="number">0x9a</span>,<span class="number">0xfd</span>,<span class="number">0xe8</span>,<span class="number">0xba</span>,<span class="number">0xd5</span>,<span class="number">0xec</span>,<span class="number">0x07</span>,<span class="number">0x48</span>,<span class="number">0x6a</span>,<span class="number">0x54</span>,<span class="number">0x88</span>]</span><br><span class="line">random = [<span class="number">1804289383</span>,<span class="number">846930886</span>,<span class="number">1681692777</span>,<span class="number">1714636915</span>,<span class="number">1957747793</span>,<span class="number">424238335</span>,<span class="number">719885386</span>,<span class="number">1649760492</span>,<span class="number">596516649</span>,<span class="number">1189641421</span>,<span class="number">1025202362</span>,<span class="number">1350490027</span>,<span class="number">783368690</span>,<span class="number">1102520059</span>,<span class="number">2044897763</span>,<span class="number">1967513926</span>,<span class="number">1365180540</span>,<span class="number">1540383426</span>,<span class="number">304089172</span>,<span class="number">1303455736</span>,<span class="number">35005211</span>,<span class="number">521595368</span>,<span class="number">294702567</span>,<span class="number">1726956429</span>,<span class="number">336465782</span>,<span class="number">861021530</span>,<span class="number">278722862</span>,<span class="number">233665123</span>,<span class="number">2145174067</span>,<span class="number">468703135</span>,<span class="number">1101513929</span>,<span class="number">1801979802</span>,<span class="number">1315634022</span>,<span class="number">635723058</span>,<span class="number">1369133069</span>,<span class="number">1125898167</span>,<span class="number">1059961393</span>,<span class="number">2089018456</span>,<span class="number">628175011</span>,<span class="number">1656478042</span>,<span class="number">1131176229</span>,<span class="number">1653377373</span>,<span class="number">859484421</span>,<span class="number">1914544919</span>,<span class="number">608413784</span>,<span class="number">756898537</span>,<span class="number">1734575198</span>,<span class="number">1973594324</span>,<span class="number">149798315</span>,<span class="number">2038664370</span>,<span class="number">1129566413</span>,<span class="number">184803526</span>,<span class="number">412776091</span>,<span class="number">1424268980</span>,<span class="number">1911759956</span>,<span class="number">749241873</span>,<span class="number">137806862</span>,<span class="number">42999170</span>,<span class="number">982906996</span>,<span class="number">135497281</span>,<span class="number">511702305</span>,<span class="number">2084420925</span>,<span class="number">1937477084</span>,<span class="number">1827336327</span>,<span class="number">572660336</span>,<span class="number">1159126505</span>,<span class="number">805750846</span>,<span class="number">1632621729</span>,<span class="number">1100661313</span>,<span class="number">1433925857</span>,<span class="number">1141616124</span>,<span class="number">84353895</span>,<span class="number">939819582</span>,<span class="number">2001100545</span>,<span class="number">1998898814</span>,<span class="number">1548233367</span>,<span class="number">610515434</span>,<span class="number">1585990364</span>,<span class="number">1374344043</span>,<span class="number">760313750</span>,<span class="number">1477171087</span>,<span class="number">356426808</span>,<span class="number">945117276</span>,<span class="number">1889947178</span>,<span class="number">1780695788</span>,<span class="number">709393584</span>,<span class="number">491705403</span>,<span class="number">1918502651</span>,<span class="number">752392754</span>,<span class="number">1474612399</span>,<span class="number">2053999932</span>,<span class="number">1264095060</span>,<span class="number">1411549676</span>,<span class="number">1843993368</span>,<span class="number">943947739</span>,<span class="number">1984210012</span>,<span class="number">855636226</span>,<span class="number">1749698586</span>,<span class="number">1469348094</span>,<span class="number">1956297539</span>]</span><br><span class="line">token_pass=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>):</span><br><span class="line">    <span class="keyword">if</span> i&amp;<span class="number">1</span> != <span class="number">0</span>:</span><br><span class="line">        token_pass.append(<span class="built_in">ord</span>(token[random[i+<span class="number">36</span>]%<span class="built_in">len</span>(token)]))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        token_pass.append(password[random[i+<span class="number">36</span>]%<span class="built_in">len</span>(password)])</span><br><span class="line"><span class="built_in">print</span>(token_pass)</span><br><span class="line">token_pass = [<span class="number">50</span>, <span class="number">48</span>, <span class="number">7</span>, <span class="number">54</span>, <span class="number">106</span>, <span class="number">55</span>, <span class="number">120</span>, <span class="number">49</span>, <span class="number">72</span>, <span class="number">57</span>, <span class="number">66</span>, <span class="number">57</span>, <span class="number">20</span>, <span class="number">49</span>, <span class="number">213</span>, <span class="number">50</span>, <span class="number">98</span>, <span class="number">54</span>, <span class="number">249</span>, <span class="number">56</span>, <span class="number">66</span>, <span class="number">48</span>, <span class="number">195</span>, <span class="number">49</span>, <span class="number">106</span>, <span class="number">53</span>, <span class="number">72</span>, <span class="number">56</span>, <span class="number">52</span>, <span class="number">53</span>, <span class="number">84</span>, <span class="number">52</span>, <span class="number">41</span>, <span class="number">52</span>, <span class="number">81</span>, <span class="number">54</span>, <span class="number">21</span>, <span class="number">57</span>, <span class="number">210</span>, <span class="number">56</span>, <span class="number">210</span>, <span class="number">57</span>, <span class="number">32</span>, <span class="number">49</span>, <span class="number">185</span>, <span class="number">50</span>, <span class="number">46</span>, <span class="number">48</span>]</span><br></pre></td></tr></tbody></table></figure>

<h4 id="密钥扩展和逆S盒"><a href="#密钥扩展和逆S盒" class="headerlink" title="密钥扩展和逆S盒"></a>密钥扩展和逆S盒</h4><p>这里和常规的AES的密钥扩展是进行了魔改的(对比常规的AES加密的代码就能知道，密钥扩展这部分的代码需要自己写)</p>
<p>生成SBox的逆矩阵：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF-Login/image-20220420163223716.png" alt="image-20220420163223716"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF-Login/image-20220421131943315.png" alt="image-20220421131943315"></p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">revSBox = [</span><br><span class="line">0x63,0x7c,0x77,0x7b,0xf2,0x6b,0x6f,0xc5,0x30,0x01,0x67,0x2b,0xfe,0xd7,0xab,0x76,</span><br><span class="line">0xca,0x82,0xc9,0x7d,0xfa,0x59,0x47,0xf0,0xad,0xd4,0xa2,0xaf,0x9c,0xa4,0x72,0xc0,</span><br><span class="line">0xb7,0xfd,0x93,0x26,0x36,0x3f,0xf7,0xcc,0x34,0xa5,0xe5,0xf1,0x71,0xd8,0x31,0x15,</span><br><span class="line">0x04,0xc7,0x23,0xc3,0x18,0x96,0x05,0x9a,0x07,0x12,0x80,0xe2,0xeb,0x27,0xb2,0x75,</span><br><span class="line">0x09,0x83,0x2c,0x1a,0x1b,0x6e,0x5a,0xa0,0x52,0x3b,0xd6,0xb3,0x29,0xe3,0x2f,0x84,</span><br><span class="line">0x53,0xd1,0x00,0xed,0x20,0xfc,0xb1,0x5b,0x6a,0xcb,0xbe,0x39,0x4a,0x4c,0x58,0xcf,</span><br><span class="line">0xd0,0xef,0xaa,0xfb,0x43,0x4d,0x33,0x85,0x45,0xf9,0x02,0x7f,0x50,0x3c,0x9f,0xa8,</span><br><span class="line">0x51,0xa3,0x40,0x8f,0x92,0x9d,0x38,0xf5,0xbc,0xb6,0xda,0x21,0x10,0xff,0xf3,0xd2,</span><br><span class="line">0xcd,0x0c,0x13,0xec,0x5f,0x97,0x44,0x17,0xc4,0xa7,0x7e,0x3d,0x64,0x5d,0x19,0x73,</span><br><span class="line">0x60,0x81,0x4f,0xdc,0x22,0x2a,0x90,0x88,0x46,0xee,0xb8,0x14,0xde,0x5e,0x0b,0xdb,</span><br><span class="line">0xe0,0x32,0x3a,0x0a,0x49,0x06,0x24,0x5c,0xc2,0xd3,0xac,0x62,0x91,0x95,0xe4,0x79,</span><br><span class="line">0xe7,0xc8,0x37,0x6d,0x8d,0xd5,0x4e,0xa9,0x6c,0x56,0xf4,0xea,0x65,0x7a,0xae,0x08,</span><br><span class="line">0xba,0x78,0x25,0x2e,0x1c,0xa6,0xb4,0xc6,0xe8,0xdd,0x74,0x1f,0x4b,0xbd,0x8b,0x8a,</span><br><span class="line">0x70,0x3e,0xb5,0x66,0x48,0x03,0xf6,0x0e,0x61,0x35,0x57,0xb9,0x86,0xc1,0x1d,0x9e,</span><br><span class="line">0xe1,0xf8,0x98,0x11,0x69,0xd9,0x8e,0x94,0x9b,0x1e,0x87,0xe9,0xce,0x55,0x28,0xdf,</span><br><span class="line">0x8c,0xa1,0x89,0x0d,0xbf,0xe6,0x42,0x68,0x41,0x99,0x2d,0x0f,0xb0,0x54,0xbb,0x16,</span><br><span class="line">]</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 进行密钥扩展</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">expandKeyNums</span><span class="params">()</span></span><br><span class="line">{</span><br><span class="line">        <span class="comment">// 进行密钥扩展</span></span><br><span class="line">    <span class="type">uint8_t</span> v9 = <span class="number">0</span>;</span><br><span class="line">    <span class="type">uint8_t</span> v10 = <span class="number">0</span>;</span><br><span class="line">    <span class="type">uint8_t</span> v11 = <span class="number">0</span>;</span><br><span class="line">    <span class="type">uint8_t</span> v12 = <span class="number">0</span>;</span><br><span class="line">    <span class="type">uint8_t</span> i =<span class="number">0</span>;</span><br><span class="line">    <span class="type">uint8_t</span> j =<span class="number">0</span>;</span><br><span class="line">    <span class="comment">// 初始化前16个字节 4列中的元素</span></span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span> ;i&lt;<span class="number">4</span>;i++)</span><br><span class="line">    {</span><br><span class="line">        roundKey[i*<span class="number">4</span>] = pass_token[i*<span class="number">4</span>];</span><br><span class="line">        roundKey[i*<span class="number">4</span>+<span class="number">1</span>] = pass_token[i*<span class="number">4</span>+<span class="number">1</span>];</span><br><span class="line">        roundKey[i*<span class="number">4</span>+<span class="number">2</span>] = pass_token[i*<span class="number">4</span>+<span class="number">2</span>];</span><br><span class="line">        roundKey[i*<span class="number">4</span>+<span class="number">3</span>] = pass_token[i*<span class="number">4</span>+<span class="number">3</span>];</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">4</span>;i&lt;<span class="number">44</span>;i++)</span><br><span class="line">    {</span><br><span class="line">        v9 = roundKey[<span class="number">4</span>*(i<span class="number">-1</span>)];</span><br><span class="line">        v10 = roundKey[<span class="number">4</span>*(i<span class="number">-1</span>)+<span class="number">1</span>];</span><br><span class="line">        v11 = roundKey[<span class="number">4</span>*(i<span class="number">-1</span>)+<span class="number">2</span>];</span><br><span class="line">        v12 = roundKey[<span class="number">4</span>*(i<span class="number">-1</span>)+<span class="number">3</span>];</span><br><span class="line">        <span class="keyword">if</span> ((i&amp;<span class="number">3</span>) == <span class="number">0</span> )</span><br><span class="line">        {</span><br><span class="line">            v10 = revSBox[v11];</span><br><span class="line">            v11 = revSBox[v12];</span><br><span class="line">            v12 = revSBox[roundKey[<span class="number">4</span>*(i<span class="number">-1</span>)]];</span><br><span class="line">            v9 = revSBox[roundKey[<span class="number">4</span>*(i<span class="number">-1</span>)+<span class="number">1</span>]] ^ para[i&gt;&gt;<span class="number">2</span>];</span><br><span class="line">        }</span><br><span class="line">        roundKey[i*<span class="number">4</span>] = v9^roundKey[(i<span class="number">-4</span>)*<span class="number">4</span>];</span><br><span class="line">        roundKey[i*<span class="number">4</span>+<span class="number">1</span>] = v10^roundKey[(i<span class="number">-4</span>)*<span class="number">4</span>+<span class="number">1</span>];</span><br><span class="line">        roundKey[i*<span class="number">4</span>+<span class="number">2</span>] = v11^roundKey[(i<span class="number">-4</span>)*<span class="number">4</span>+<span class="number">2</span>];</span><br><span class="line">        roundKey[i*<span class="number">4</span>+<span class="number">3</span>] = v12^roundKey[(i<span class="number">-4</span>)*<span class="number">4</span>+<span class="number">3</span>];</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="CBC模式的初始化向量的IV"><a href="#CBC模式的初始化向量的IV" class="headerlink" title="CBC模式的初始化向量的IV"></a>CBC模式的初始化向量的IV</h4><p>作为IV的pass_token的后16*2个字节，每次使用16个字节</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF-Login/image-20220421132904388.png" alt="image-20220421132904388"></p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF-Login/image-20220420224347131.png" alt="image-20220420224347131" style="zoom:50%;">

<p>密文：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c ={0xfe,0xf9,0xe7,0x3e,0xf6,0xa1,0x23,0xcc,0x57,0x61,0xc1,0x15,0x77,0xfb,0x9c,0xbb,0xca,0x2f,0xb1,0xe8,0x4f,0xd9,0x07,0xd8,0x0c,0x6b,0xea,0xcf,0xe8,0x42,0xa2,0xfa}</span><br></pre></td></tr></tbody></table></figure>



<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// 加密过程第一步的异或运算(但是里面的数据还需要思考一下) 传入的参数是数据加密的轮数</span><br><span class="line">void XorIV(uint8_t round)</span><br><span class="line">{</span><br><span class="line">        for(int i=0;i&lt;=15;i++)</span><br><span class="line">    {</span><br><span class="line">        verify[i]^=pass_token[16*round+16+i];</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="AES加密的主逻辑"><a href="#AES加密的主逻辑" class="headerlink" title="AES加密的主逻辑"></a>AES加密的主逻辑</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF-Login/image-20220421133028414.png" alt="image-20220421133028414"></p>
<h4 id="字节代换"><a href="#字节代换" class="headerlink" title="字节代换"></a>字节代换</h4><p>这里用的S盒是revDate（SBox）</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF-Login/image-20220420175507903.png" alt="image-20220420175507903"></p>
<p>逆字节代换（要用revSBox）</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// 逆字节代换()</span><br><span class="line">void reveSubBytes()</span><br><span class="line">{</span><br><span class="line">    for(int i=0; i&lt;16; i++)</span><br><span class="line">    {</span><br><span class="line">        verify[i] = revSBox[verify[i]];</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="行移位"><a href="#行移位" class="headerlink" title="行移位"></a>行移位</h4><p>行移位操作：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF-Login/image-20220420180004983.png" alt="image-20220420180004983"></p>
<p>行移位的逆运算：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 行移位的逆运算 第一行不移动 第二行循环右移1位</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">reveShiftRows</span><span class="params">()</span></span><br><span class="line">{</span><br><span class="line">    <span class="type">int</span> round = <span class="number">0</span>;</span><br><span class="line">    <span class="type">uint8_t</span> tem = <span class="number">0</span>;<span class="comment">//临时存放值</span></span><br><span class="line">    <span class="type">int</span> j =<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">4</span>;i++)</span><br><span class="line">    {</span><br><span class="line">        round = i;</span><br><span class="line">        <span class="keyword">while</span>(round)</span><br><span class="line">        {</span><br><span class="line">            tem = verify[i*<span class="number">4</span>+<span class="number">3</span>];</span><br><span class="line">            <span class="keyword">for</span>(j=<span class="number">3</span>;j&gt;<span class="number">0</span>;j--)</span><br><span class="line">            {</span><br><span class="line">                verify[i*<span class="number">4</span>+j] = verify[i*<span class="number">4</span>+j<span class="number">-1</span>];</span><br><span class="line">            }</span><br><span class="line">            verify[i*<span class="number">4</span>+j] = tem;</span><br><span class="line">            round--;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="列混合"><a href="#列混合" class="headerlink" title="列混合"></a>列混合</h4><p>列混合：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF-Login/image-20220420185629111.png" alt="image-20220420185629111"></p>
<p>用到的矩阵（4*4）</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0x02, 0x03, 0x01, 0x01, </span><br><span class="line">0x01, 0x02, 0x03, 0x01, </span><br><span class="line">0x01, 0x01, 0x02, 0x03, </span><br><span class="line">0x03, 0x01, 0x01, 0x02,</span><br></pre></td></tr></tbody></table></figure>

<p>GF之中的运算：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF-Login/image-20220420190421308.png" alt="image-20220420190421308"></p>
<p>逆列混合使用到的矩阵：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">   0xe, 0xb, 0xd, 0x9,</span><br><span class="line">0x9, 0xe, 0xb, 0xd,</span><br><span class="line">0xd, 0x9, 0xe, 0xb,</span><br><span class="line">0xb, 0xd, 0x9, 0xe </span><br></pre></td></tr></tbody></table></figure>

<p>逆列混合:</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 列混合</span></span><br><span class="line"><span class="comment">// 使用到的矩阵</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">uint8_t</span> deColCinfusion[<span class="number">16</span>] =</span><br><span class="line">{</span><br><span class="line">    <span class="number">0xe</span>, <span class="number">0xb</span>, <span class="number">0xd</span>, <span class="number">0x9</span>,</span><br><span class="line">	<span class="number">0x9</span>, <span class="number">0xe</span>, <span class="number">0xb</span>, <span class="number">0xd</span>,</span><br><span class="line">	<span class="number">0xd</span>, <span class="number">0x9</span>, <span class="number">0xe</span>, <span class="number">0xb</span>,</span><br><span class="line">	<span class="number">0xb</span>, <span class="number">0xd</span>, <span class="number">0x9</span>, <span class="number">0xe</span></span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="comment">// GF之中的运算</span></span><br><span class="line"><span class="type">static</span> <span class="type">uint8_t</span> <span class="title function_">GFMul2</span><span class="params">(<span class="type">uint8_t</span> s)</span></span><br><span class="line">{</span><br><span class="line">    <span class="type">uint8_t</span> result = s*<span class="number">2</span>;</span><br><span class="line">    <span class="type">int</span> tem = (s*<span class="number">2</span>)&amp;<span class="number">0x00000100</span>;</span><br><span class="line">    <span class="keyword">if</span>(tem != <span class="number">0</span>)</span><br><span class="line">    {</span><br><span class="line">        result = result&amp;<span class="number">0xff</span>;</span><br><span class="line">        result^= <span class="number">0x1b</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">uint8_t</span> <span class="title function_">GFMul3</span><span class="params">(<span class="type">uint8_t</span> s)</span></span><br><span class="line">{</span><br><span class="line">    <span class="keyword">return</span> GFMul2(s)^s;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">uint8_t</span> <span class="title function_">GFMul4</span><span class="params">(<span class="type">uint8_t</span> s)</span></span><br><span class="line">{</span><br><span class="line">    <span class="keyword">return</span> GFMul2(GFMul2(s));</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">uint8_t</span> <span class="title function_">GFMul8</span><span class="params">(<span class="type">uint8_t</span> s)</span></span><br><span class="line">{</span><br><span class="line">    <span class="keyword">return</span> GFMul2(GFMul4(s));</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">uint8_t</span> <span class="title function_">GFMul9</span><span class="params">(<span class="type">uint8_t</span> s)</span></span><br><span class="line">{</span><br><span class="line">    <span class="keyword">return</span> GFMul8(s)^s;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">uint8_t</span> <span class="title function_">GFMul11</span><span class="params">(<span class="type">uint8_t</span> s)</span></span><br><span class="line">{</span><br><span class="line">    <span class="keyword">return</span> GFMul9(s)^GFMul2(s);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">uint8_t</span> <span class="title function_">GFMul12</span><span class="params">(<span class="type">uint8_t</span> s)</span></span><br><span class="line">{</span><br><span class="line">    <span class="keyword">return</span> GFMul8(s)^GFMul4(s);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">uint8_t</span> <span class="title function_">GFMul13</span><span class="params">(<span class="type">uint8_t</span> s)</span></span><br><span class="line">{</span><br><span class="line">    <span class="keyword">return</span> GFMul12(s)^s;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">uint8_t</span> <span class="title function_">GFMul14</span><span class="params">(<span class="type">uint8_t</span> s)</span></span><br><span class="line">{</span><br><span class="line">    <span class="keyword">return</span> GFMul12(s)^GFMul2(s);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">uint8_t</span> <span class="title function_">GFMul</span><span class="params">(<span class="type">uint8_t</span> n,<span class="type">uint8_t</span> s)</span></span><br><span class="line">{</span><br><span class="line">    <span class="type">uint8_t</span> result = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (n==<span class="number">1</span>)</span><br><span class="line">        result = s;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n==<span class="number">2</span>)  <span class="comment">// 2</span></span><br><span class="line">        result = GFMul2(s);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n==<span class="number">3</span>)  <span class="comment">// 3</span></span><br><span class="line">        result = GFMul3(s);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n==<span class="number">0x9</span>)  <span class="comment">// 9</span></span><br><span class="line">        result = GFMul9(s);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n==<span class="number">0xb</span>)  <span class="comment">// 11</span></span><br><span class="line">        result = GFMul11(s);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n==<span class="number">0xd</span>)  <span class="comment">// 13</span></span><br><span class="line">        result = GFMul13(s);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n==<span class="number">0xe</span>)  <span class="comment">// 14</span></span><br><span class="line">        result = GFMul14(s);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// 逆列混合</span></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">deColCinfusions</span><span class="params">()</span></span><br><span class="line">{</span><br><span class="line">    <span class="type">uint8_t</span> temVerify[<span class="number">16</span>];</span><br><span class="line">    <span class="type">uint8_t</span> i =<span class="number">0</span>;</span><br><span class="line">    <span class="type">uint8_t</span> j =<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">16</span>;i++)</span><br><span class="line">    {</span><br><span class="line">        temVerify[i] = verify[i];</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i =<span class="number">0</span>;i&lt;<span class="number">4</span>;i++)</span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">4</span>;j++)</span><br><span class="line">        {</span><br><span class="line">            verify[i*<span class="number">4</span>+j] = GFMul(deColCinfusion[i*<span class="number">4</span>],temVerify[j])^GFMul(deColCinfusion[i*<span class="number">4</span>+<span class="number">1</span>],temVerify[<span class="number">4</span>+j])^GFMul(deColCinfusion[i*<span class="number">4</span>+<span class="number">2</span>],temVerify[<span class="number">2</span>*<span class="number">4</span>+j])^GFMul(deColCinfusion[i*<span class="number">4</span>+<span class="number">3</span>],temVerify[<span class="number">3</span>*<span class="number">4</span>+j]);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<h4 id="轮密钥加"><a href="#轮密钥加" class="headerlink" title="轮密钥加"></a>轮密钥加</h4><p>轮密钥加：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF-Login/image-20220420221626691.png" alt="image-20220420221626691"></p>
<p>在10轮加密之前会使用一个拓展密钥（进行一次轮密钥加）</p>
<p>10轮加密之中每一轮会用一个拓展密钥</p>
<p>10轮加密之后会使用一个拓展密钥</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF-Login/image-20220420222043252.png" alt="image-20220420222043252"></p>
<p>逆轮密钥加：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// 轮密钥加(传入的参数是每一轮使用的密钥的第一个数的索引)</span><br><span class="line">static void addRoundKey(uint8_t theIndex)</span><br><span class="line">{</span><br><span class="line">    uint8_t i,j = 0;</span><br><span class="line">    for(i=0;i&lt;4;i++)</span><br><span class="line">    {</span><br><span class="line">        for(j=0;j&lt;4;j++)</span><br><span class="line">        {</span><br><span class="line">            verify[4*i+j]^=roundKey[theIndex+4*j+i];</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="AES解密脚本"><a href="#AES解密脚本" class="headerlink" title="AES解密脚本"></a>AES解密脚本</h4><p>AES解密脚本：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="type">uint8_t</span> revSBox[] = {<span class="number">0x63</span>,<span class="number">0x7c</span>,<span class="number">0x77</span>,<span class="number">0x7b</span>,<span class="number">0xf2</span>,<span class="number">0x6b</span>,<span class="number">0x6f</span>,<span class="number">0xc5</span>,<span class="number">0x30</span>,<span class="number">0x01</span>,<span class="number">0x67</span>,<span class="number">0x2b</span>,<span class="number">0xfe</span>,<span class="number">0xd7</span>,<span class="number">0xab</span>,<span class="number">0x76</span>,<span class="number">0xca</span>,<span class="number">0x82</span>,<span class="number">0xc9</span>,<span class="number">0x7d</span>,<span class="number">0xfa</span>,<span class="number">0x59</span>,<span class="number">0x47</span>,<span class="number">0xf0</span>,<span class="number">0xad</span>,<span class="number">0xd4</span>,<span class="number">0xa2</span>,<span class="number">0xaf</span>,<span class="number">0x9c</span>,<span class="number">0xa4</span>,<span class="number">0x72</span>,<span class="number">0xc0</span>,<span class="number">0xb7</span>,<span class="number">0xfd</span>,<span class="number">0x93</span>,<span class="number">0x26</span>,<span class="number">0x36</span>,<span class="number">0x3f</span>,<span class="number">0xf7</span>,<span class="number">0xcc</span>,<span class="number">0x34</span>,<span class="number">0xa5</span>,<span class="number">0xe5</span>,<span class="number">0xf1</span>,<span class="number">0x71</span>,<span class="number">0xd8</span>,<span class="number">0x31</span>,<span class="number">0x15</span>,<span class="number">0x04</span>,<span class="number">0xc7</span>,<span class="number">0x23</span>,<span class="number">0xc3</span>,<span class="number">0x18</span>,<span class="number">0x96</span>,<span class="number">0x05</span>,<span class="number">0x9a</span>,<span class="number">0x07</span>,<span class="number">0x12</span>,<span class="number">0x80</span>,<span class="number">0xe2</span>,<span class="number">0xeb</span>,<span class="number">0x27</span>,<span class="number">0xb2</span>,<span class="number">0x75</span>,<span class="number">0x09</span>,<span class="number">0x83</span>,<span class="number">0x2c</span>,<span class="number">0x1a</span>,<span class="number">0x1b</span>,<span class="number">0x6e</span>,<span class="number">0x5a</span>,<span class="number">0xa0</span>,<span class="number">0x52</span>,<span class="number">0x3b</span>,<span class="number">0xd6</span>,<span class="number">0xb3</span>,<span class="number">0x29</span>,<span class="number">0xe3</span>,<span class="number">0x2f</span>,<span class="number">0x84</span>,<span class="number">0x53</span>,<span class="number">0xd1</span>,<span class="number">0x00</span>,<span class="number">0xed</span>,<span class="number">0x20</span>,<span class="number">0xfc</span>,<span class="number">0xb1</span>,<span class="number">0x5b</span>,<span class="number">0x6a</span>,<span class="number">0xcb</span>,<span class="number">0xbe</span>,<span class="number">0x39</span>,<span class="number">0x4a</span>,<span class="number">0x4c</span>,<span class="number">0x58</span>,<span class="number">0xcf</span>,<span class="number">0xd0</span>,<span class="number">0xef</span>,<span class="number">0xaa</span>,<span class="number">0xfb</span>,<span class="number">0x43</span>,<span class="number">0x4d</span>,<span class="number">0x33</span>,<span class="number">0x85</span>,<span class="number">0x45</span>,<span class="number">0xf9</span>,<span class="number">0x02</span>,<span class="number">0x7f</span>,<span class="number">0x50</span>,<span class="number">0x3c</span>,<span class="number">0x9f</span>,<span class="number">0xa8</span>,<span class="number">0x51</span>,<span class="number">0xa3</span>,<span class="number">0x40</span>,<span class="number">0x8f</span>,<span class="number">0x92</span>,<span class="number">0x9d</span>,<span class="number">0x38</span>,<span class="number">0xf5</span>,<span class="number">0xbc</span>,<span class="number">0xb6</span>,<span class="number">0xda</span>,<span class="number">0x21</span>,<span class="number">0x10</span>,<span class="number">0xff</span>,<span class="number">0xf3</span>,<span class="number">0xd2</span>,<span class="number">0xcd</span>,<span class="number">0x0c</span>,<span class="number">0x13</span>,<span class="number">0xec</span>,<span class="number">0x5f</span>,<span class="number">0x97</span>,<span class="number">0x44</span>,<span class="number">0x17</span>,<span class="number">0xc4</span>,<span class="number">0xa7</span>,<span class="number">0x7e</span>,<span class="number">0x3d</span>,<span class="number">0x64</span>,<span class="number">0x5d</span>,<span class="number">0x19</span>,<span class="number">0x73</span>,<span class="number">0x60</span>,<span class="number">0x81</span>,<span class="number">0x4f</span>,<span class="number">0xdc</span>,<span class="number">0x22</span>,<span class="number">0x2a</span>,<span class="number">0x90</span>,<span class="number">0x88</span>,<span class="number">0x46</span>,<span class="number">0xee</span>,<span class="number">0xb8</span>,<span class="number">0x14</span>,<span class="number">0xde</span>,<span class="number">0x5e</span>,<span class="number">0x0b</span>,<span class="number">0xdb</span>,<span class="number">0xe0</span>,<span class="number">0x32</span>,<span class="number">0x3a</span>,<span class="number">0x0a</span>,<span class="number">0x49</span>,<span class="number">0x06</span>,<span class="number">0x24</span>,<span class="number">0x5c</span>,<span class="number">0xc2</span>,<span class="number">0xd3</span>,<span class="number">0xac</span>,<span class="number">0x62</span>,<span class="number">0x91</span>,<span class="number">0x95</span>,<span class="number">0xe4</span>,<span class="number">0x79</span>,<span class="number">0xe7</span>,<span class="number">0xc8</span>,<span class="number">0x37</span>,<span class="number">0x6d</span>,<span class="number">0x8d</span>,<span class="number">0xd5</span>,<span class="number">0x4e</span>,<span class="number">0xa9</span>,<span class="number">0x6c</span>,<span class="number">0x56</span>,<span class="number">0xf4</span>,<span class="number">0xea</span>,<span class="number">0x65</span>,<span class="number">0x7a</span>,<span class="number">0xae</span>,<span class="number">0x08</span>,<span class="number">0xba</span>,<span class="number">0x78</span>,<span class="number">0x25</span>,<span class="number">0x2e</span>,<span class="number">0x1c</span>,<span class="number">0xa6</span>,<span class="number">0xb4</span>,<span class="number">0xc6</span>,<span class="number">0xe8</span>,<span class="number">0xdd</span>,<span class="number">0x74</span>,<span class="number">0x1f</span>,<span class="number">0x4b</span>,<span class="number">0xbd</span>,<span class="number">0x8b</span>,<span class="number">0x8a</span>,<span class="number">0x70</span>,<span class="number">0x3e</span>,<span class="number">0xb5</span>,<span class="number">0x66</span>,<span class="number">0x48</span>,<span class="number">0x03</span>,<span class="number">0xf6</span>,<span class="number">0x0e</span>,<span class="number">0x61</span>,<span class="number">0x35</span>,<span class="number">0x57</span>,<span class="number">0xb9</span>,<span class="number">0x86</span>,<span class="number">0xc1</span>,<span class="number">0x1d</span>,<span class="number">0x9e</span>,<span class="number">0xe1</span>,<span class="number">0xf8</span>,<span class="number">0x98</span>,<span class="number">0x11</span>,<span class="number">0x69</span>,<span class="number">0xd9</span>,<span class="number">0x8e</span>,<span class="number">0x94</span>,<span class="number">0x9b</span>,<span class="number">0x1e</span>,<span class="number">0x87</span>,<span class="number">0xe9</span>,<span class="number">0xce</span>,<span class="number">0x55</span>,<span class="number">0x28</span>,<span class="number">0xdf</span>,<span class="number">0x8c</span>,<span class="number">0xa1</span>,<span class="number">0x89</span>,<span class="number">0x0d</span>,<span class="number">0xbf</span>,<span class="number">0xe6</span>,<span class="number">0x42</span>,<span class="number">0x68</span>,<span class="number">0x41</span>,<span class="number">0x99</span>,<span class="number">0x2d</span>,<span class="number">0x0f</span>,<span class="number">0xb0</span>,<span class="number">0x54</span>,<span class="number">0xbb</span>,<span class="number">0x16</span>};</span><br><span class="line"><span class="type">uint8_t</span> para[] = {  <span class="number">0x8D</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x10</span>, <span class="number">0x20</span>, <span class="number">0x40</span>, <span class="number">0x80</span>, <span class="number">0x1B</span>, <span class="number">0x36</span>};</span><br><span class="line"><span class="type">uint8_t</span> pass_token[] = {<span class="number">50</span>, <span class="number">48</span>, <span class="number">7</span>, <span class="number">54</span>, <span class="number">106</span>, <span class="number">55</span>, <span class="number">120</span>, <span class="number">49</span>, <span class="number">72</span>, <span class="number">57</span>, <span class="number">66</span>, <span class="number">57</span>, <span class="number">20</span>, <span class="number">49</span>, <span class="number">213</span>, <span class="number">50</span>, <span class="number">98</span>, <span class="number">54</span>, <span class="number">249</span>, <span class="number">56</span>, <span class="number">66</span>, <span class="number">48</span>, <span class="number">195</span>, <span class="number">49</span>, <span class="number">106</span>, <span class="number">53</span>, <span class="number">72</span>, <span class="number">56</span>, <span class="number">52</span>, <span class="number">53</span>, <span class="number">84</span>, <span class="number">52</span>, <span class="number">41</span>, <span class="number">52</span>, <span class="number">81</span>, <span class="number">54</span>, <span class="number">21</span>, <span class="number">57</span>, <span class="number">210</span>, <span class="number">56</span>, <span class="number">210</span>, <span class="number">57</span>, <span class="number">32</span>, <span class="number">49</span>, <span class="number">185</span>, <span class="number">50</span>, <span class="number">46</span>, <span class="number">48</span>};   <span class="comment">//前16个字节用来生成44*4的轮密钥    后16*2字节每16个字节用来进行AES的IV异或运算</span></span><br><span class="line"><span class="type">uint8_t</span> roundKey[<span class="number">4</span>*<span class="number">44</span>];<span class="comment">// 生成的轮密钥</span></span><br><span class="line"><span class="type">uint8_t</span> verify[<span class="number">16</span>];</span><br><span class="line"><span class="comment">// 待加密的数据</span></span><br><span class="line"><span class="type">uint8_t</span> c[] ={<span class="number">0xfe</span>,<span class="number">0xf9</span>,<span class="number">0xe7</span>,<span class="number">0x3e</span>,<span class="number">0xf6</span>,<span class="number">0xa1</span>,<span class="number">0x23</span>,<span class="number">0xcc</span>,<span class="number">0x57</span>,<span class="number">0x61</span>,<span class="number">0xc1</span>,<span class="number">0x15</span>,<span class="number">0x77</span>,<span class="number">0xfb</span>,<span class="number">0x9c</span>,<span class="number">0xbb</span>,<span class="number">0xca</span>,<span class="number">0x2f</span>,<span class="number">0xb1</span>,<span class="number">0xe8</span>,<span class="number">0x4f</span>,<span class="number">0xd9</span>,<span class="number">0x07</span>,<span class="number">0xd8</span>,<span class="number">0x0c</span>,<span class="number">0x6b</span>,<span class="number">0xea</span>,<span class="number">0xcf</span>,<span class="number">0xe8</span>,<span class="number">0x42</span>,<span class="number">0xa2</span>,<span class="number">0xfa</span>};</span><br><span class="line"></span><br><span class="line"><span class="comment">// 进行密钥扩展</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">expandKeyNums</span><span class="params">()</span></span><br><span class="line">{</span><br><span class="line">        <span class="comment">// 进行密钥扩展</span></span><br><span class="line">    <span class="type">uint8_t</span> v9 = <span class="number">0</span>;</span><br><span class="line">    <span class="type">uint8_t</span> v10 = <span class="number">0</span>;</span><br><span class="line">    <span class="type">uint8_t</span> v11 = <span class="number">0</span>;</span><br><span class="line">    <span class="type">uint8_t</span> v12 = <span class="number">0</span>;</span><br><span class="line">    <span class="type">uint8_t</span> i =<span class="number">0</span>;</span><br><span class="line">    <span class="type">uint8_t</span> j =<span class="number">0</span>;</span><br><span class="line">    <span class="comment">// 初始化前16个字节 4列中的元素</span></span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span> ;i&lt;<span class="number">4</span>;i++)</span><br><span class="line">    {</span><br><span class="line">        roundKey[i*<span class="number">4</span>] = pass_token[i*<span class="number">4</span>];</span><br><span class="line">        roundKey[i*<span class="number">4</span>+<span class="number">1</span>] = pass_token[i*<span class="number">4</span>+<span class="number">1</span>];</span><br><span class="line">        roundKey[i*<span class="number">4</span>+<span class="number">2</span>] = pass_token[i*<span class="number">4</span>+<span class="number">2</span>];</span><br><span class="line">        roundKey[i*<span class="number">4</span>+<span class="number">3</span>] = pass_token[i*<span class="number">4</span>+<span class="number">3</span>];</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">4</span>;i&lt;<span class="number">44</span>;i++)</span><br><span class="line">    {</span><br><span class="line">        v9 = roundKey[<span class="number">4</span>*(i<span class="number">-1</span>)];</span><br><span class="line">        v10 = roundKey[<span class="number">4</span>*(i<span class="number">-1</span>)+<span class="number">1</span>];</span><br><span class="line">        v11 = roundKey[<span class="number">4</span>*(i<span class="number">-1</span>)+<span class="number">2</span>];</span><br><span class="line">        v12 = roundKey[<span class="number">4</span>*(i<span class="number">-1</span>)+<span class="number">3</span>];</span><br><span class="line">        <span class="keyword">if</span> ((i&amp;<span class="number">3</span>) == <span class="number">0</span> )</span><br><span class="line">        {</span><br><span class="line">            v10 = revSBox[v11];</span><br><span class="line">            v11 = revSBox[v12];</span><br><span class="line">            v12 = revSBox[roundKey[<span class="number">4</span>*(i<span class="number">-1</span>)]];</span><br><span class="line">            v9 = revSBox[roundKey[<span class="number">4</span>*(i<span class="number">-1</span>)+<span class="number">1</span>]] ^ para[i&gt;&gt;<span class="number">2</span>];</span><br><span class="line">        }</span><br><span class="line">        roundKey[i*<span class="number">4</span>] = v9^roundKey[(i<span class="number">-4</span>)*<span class="number">4</span>];</span><br><span class="line">        roundKey[i*<span class="number">4</span>+<span class="number">1</span>] = v10^roundKey[(i<span class="number">-4</span>)*<span class="number">4</span>+<span class="number">1</span>];</span><br><span class="line">        roundKey[i*<span class="number">4</span>+<span class="number">2</span>] = v11^roundKey[(i<span class="number">-4</span>)*<span class="number">4</span>+<span class="number">2</span>];</span><br><span class="line">        roundKey[i*<span class="number">4</span>+<span class="number">3</span>] = v12^roundKey[(i<span class="number">-4</span>)*<span class="number">4</span>+<span class="number">3</span>];</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="comment">// 加密过程第一步的异或运算(但是里面的数据还需要思考一下) 传入的参数是数据加密的轮数</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">XorIV</span><span class="params">(<span class="type">uint8_t</span> round)</span></span><br><span class="line">{</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;=<span class="number">15</span>;i++)</span><br><span class="line">    {</span><br><span class="line">        verify[i]^=pass_token[<span class="number">16</span>*round+<span class="number">16</span>+i];</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 逆字节代换()</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">reveSubBytes</span><span class="params">()</span></span><br><span class="line">{</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">16</span>; i++)</span><br><span class="line">    {</span><br><span class="line">        verify[i] = revSBox[verify[i]];</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// 行移位的逆运算 第一行不移动 第二行循环右移1位</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">reveShiftRows</span><span class="params">()</span></span><br><span class="line">{</span><br><span class="line">    <span class="type">int</span> round = <span class="number">0</span>;</span><br><span class="line">    <span class="type">uint8_t</span> tem = <span class="number">0</span>;<span class="comment">//临时存放值</span></span><br><span class="line">    <span class="type">int</span> j =<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">4</span>;i++)</span><br><span class="line">    {</span><br><span class="line">        round = i;</span><br><span class="line">        <span class="keyword">while</span>(round)</span><br><span class="line">        {</span><br><span class="line">            tem = verify[i*<span class="number">4</span>+<span class="number">3</span>];</span><br><span class="line">            <span class="keyword">for</span>(j=<span class="number">3</span>;j&gt;<span class="number">0</span>;j--)</span><br><span class="line">            {</span><br><span class="line">                verify[i*<span class="number">4</span>+j] = verify[i*<span class="number">4</span>+j<span class="number">-1</span>];</span><br><span class="line">            }</span><br><span class="line">            verify[i*<span class="number">4</span>+j] = tem;</span><br><span class="line">            round--;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// 列混合</span></span><br><span class="line"><span class="comment">// 使用到的矩阵</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">uint8_t</span> deColCinfusion[<span class="number">16</span>] =</span><br><span class="line">{</span><br><span class="line">    <span class="number">0xe</span>, <span class="number">0xb</span>, <span class="number">0xd</span>, <span class="number">0x9</span>,</span><br><span class="line">	<span class="number">0x9</span>, <span class="number">0xe</span>, <span class="number">0xb</span>, <span class="number">0xd</span>,</span><br><span class="line">	<span class="number">0xd</span>, <span class="number">0x9</span>, <span class="number">0xe</span>, <span class="number">0xb</span>,</span><br><span class="line">	<span class="number">0xb</span>, <span class="number">0xd</span>, <span class="number">0x9</span>, <span class="number">0xe</span></span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="comment">// GF之中的运算</span></span><br><span class="line"><span class="type">static</span> <span class="type">uint8_t</span> <span class="title function_">GFMul2</span><span class="params">(<span class="type">uint8_t</span> s)</span></span><br><span class="line">{</span><br><span class="line">    <span class="type">uint8_t</span> result = s*<span class="number">2</span>;</span><br><span class="line">    <span class="type">int</span> tem = (s*<span class="number">2</span>)&amp;<span class="number">0x00000100</span>;</span><br><span class="line">    <span class="keyword">if</span>(tem != <span class="number">0</span>)</span><br><span class="line">    {</span><br><span class="line">        result = result&amp;<span class="number">0xff</span>;</span><br><span class="line">        result^= <span class="number">0x1b</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">uint8_t</span> <span class="title function_">GFMul3</span><span class="params">(<span class="type">uint8_t</span> s)</span></span><br><span class="line">{</span><br><span class="line">    <span class="keyword">return</span> GFMul2(s)^s;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">uint8_t</span> <span class="title function_">GFMul4</span><span class="params">(<span class="type">uint8_t</span> s)</span></span><br><span class="line">{</span><br><span class="line">    <span class="keyword">return</span> GFMul2(GFMul2(s));</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">uint8_t</span> <span class="title function_">GFMul8</span><span class="params">(<span class="type">uint8_t</span> s)</span></span><br><span class="line">{</span><br><span class="line">    <span class="keyword">return</span> GFMul2(GFMul4(s));</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">uint8_t</span> <span class="title function_">GFMul9</span><span class="params">(<span class="type">uint8_t</span> s)</span></span><br><span class="line">{</span><br><span class="line">    <span class="keyword">return</span> GFMul8(s)^s;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">uint8_t</span> <span class="title function_">GFMul11</span><span class="params">(<span class="type">uint8_t</span> s)</span></span><br><span class="line">{</span><br><span class="line">    <span class="keyword">return</span> GFMul9(s)^GFMul2(s);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">uint8_t</span> <span class="title function_">GFMul12</span><span class="params">(<span class="type">uint8_t</span> s)</span></span><br><span class="line">{</span><br><span class="line">    <span class="keyword">return</span> GFMul8(s)^GFMul4(s);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">uint8_t</span> <span class="title function_">GFMul13</span><span class="params">(<span class="type">uint8_t</span> s)</span></span><br><span class="line">{</span><br><span class="line">    <span class="keyword">return</span> GFMul12(s)^s;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">uint8_t</span> <span class="title function_">GFMul14</span><span class="params">(<span class="type">uint8_t</span> s)</span></span><br><span class="line">{</span><br><span class="line">    <span class="keyword">return</span> GFMul12(s)^GFMul2(s);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">uint8_t</span> <span class="title function_">GFMul</span><span class="params">(<span class="type">uint8_t</span> n,<span class="type">uint8_t</span> s)</span></span><br><span class="line">{</span><br><span class="line">    <span class="type">uint8_t</span> result = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (n==<span class="number">1</span>)</span><br><span class="line">        result = s;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n==<span class="number">2</span>)  <span class="comment">// 2</span></span><br><span class="line">        result = GFMul2(s);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n==<span class="number">3</span>)  <span class="comment">// 3</span></span><br><span class="line">        result = GFMul3(s);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n==<span class="number">0x9</span>)  <span class="comment">// 9</span></span><br><span class="line">        result = GFMul9(s);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n==<span class="number">0xb</span>)  <span class="comment">// 11</span></span><br><span class="line">        result = GFMul11(s);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n==<span class="number">0xd</span>)  <span class="comment">// 13</span></span><br><span class="line">        result = GFMul13(s);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n==<span class="number">0xe</span>)  <span class="comment">// 14</span></span><br><span class="line">        result = GFMul14(s);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// 逆列混合</span></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">deColCinfusions</span><span class="params">()</span></span><br><span class="line">{</span><br><span class="line">    <span class="type">uint8_t</span> temVerify[<span class="number">16</span>];</span><br><span class="line">    <span class="type">uint8_t</span> i =<span class="number">0</span>;</span><br><span class="line">    <span class="type">uint8_t</span> j =<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">16</span>;i++)</span><br><span class="line">    {</span><br><span class="line">        temVerify[i] = verify[i];</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i =<span class="number">0</span>;i&lt;<span class="number">4</span>;i++)</span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">4</span>;j++)</span><br><span class="line">        {</span><br><span class="line">            verify[i*<span class="number">4</span>+j] = GFMul(deColCinfusion[i*<span class="number">4</span>],temVerify[j])^GFMul(deColCinfusion[i*<span class="number">4</span>+<span class="number">1</span>],temVerify[<span class="number">4</span>+j])^GFMul(deColCinfusion[i*<span class="number">4</span>+<span class="number">2</span>],temVerify[<span class="number">2</span>*<span class="number">4</span>+j])^GFMul(deColCinfusion[i*<span class="number">4</span>+<span class="number">3</span>],temVerify[<span class="number">3</span>*<span class="number">4</span>+j]);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// 轮密钥加(传入的参数是每一轮使用的密钥的第一个数的索引)</span></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">addRoundKey</span><span class="params">(<span class="type">uint8_t</span> theIndex)</span></span><br><span class="line">{</span><br><span class="line">    <span class="type">uint8_t</span> i,j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">4</span>;i++)</span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">4</span>;j++)</span><br><span class="line">        {</span><br><span class="line">            verify[<span class="number">4</span>*i+j]^=roundKey[theIndex+<span class="number">4</span>*j+i];</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="comment">// 将4*4的矩阵进行转置</span></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">transMatri</span><span class="params">(<span class="type">uint8_t</span>* mutrix)</span></span><br><span class="line">{</span><br><span class="line">    <span class="type">uint8_t</span> temMutrix[<span class="number">16</span>];</span><br><span class="line">    <span class="type">uint8_t</span> i,j=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">16</span>;i++)</span><br><span class="line">    {</span><br><span class="line">        temMutrix[i] = mutrix[i];</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">4</span>;i++)</span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">4</span>;j++)</span><br><span class="line">        {</span><br><span class="line">            mutrix[<span class="number">4</span>*i+j] = temMutrix[i+<span class="number">4</span>*j];</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">{</span><br><span class="line">    <span class="comment">// 密钥扩展</span></span><br><span class="line">    expandKeyNums();</span><br><span class="line">    <span class="type">uint8_t</span> i,j=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"verity:"</span>);</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">32</span>;i=i+<span class="number">16</span>)</span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">for</span>(j=i;j&lt;i+<span class="number">16</span>;j++)</span><br><span class="line">        {</span><br><span class="line">            verify[j-i] = c[j];</span><br><span class="line">        }</span><br><span class="line">        <span class="comment">// 初始的时候要进行一次转置</span></span><br><span class="line">        transMatri(verify);</span><br><span class="line">        <span class="comment">//第一次轮密钥加</span></span><br><span class="line">        addRoundKey(<span class="number">16</span>*<span class="number">10</span>);</span><br><span class="line">        <span class="comment">// 10次解密</span></span><br><span class="line">        <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">10</span>;j++)</span><br><span class="line">        {</span><br><span class="line">            <span class="comment">// 逆行移位</span></span><br><span class="line">            reveShiftRows();</span><br><span class="line">            <span class="comment">// 逆字节代换</span></span><br><span class="line">            reveSubBytes();</span><br><span class="line">            <span class="keyword">if</span> (j==<span class="number">9</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="comment">// 轮密钥加密</span></span><br><span class="line">            addRoundKey(<span class="number">16</span>*(<span class="number">9</span>-j));</span><br><span class="line">            <span class="comment">//逆列混淆</span></span><br><span class="line">            deColCinfusions();</span><br><span class="line"></span><br><span class="line">        }</span><br><span class="line">        <span class="comment">// 再进行一次轮密钥加密</span></span><br><span class="line">        addRoundKey(<span class="number">0</span>);</span><br><span class="line">        <span class="comment">//结束的时候要机进行一次转置</span></span><br><span class="line">        transMatri(verify);</span><br><span class="line">        <span class="comment">//最后要和IV进行异或运算</span></span><br><span class="line">        XorIV(i/<span class="number">16</span>);</span><br><span class="line">        <span class="keyword">for</span>(j =<span class="number">0</span>;j&lt;<span class="number">16</span>;j++)</span><br><span class="line">        {</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%c"</span>,verify[j]);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line">verity:<span class="number">7026271</span>d7bb5d404d63a72b88e6b4d63</span><br></pre></td></tr></tbody></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/DASCTF-Login/image-20220421134033932.png" alt="image-20220421134033932"></p>
<p>所以flag是 DASCTF{7026271d7bb5d404d63a72b88e6b4d63}</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Gruge</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2022/04/21/DASCTF-Login/">http://example.com/2022/04/21/DASCTF-Login/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">Gruge's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/RSA/">RSA</a><a class="post-meta__tags" href="/tags/hill%E8%A7%A3%E5%AF%86/">hill解密</a><a class="post-meta__tags" href="/tags/AES%E8%A7%A3%E5%AF%86/">AES解密</a></div><div class="post_share"><div class="social-share" data-image="https://s3.bmp.ovh/imgs/2022/02/ca6f47126f533a59.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer=""></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2022/04/15/HFCTF2022-theShellcode/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s3.bmp.ovh/imgs/2022/02/ca6f47126f533a59.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">HFCTF2022_theShellcode</div></div></a></div></nav><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s3.bmp.ovh/imgs/2022/02/463b631c6a0f63ec.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"></div><div class="author-info__name">Gruge</div><div class="author-info__description"></div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">15</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">28</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Login"><span class="toc-number">1.</span> <span class="toc-text">Login</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%A4%E4%B8%AA%E7%A8%8B%E5%BA%8F%E7%9A%84%E4%BA%A4%E4%BA%92"><span class="toc-number">1.1.</span> <span class="toc-text">两个程序的交互</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rsa%E8%A7%A3%E5%AF%86"><span class="toc-number">1.2.</span> <span class="toc-text">rsa解密</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hill%E8%A7%A3%E5%AF%86"><span class="toc-number">1.3.</span> <span class="toc-text">hill解密</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C%E8%B0%83%E8%AF%95%E4%B8%A4%E4%B8%AA%E7%A8%8B%E5%BA%8F"><span class="toc-number">1.4.</span> <span class="toc-text">运行调试两个程序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AES%E8%A7%A3%E5%AF%86"><span class="toc-number">1.5.</span> <span class="toc-text">AES解密</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#S%E7%9B%92"><span class="toc-number">1.5.1.</span> <span class="toc-text">S盒</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#pass-token%E7%9A%84%E8%8E%B7%E5%8F%96"><span class="toc-number">1.5.2.</span> <span class="toc-text">pass_token的获取</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%86%E9%92%A5%E6%89%A9%E5%B1%95%E5%92%8C%E9%80%86S%E7%9B%92"><span class="toc-number">1.5.3.</span> <span class="toc-text">密钥扩展和逆S盒</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CBC%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96%E5%90%91%E9%87%8F%E7%9A%84IV"><span class="toc-number">1.5.4.</span> <span class="toc-text">CBC模式的初始化向量的IV</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#AES%E5%8A%A0%E5%AF%86%E7%9A%84%E4%B8%BB%E9%80%BB%E8%BE%91"><span class="toc-number">1.5.5.</span> <span class="toc-text">AES加密的主逻辑</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%97%E8%8A%82%E4%BB%A3%E6%8D%A2"><span class="toc-number">1.5.6.</span> <span class="toc-text">字节代换</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A1%8C%E7%A7%BB%E4%BD%8D"><span class="toc-number">1.5.7.</span> <span class="toc-text">行移位</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%97%E6%B7%B7%E5%90%88"><span class="toc-number">1.5.8.</span> <span class="toc-text">列混合</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BD%AE%E5%AF%86%E9%92%A5%E5%8A%A0"><span class="toc-number">1.5.9.</span> <span class="toc-text">轮密钥加</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#AES%E8%A7%A3%E5%AF%86%E8%84%9A%E6%9C%AC"><span class="toc-number">1.5.10.</span> <span class="toc-text">AES解密脚本</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/04/21/DASCTF-Login/" title="DASCTF_Login"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s3.bmp.ovh/imgs/2022/02/ca6f47126f533a59.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="DASCTF_Login"></a><div class="content"><a class="title" href="/2022/04/21/DASCTF-Login/" title="DASCTF_Login">DASCTF_Login</a><time datetime="2022-04-21T06:04:38.000Z" title="发表于 2022-04-21 14:04:38">2022-04-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/04/15/HFCTF2022-theShellcode/" title="HFCTF2022_theShellcode"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s3.bmp.ovh/imgs/2022/02/ca6f47126f533a59.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="HFCTF2022_theShellcode"></a><div class="content"><a class="title" href="/2022/04/15/HFCTF2022-theShellcode/" title="HFCTF2022_theShellcode">HFCTF2022_theShellcode</a><time datetime="2022-04-15T14:35:25.000Z" title="发表于 2022-04-15 22:35:25">2022-04-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/04/13/starCTF/" title="starCTF2021"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s3.bmp.ovh/imgs/2022/02/ca6f47126f533a59.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="starCTF2021"></a><div class="content"><a class="title" href="/2022/04/13/starCTF/" title="starCTF2021">starCTF2021</a><time datetime="2022-04-13T01:20:26.000Z" title="发表于 2022-04-13 09:20:26">2022-04-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/04/05/2022DASCTF-X-SU-StarGate/" title="2022DASCTF_X_SU_StarGate"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s3.bmp.ovh/imgs/2022/02/ca6f47126f533a59.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2022DASCTF_X_SU_StarGate"></a><div class="content"><a class="title" href="/2022/04/05/2022DASCTF-X-SU-StarGate/" title="2022DASCTF_X_SU_StarGate">2022DASCTF_X_SU_StarGate</a><time datetime="2022-04-05T14:46:18.000Z" title="发表于 2022-04-05 22:46:18">2022-04-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/03/29/%E9%99%87%E5%8E%9F%E6%88%98%E7%96%AB2021%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/" title="陇原战疫2021网络安全大赛"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s3.bmp.ovh/imgs/2022/02/ca6f47126f533a59.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="陇原战疫2021网络安全大赛"></a><div class="content"><a class="title" href="/2022/03/29/%E9%99%87%E5%8E%9F%E6%88%98%E7%96%AB2021%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/" title="陇原战疫2021网络安全大赛">陇原战疫2021网络安全大赛</a><time datetime="2022-03-29T05:20:37.000Z" title="发表于 2022-03-29 13:20:37">2022-03-29</time></div></div></div></div></div></div></main><footer id="footer" style="background: transparent"><div id="footer-wrap"><div class="copyright">©2022 By Gruge</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">本地搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: '1aa3bac2fd8cfac9d7c3',
      clientSecret: '7640d6d45e9030f665c75a640991b67e8367e67d',
      repo: 'G2uge.github.io',
      owner: 'G2uge',
      admin: ['G2uge'],
      id: '3f5e9a288c1e7310e22d3fc62841c36a',
      updateCountCallback: commentCount
    },null))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    getScript('https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Gitalk' === 'Gitalk' || !false) {
  if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zindex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-heart.min.js" async="async" mobile="false"></script><script async="" data-pjax="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>